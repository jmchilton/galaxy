webpackJsonp([1],[,,,,function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=(r(o),i(22)),l=r(s),d=i(46),c=r(d),u=i(23),h=r(u),f=i(47),p=r(f),_=i(12),m=r(_),g=i(9),v=r(g),b=t.View.extend({tagName:"label",initialize:function(e){this.model=e&&e.model||new t.Model(e),this.tagName=e.tagName||this.tagName,this.setElement(n("<"+this.tagName+"/>")),this.listenTo(this.model,"change",this.render,this),this.render()},title:function(t){this.model.set("title",t)},value:function(){return this.model.get("title")},render:function(){return this.$el.removeClass().addClass("ui-label").addClass(this.model.get("cls")).html(this.model.get("title")),this}}),w=t.View.extend({initialize:function(e){this.model=e&&e.model||new t.Model({message:null,status:"info",cls:"",persistent:!1,fade:!0}).set(e),this.listenTo(this.model,"change",this.render,this),this.render()},update:function(t){this.model.set(t)},render:function(){this.$el.removeClass().addClass("ui-message").addClass(this.model.get("cls"));var t=this.model.get("status");if(this.model.get("large")?this.$el.addClass(("success"==t&&"done"||"danger"==t&&"error"||t)+"messagelarge"):this.$el.addClass("alert").addClass("alert-"+t),this.model.get("message")){if(this.$el.html(this.messageForDisplay()),this.$el[this.model.get("fade")?"fadeIn":"show"](),this.timeout&&window.clearTimeout(this.timeout),!this.model.get("persistent")){var e=this;this.timeout=window.setTimeout(function(){e.model.set("message","")},3e3)}}else this.$el.fadeOut();return this},messageForDisplay:function(){return a.escape(this.model.get("message"))}}),y=w.extend({messageForDisplay:function(){return this.model.get("message")}}),x=t.View.extend({initialize:function(e){this.model=e&&e.model||new t.Model({type:"text",placeholder:"",disabled:!1,readonly:!1,visible:!0,cls:"",area:!1,color:null,style:null}).set(e),this.tagName=this.model.get("area")?"textarea":"input",this.setElement(n("<"+this.tagName+"/>")),this.listenTo(this.model,"change",this.render,this),this.render()},events:{input:"_onchange"},value:function(t){return void 0!==t&&this.model.set("value","string"==typeof t?t:""),this.model.get("value")},render:function(){var t=this;this.$el.removeClass().addClass("ui-"+this.tagName).addClass(this.model.get("cls")).addClass(this.model.get("style")).attr("id",this.model.id).attr("type",this.model.get("type")).attr("placeholder",this.model.get("placeholder")).css("color",this.model.get("color")||"").css("border-color",this.model.get("color")||"");var e=this.model.get("datalist");return n.isArray(e)&&e.length>0&&this.$el.autocomplete({source:function(e,i){i(t.model.get("datalist"))},change:function(){t._onchange()}}),this.model.get("value")!==this.$el.val()&&this.$el.val(this.model.get("value")),a.each(["readonly","disabled"],function(e){t.model.get(e)?t.$el.attr(e,!0):t.$el.removeAttr(e)}),this.$el[this.model.get("visible")?"show":"hide"](),this},_onchange:function(){this.value(this.$el.val()),this.model.get("onchange")&&this.model.get("onchange")(this.model.get("value"))}}),k=t.View.extend({initialize:function(e){this.model=e&&e.model||new t.Model(e),this.setElement(n("<div/>").append(this.$info=n("<div/>")).append(this.$hidden=n("<div/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},value:function(t){return void 0!==t&&this.model.set("value",t),this.model.get("value")},render:function(){return this.$el.attr("id",this.model.id),this.$hidden.val(this.model.get("value")),this.model.get("info")?this.$info.show().text(this.model.get("info")):this.$info.hide(),this}}),C=t.View.extend({initialize:function(e){var i=this;this.model=e&&e.model||new t.Model(e),this.setElement(n("<div/>").append(this.$info=n("<div/>")).append(this.$file=n("<input/>").attr("type","file").addClass("ui-margin-bottom")).append(this.$text=n("<textarea/>").addClass("ui-textarea").attr("disabled",!0)).append(this.$wait=n("<i/>").addClass("fa fa-spinner fa-spin"))),this.listenTo(this.model,"change",this.render,this),this.$file.on("change",function(t){i._readFile(t)}),this.render()},value:function(t){return void 0!==t&&this.model.set("value",t),this.model.get("value")},render:function(){return this.$el.attr("id",this.model.id),this.model.get("info")?this.$info.show().text(this.model.get("info")):this.$info.hide(),this.model.get("value")?this.$text.text(this.model.get("value")).show():this.$text.hide(),this.model.get("wait")?this.$wait.show():this.$wait.hide(),this},_readFile:function(t){var e=this,i=t.target.files&&t.target.files[0];if(i){var n=new FileReader;n.onload=function(){e.model.set({wait:!1,value:this.result})},this.model.set({wait:!0,value:null}),n.readAsText(i)}}});e.default={Button:m.default.ButtonDefault,ButtonIcon:m.default.ButtonIcon,ButtonCheck:m.default.ButtonCheck,ButtonMenu:m.default.ButtonMenu,ButtonLink:m.default.ButtonLink,Input:x,Label:b,Message:w,UnescapedMessage:y,Upload:C,Modal:v.default,RadioButton:h.default.RadioButton,Checkbox:h.default.Checkbox,Radio:h.default.Radio,Select:l.default,Hidden:k,Slider:c.default,Drilldown:p.default}}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";function n(t){return"[object Array]"===C.call(t)}function a(t){return"[object ArrayBuffer]"===C.call(t)}function r(t){return"undefined"!=typeof FormData&&t instanceof FormData}function o(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer}function s(t){return"string"==typeof t}function l(t){return"number"==typeof t}function d(t){return void 0===t}function c(t){return null!==t&&"object"==typeof t}function u(t){return"[object Date]"===C.call(t)}function h(t){return"[object File]"===C.call(t)}function f(t){return"[object Blob]"===C.call(t)}function p(t){return"[object Function]"===C.call(t)}function _(t){return c(t)&&p(t.pipe)}function m(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}function g(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function v(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function b(t,e){if(null!==t&&void 0!==t)if("object"==typeof t||n(t)||(t=[t]),n(t))for(var i=0,a=t.length;i<a;i++)e.call(null,t[i],i,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}function w(){function t(t,i){"object"==typeof e[i]&&"object"==typeof t?e[i]=w(e[i],t):e[i]=t}for(var e={},i=0,n=arguments.length;i<n;i++)b(arguments[i],t);return e}function y(t,e,i){return b(e,function(e,n){t[n]=i&&"function"==typeof e?x(e,i):e}),t}var x=i(27),k=i(74),C=Object.prototype.toString;t.exports={isArray:n,isArrayBuffer:a,isBuffer:k,isFormData:r,isArrayBufferView:o,isString:s,isNumber:l,isObject:c,isUndefined:d,isDate:u,isFile:h,isBlob:f,isFunction:p,isStream:_,isURLSearchParams:m,isStandardBrowserEnv:v,forEach:b,merge:w,extend:y,trim:g}},function(t,e,i){"use strict";function n(t,e){return function(i){if(t.hasOwnProperty(i))return t[i];if(!e)throw new Error("I do not know how to modify the following string: "+i+". Change your TeX file or submit a feature request at https://github.com/digitalheir/tex-to-unicode/issues.");return i+e}}Object.defineProperty(e,"__esModule",{value:!0}),e.lookupOrAppend=n},,function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){var i=Array.prototype.slice.call(arguments,0),n=i.pop();return i.unshift(n),d.defaults.apply(d,i)}function o(t,e){e=e||"model";var i=d.template(t.join(""));return function(t,n){var a={view:n||{},_l:_.default};return a[e]=t||{},i(a)}}function s(t,e){e=e||{};var i=e.ascending?1:-1;return function(e,n){return e=e.get(t),n=n.get(t),(e<n?-1:e>n?1:0)*i}}Object.defineProperty(e,"__esModule",{value:!0});var l=i(2),d=a(l),c=i(1),u=a(c),h=i(59),f=n(h),p=i(7),_=n(p),m={logger:null,_logNamespace:"."};(0,f.default)(m);var g=u.Model.extend({initialize:function(t){if(this._checkEnabledSessionStorage(),!t.id)throw new Error("SessionStorageModel requires an id in the initial attributes");this.id=t.id;var e=this.isNew()?{}:this._read(this);this.clear({silent:!0}),this.save(d.extend({},this.defaults,e,t),{silent:!0}),this.on("change",function(){this.save()})},_checkEnabledSessionStorage:function(){try{return window.sessionStorage.length>=0}catch(t){return alert("Please enable cookies in your browser for this Galaxy site"),!1}},sync:function(t,e,i){i.silent||e.trigger("request",e,{},i);var n={};switch(t){case"create":n=this._create(e);break;case"read":n=this._read(e);break;case"update":n=this._update(e);break;case"delete":n=this._delete(e)}return void 0!==n||null!==n?i.success&&i.success():i.error&&i.error(),n},_create:function(t){try{var e=t.toJSON(),i=sessionStorage.setItem(t.id,JSON.stringify(e));return null===i?i:e}catch(t){if(!(t instanceof DOMException&&navigator.userAgent.indexOf("Safari")>-1))throw t}return null},_read:function(t){return JSON.parse(sessionStorage.getItem(t.id))},_update:function(t){return t._create(t)},_delete:function(t){return sessionStorage.removeItem(t.id)},isNew:function(){return!sessionStorage.hasOwnProperty(this.id)},_log:function(){return JSON.stringify(this.toJSON(),null,"  ")},toString:function(){return"SessionStorageModel("+this.id+")"}});!function(){g.prototype=d.omit(g.prototype,"url","urlRoot")}();var v={searchAttributes:[],searchAliases:{},searchAttribute:function(t,e){var i=this.get(t);return!(!e||void 0===i||null===i)&&(d.isArray(i)?this._searchArrayAttribute(i,e):-1!==i.toString().toLowerCase().indexOf(e.toLowerCase()))},_searchArrayAttribute:function(t,e){return e=e.toLowerCase(),d.any(t,function(t){return-1!==t.toString().toLowerCase().indexOf(e.toLowerCase())})},search:function(t){var e=this;return d.filter(this.searchAttributes,function(i){return e.searchAttribute(i,t)})},matches:function(t){var e=t.split("=");if(e.length>=2){var i=e[0];return i=this.searchAliases[i]||i,this.searchAttribute(i,e[1])}return!!this.search(t).length},matchesAll:function(t){var e=this;return t=t.match(/(".*"|\w*=".*"|\S*)/g).filter(function(t){return!!t}),d.all(t,function(t){return t=t.replace(/"/g,""),e.matches(t)})}},b={hiddenUntilActivated:function(e,i){if(i=i||{},this.HUAVOptions={$elementShown:this.$el,showFn:t.prototype.toggle,showSpeed:"fast"},d.extend(this.HUAVOptions,i||{}),this.HUAVOptions.hasBeenShown=this.HUAVOptions.$elementShown.is(":visible"),this.hidden=this.isHidden(),e){var n=this;e.on("click",function(t){n.toggle(n.HUAVOptions.showSpeed)})}},isHidden:function(){return this.HUAVOptions.$elementShown.is(":hidden")},toggle:function(){return this.hidden?(this.HUAVOptions.hasBeenShown||d.isFunction(this.HUAVOptions.onshowFirstTime)&&(this.HUAVOptions.hasBeenShown=!0,this.HUAVOptions.onshowFirstTime.call(this)),d.isFunction(this.HUAVOptions.onshow)&&(this.HUAVOptions.onshow.call(this),this.trigger("hiddenUntilActivated:shown",this)),this.hidden=!1):(d.isFunction(this.HUAVOptions.onhide)&&(this.HUAVOptions.onhide.call(this),this.trigger("hiddenUntilActivated:hidden",this)),this.hidden=!0),this.HUAVOptions.showFn.apply(this.HUAVOptions.$elementShown,arguments)}},w={initialize:function(t){this.draggable=t.draggable||!1},$dragHandle:function(){return this.$(".title-bar")},toggleDraggable:function(){this.draggable?this.draggableOff():this.draggableOn()},draggableOn:function(){this.draggable=!0,this.dragStartHandler=d.bind(this._dragStartHandler,this),this.dragEndHandler=d.bind(this._dragEndHandler,this);var t=this.$dragHandle().attr("draggable",!0).get(0);t.addEventListener("dragstart",this.dragStartHandler,!1),t.addEventListener("dragend",this.dragEndHandler,!1)},draggableOff:function(){this.draggable=!1;var t=this.$dragHandle().attr("draggable",!1).get(0);t.removeEventListener("dragstart",this.dragStartHandler,!1),t.removeEventListener("dragend",this.dragEndHandler,!1)},_dragStartHandler:function(t){return t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",JSON.stringify(this.model.toJSON())),this.trigger("draggable:dragstart",t,this),!1},_dragEndHandler:function(t){return this.trigger("draggable:dragend",t,this),!1}},y={initialize:function(t){this.selectable=t.selectable||!1,this.selected=t.selected||!1},$selector:function(){return this.$(".selector")},_renderSelected:function(){this.$selector().find("span").toggleClass("fa-check-square-o",this.selected).toggleClass("fa-square-o",!this.selected)},toggleSelector:function(){this.$selector().is(":visible")?this.hideSelector():this.showSelector()},showSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!0,this.trigger("selectable",!0,this),this._renderSelected(),t?this.$selector().show(t):this.$selector().show()},hideSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!1,this.trigger("selectable",!1,this),t?this.$selector().hide(t):this.$selector().hide()},toggleSelect:function(t){this.selected?this.deselect(t):this.select(t)},select:function(t){return this.selected||(this.trigger("selected",this,t),this.selected=!0,this._renderSelected()),!1},deselect:function(t){return this.selected&&(this.trigger("de-selected",this,t),this.selected=!1,this._renderSelected()),!1}};e.default={LoggableMixin:m,SessionStorageModel:g,mixin:r,SearchableModelMixin:v,HiddenUntilActivatedViewMixin:b,DraggableViewMixin:w,SelectableViewMixin:y,wrapTemplate:o,buildComparator:s}}).call(e,i(0))},function(t,e,i){"use strict";(function(t,i,n){Object.defineProperty(e,"__esModule",{value:!0});var a=t.View.extend({className:"ui-modal",optionsDefault:{container:"body",title:"ui-modal",cls:"ui-modal",body:"",backdrop:!0,height:null,width:null,closing_events:!1,closing_callback:null,title_separator:!0},buttonList:{},initialize:function(t){this.options=i.defaults(t||{},this.optionsDefault),n(this.options.container).prepend(this.el),t&&this.render()},show:function(t){if(t&&(this.options=i.defaults(t,this.optionsDefault),this.render()),!this.visible&&(this.visible=!0,this.$el.fadeIn("fast"),this.options.closing_events)){var e=this;n(document).on("keyup.ui-modal",function(t){27==t.keyCode&&e.hide(!0)}),this.$backdrop.on("click",function(){e.hide(!0)})}},hide:function(t){this.visible=!1,this.$el.fadeOut("fast"),this.options.closing_callback&&this.options.closing_callback(t),n(document).off("keyup.ui-modal"),this.$backdrop.off("click")},render:function(){var t=this;if(this.$el.html(this._template()),this.$header=this.$(".modal-header"),this.$dialog=this.$(".modal-dialog"),this.$body=this.$(".modal-body"),this.$footer=this.$(".modal-footer"),this.$backdrop=this.$(".modal-backdrop"),this.$buttons=this.$(".buttons"),"progress"==this.options.body&&(this.options.body=n('<div class="progress progress-striped active"><div class="progress-bar progress-bar-info" style="width:100%"/></div>')),this.$el.removeClass().addClass("modal").addClass(this.options.cls),this.$header.find(".title").html(this.options.title),this.$body.html(this.options.body),this.$buttons.empty(),this.buttonList={},this.options.buttons){var e=0;n.each(this.options.buttons,function(i,a){var r=n("<button/>").attr("id","button-"+e++).text(i).click(a);t.$buttons.append(r).append("&nbsp;"),t.buttonList[i]=r})}else this.$footer.hide();this.$backdrop[this.options.backdrop&&"addClass"||"removeClass"]("in"),this.$header[!this.options.title_separator&&"addClass"||"removeClass"]("no-separator"),this.$body.removeAttr("style"),this.options.height?(this.$body.css("height",this.options.height),this.$body.css("overflow","hidden")):this.$body.css("max-height",n(window).height()/2),this.options.width&&this.$dialog.css("width",this.options.width)},getButton:function(t){return this.buttonList[t]},enableButton:function(t){this.getButton(t).prop("disabled",!1)},disableButton:function(t){this.getButton(t).prop("disabled",!0)},showButton:function(t){this.getButton(t).show()},hideButton:function(t){this.getButton(t).hide()},scrollTop:function(){return this.$body.scrollTop()},_template:function(){return'<div class="modal-backdrop fade"/><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="title"/></div><div class="modal-body"/><div class="modal-footer"><div class="buttons"/></div></div></div>'}});e.default={View:a}}).call(e,i(1),i(2),i(0))},function(t,e,i){"use strict";function n(t){return"("+t+")"}Object.defineProperty(e,"__esModule",{value:!0}),e.simpleSuffix=function(t){return function(e){return e+t}},e.isSingleTerm=/^.$|^[0-9]+$/,e.addParenthesis=n},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=r(o),l=i(4),d=r(l),c=t.View.extend({visible:!1,initialize:function(e){var i=this;this.model=e&&e.model||new t.Model({id:s.default.uid(),cls:"ui-portlet",title:"",icon:"",buttons:null,body:null,scrollable:!0,nopadding:!1,operations:null,collapsible:!1,collapsible_button:!1,collapsed:!1,onchange_title:null}).set(e),this.setElement(this._template()),this.$body=this.$(".portlet-body"),this.$title_text=this.$(".portlet-title-text"),this.$title_icon=this.$(".portlet-title-icon"),this.$header=this.$(".portlet-header"),this.$content=this.$(".portlet-content"),this.$backdrop=this.$(".portlet-backdrop"),this.$buttons=this.$(".portlet-buttons"),this.$operations=this.$(".portlet-operations"),this.model.get("body")&&this.append(this.model.get("body")),this.collapsible_button=new d.default.ButtonIcon({icon:"fa-eye",tooltip:"Collapse/Expand",cls:"ui-button-icon-plain",onclick:function(){i[i.collapsed?"expand":"collapse"]()}}),this.render()},render:function(){var t=this,e=this.model.attributes;return this.$el.removeClass().addClass(e.cls).attr("id",e.id),this.$header[e.title?"show":"hide"](),this.$title_text.html(e.title),n.each([this.$content,this.$body],function(t){t[e.nopadding?"addClass":"removeClass"]("no-padding")}),e.icon?this.$title_icon.removeClass().addClass("portlet-title-icon fa").addClass(e.icon).show():this.$title_icon.hide(),this.$title_text[e.collapsible?"addClass":"removeClass"]("no-highlight collapsible").off(),e.collapsible&&(this.$title_text.on("click",function(){t[t.collapsed?"expand":"collapse"]()}),e.collapsed?this.collapse():this.expand()),this.$title_text.prop("disabled",!e.onchange_title),e.onchange_title&&this.$title_text.make_text_editable({on_finish:function(t){e.onchange_title(t)}}),e.buttons?(this.$buttons.empty().show(),a.each(this.model.get("buttons"),function(e,i){i.$el.prop("id",e),t.$buttons.append(i.$el)})):this.$buttons.hide(),this.$operations.empty,e.collapsible_button&&this.$operations.append(this.collapsible_button.$el),e.operations&&a.each(e.operations,function(e,i){i.$el.prop("id",e),t.$operations.append(i.$el)}),this},append:function(t){this.$body.append(t)},empty:function(){this.$body.empty()},header:function(){return this.$header},body:function(){return this.$body},show:function(){this.visible=!0,this.$el.fadeIn("fast")},hide:function(){this.visible=!1,this.$el.hide()},enableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!1)},disableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!0)},hideOperation:function(t){this.$operations.find("#"+t).hide()},showOperation:function(t){this.$operations.find("#"+t).show()},setOperation:function(t,e){this.$operations.find("#"+t).off("click").on("click",e)},title:function(t){return t&&this.$title_text.html(t),this.$title_text.html()},collapse:function(){this.collapsed=!0,this.$content.height("0%"),this.$body.hide(),this.collapsible_button.setIcon("fa-eye-slash")},expand:function(){this.collapsed=!1,this.$content.height("100%"),this.$body.fadeIn("fast"),this.collapsible_button.setIcon("fa-eye")},disable:function(){this.$backdrop.show()},enable:function(){this.$backdrop.hide()},_template:function(){return a("<div/>").append(a("<div/>").addClass("portlet-header").append(a("<div/>").addClass("portlet-operations")).append(a("<div/>").addClass("portlet-title").append(a("<i/>").addClass("portlet-title-icon")).append(a("<span/>").addClass("portlet-title-text")))).append(a("<div/>").addClass("portlet-content").append(a("<div/>").addClass("portlet-body")).append(a("<div/>").addClass("portlet-buttons"))).append(a("<div/>").addClass("portlet-backdrop"))}});e.default={View:c}}).call(e,i(1),i(2),i(0))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=function(t){return t&&t.__esModule?t:{default:t}}(a),o=t.View.extend({initialize:function(e){this.model=e&&e.model||new t.Model({id:r.default.uid(),title:"",icon:"",cls:"btn btn-default",wait:!1,wait_text:"Sending...",wait_cls:"btn btn-info",disabled:!1,percentage:-1}).set(e),this.setElement(n("<button/>").attr("type","button").append(this.$icon=n("<i/>")).append(this.$title=n("<span/>")).append(this.$progress=n("<div/>").append(this.$progress_bar=n("<div/>")))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this,e=this.model.attributes;this.$el.removeClass().addClass("ui-button-default").addClass(e.disabled&&"disabled").attr("id",e.id).attr("disabled",e.disabled).off("click").on("click",function(){n(".tooltip").hide(),e.onclick&&!t.disabled&&e.onclick()}).tooltip({title:e.tooltip,placement:"bottom"}),this.$progress.addClass("progress").css("display",-1!==e.percentage?"block":"none"),this.$progress_bar.addClass("progress-bar").css({width:e.percentage+"%"}),this.$icon.removeClass().addClass("icon fa"),this.$title.removeClass().addClass("title"),e.wait?(this.$el.addClass(e.wait_cls).prop("disabled",!0),this.$icon.addClass("fa-spinner fa-spin ui-margin-right"),this.$title.html(e.wait_text)):(this.$el.addClass(e.cls),this.$icon.addClass(e.icon),this.$title.html(e.title),e.icon&&e.title&&this.$icon.addClass("ui-margin-right"))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},disable:function(){this.model.set("disabled",!0)},enable:function(){this.model.set("disabled",!1)},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},setIcon:function(t){this.model.set("icon",t)}}),s=o.extend({initialize:function(e){this.model=e&&e.model||new t.Model({id:r.default.uid(),title:"",icon:"",cls:""}).set(e),this.setElement(n("<a/>").append(this.$icon=n("<span/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this.model.attributes;this.$el.removeClass().addClass(t.cls).attr({id:t.id,href:t.href||"javascript:void(0)",title:t.title,target:t.target||"_top",disabled:t.disabled}).tooltip({placement:"bottom"}).off("click").on("click",function(){t.onclick&&!t.disabled&&t.onclick()}),this.$icon.removeClass().addClass(t.icon)}}),l=t.View.extend({initialize:function(e){this.model=e&&e.model||new t.Model({id:r.default.uid(),title:"Select/Unselect all",icons:["fa-square-o","fa-minus-square-o","fa-check-square-o"],value:0,onchange:function(){}}).set(e),this.setElement(n("<div/>").append(this.$icon=n("<span/>")).append(this.$title=n("<span/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(t){var e=this,t=this.model.attributes;this.$el.addClass("ui-button-check").off("click").on("click",function(){e.model.set("value",0===e.model.get("value")&&2||0),t.onclick&&t.onclick()}),this.$title.html(t.title),this.$icon.removeClass().addClass("icon fa ui-margin-right").addClass(t.icons[t.value])},value:function(t,e){return void 0!==t&&(e&&0!==t&&(t=t!==e&&1||2),this.model.set("value",t),this.model.get("onchange")(this.model.get("value"))),this.model.get("value")}}),d=o.extend({initialize:function(e){this.model=e&&e.model||new t.Model({id:r.default.uid(),title:"",icon:"",cls:"ui-button-icon",disabled:!1}).set(e),this.setElement(n("<div/>").append(this.$button=n("<div/>").append(this.$icon=n("<i/>")).append(this.$title=n("<span/>")))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(t){var t=this.model.attributes;this.$el.removeClass().addClass(t.cls).addClass(t.disabled&&"disabled").attr("disabled",t.disabled).attr("id",t.id).off("click").on("click",function(){n(".tooltip").hide(),!t.disabled&&t.onclick&&t.onclick()}),this.$button.addClass("button").tooltip({title:t.tooltip,placement:"bottom"}),this.$icon.removeClass().addClass("icon fa").addClass(t.icon),this.$title.addClass("title").html(t.title),t.icon&&t.title&&this.$icon.addClass("ui-margin-right")}}),c=o.extend({$menu:null,initialize:function(e){this.model=e&&e.model||new t.Model({id:"",title:"",pull:"right",icon:null,onclick:null,cls:"ui-button-icon ui-button-menu",tooltip:"",target:"",href:"",onunload:null,visible:!0,tag:""}).set(e),this.collection=new t.Collection,this.setElement(n("<div/>").append(this.$root=n("<div/>").append(this.$icon=n("<i/>")).append(this.$title=n("<span/>")))),this.listenTo(this.model,"change",this.render,this),this.listenTo(this.collection,"change add remove reset",this.render,this),this.render()},render:function(){var t=this,e=this.model.attributes;this.$el.removeClass().addClass("dropdown").addClass(e.cls).attr("id",e.id).css({display:e.visible&&this.collection.where({visible:!0}).length>0?"block":"none"}),this.$root.addClass("root button dropdown-toggle").attr("data-toggle","dropdown").tooltip({title:e.tooltip,placement:"bottom"}).off("click").on("click",function(t){n(".tooltip").hide(),t.preventDefault(),e.onclick&&e.onclick()}),this.$icon.removeClass().addClass("icon fa").addClass(e.icon),this.$title.removeClass().addClass("title").html(e.title),e.icon&&e.title&&this.$icon.addClass("ui-margin-right"),this.$menu&&this.$menu.remove(),this.collection.length>0&&(this.$menu=n("<ul/>").addClass("menu dropdown-menu").addClass("pull-"+t.model.get("pull")).attr("role","menu"),this.$el.append(this.$menu)),this.collection.each(function(e){var i=e.attributes;if(i.visible){var a=n("<a/>").addClass("dropdown-item").attr({href:i.href,target:i.target}).append(n("<i/>").addClass("fa").addClass(i.icon).css("display",i.icon?"inline-block":"none")).append(i.title).on("click",function(t){i.onclick&&(t.preventDefault(),i.onclick())});t.$menu.append(n("<li/>").append(a)),i.divider&&t.$menu.append(n("<li/>").addClass("divider"))}})},addMenu:function(t){this.collection.add(r.default.merge(t,{title:"",target:"",href:"",onclick:null,divider:!1,visible:!0,icon:null,cls:"button-menu btn-group"}))}});e.default={ButtonDefault:o,ButtonLink:s,ButtonIcon:d,ButtonCheck:l,ButtonMenu:c}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),s=i(15),l=a(s),d=i(14),c=a(d),u=i(21),h=a(u),f=i(26),p=a(f),_=i(68),m=a(_),g=i(4),v=(a(g),{toJSON:function(){var t=this,e={};return o.each(t.constructor.to_json_keys,function(i){var n=t.get(i);i in t.constructor.to_json_mappers&&(n=t.constructor.to_json_mappers[i](n,t)),e[i]=n}),e}}),b=function(e,i){var n=new p.default({url_base:Galaxy.root+"visualization/list_history_datasets",filters:e,dict_format:!0,embedded:!0}),a=new p.default({url_base:Galaxy.root+"visualization/list_library_datasets",dict_format:!0,embedded:!0}),r=new m.default.View;r.add({id:"histories",title:"Histories",$el:t("<div/>").append(n.$el)}),r.add({id:"libraries",title:"Libraries",$el:t("<div/>").append(a.$el)}),Galaxy.modal.show({title:"Select datasets for new tracks",body:r.$el,closing_events:!0,buttons:{Cancel:function(){Galaxy.modal.hide()},Add:function(){var e=[];r.$("input.grid-row-select-checkbox[name=id]:checked").each(function(){window.console.log(t(this).val()),e[e.length]=t.ajax({url:Galaxy.root+"api/datasets/"+t(this).val(),dataType:"json",data:{data_type:"track_config",hda_ldda:"histories"==r.current()?"hda":"ldda"}})}),t.when.apply(t,e).then(function(){var e=arguments[0]instanceof Array?t.map(arguments,function(t){return t[0]}):[arguments[0]];i(e)}),Galaxy.modal.hide()}}})},w=function(t){this.default_font=void 0!==t?t:"9px Monaco, Lucida Console, monospace",this.dummy_canvas=this.new_canvas(),this.dummy_context=this.dummy_canvas.getContext("2d"),this.dummy_context.font=this.default_font,this.char_width_px=this.dummy_context.measureText("A").width,this.patterns={},this.load_pattern("right_strand","/visualization/strand_right.png"),this.load_pattern("left_strand","/visualization/strand_left.png"),this.load_pattern("right_strand_inv","/visualization/strand_right_inv.png"),this.load_pattern("left_strand_inv","/visualization/strand_left_inv.png")};o.extend(w.prototype,{load_pattern:function(t,e){var i=this.patterns,n=this.dummy_context,a=new Image;a.src=Galaxy.root+"static/images"+e,a.onload=function(){i[t]=n.createPattern(a,"repeat")}},get_pattern:function(t){return this.patterns[t]},new_canvas:function(){var e=t("<canvas/>")[0];return e.manager=this,e}});var y=n.Model.extend({defaults:{num_elements:20,obj_cache:null,key_ary:null},initialize:function(t){this.clear()},get_elt:function(t){var e=this.attributes.obj_cache,i=this.attributes.key_ary,n=t.toString(),a=o.indexOf(i,function(t){return t.toString()===n});return-1!==a&&(e[n].stale?(i.splice(a,1),delete e[n]):this.move_key_to_end(t,a)),e[n]},set_elt:function(t,e){var i=this.attributes.obj_cache,n=this.attributes.key_ary,a=t.toString(),r=this.attributes.num_elements;if(!i[a]){if(n.length>=r){delete i[n.shift().toString()]}n.push(t)}return i[a]=e,e},move_key_to_end:function(t,e){this.attributes.key_ary.splice(e,1),this.attributes.key_ary.push(t)},clear:function(){this.attributes.obj_cache={},this.attributes.key_ary=[]},size:function(){return this.attributes.key_ary.length},most_recently_added:function(){return 0===this.size()?null:this.attributes.key_ary[this.attributes.key_ary.length-1]}}),x=y.extend({defaults:o.extend({},y.prototype.defaults,{dataset:null,genome:null,init_data:null,min_region_size:200,filters_manager:null,data_type:"data",data_mode_compatible:function(t,e){return!0},can_subset:function(t){return!1}}),initialize:function(t){y.prototype.initialize.call(this);var e=this.get("init_data");e&&this.add_data(e)},add_data:function(t){this.get("num_elements")<t.length&&this.set("num_elements",t.length);var e=this;o.each(t,function(t){e.set_data(t.region,t)})},data_is_ready:function(){var e=this.get("dataset"),i=t.Deferred(),n="raw_data"===this.get("data_type")?"state":"data"===this.get("data_type")?"converted_datasets_state":"error",a=new c.default.ServerStateDeferred({ajax_settings:{url:this.get("dataset").url(),data:{hda_ldda:e.get("hda_ldda"),data_type:n},dataType:"json"},interval:5e3,success_fn:function(t){return"pending"!==t}});return t.when(a.go()).then(function(t){i.resolve("ok"===t||"data"===t)}),i},search_features:function(e){var i=this.get("dataset"),n={query:e,hda_ldda:i.get("hda_ldda"),data_type:"features"};return t.getJSON(i.url(),n)},load_data:function(e,i,n,a){var r=this.get("dataset"),o={data_type:this.get("data_type"),chrom:e.get("chrom"),low:e.get("start"),high:e.get("end"),mode:i,resolution:n,hda_ldda:r.get("hda_ldda")};t.extend(o,a);var s=this.get("filters_manager");if(s){for(var l=[],d=s.filters,c=0;c<d.length;c++)l.push(d[c].name);o.filter_cols=JSON.stringify(l)}var u=this,h=t.getJSON(r.url(),o,function(t){t.region=e,u.set_data(e,t)});return this.set_data(e,h),h},get_data:function(t,e,i,n){var a=this.get_elt(t);if(a&&(c.default.is_deferred(a)||this.get("data_mode_compatible")(a,e)))return a;for(var r,o,s=this.get("key_ary"),l=this.get("obj_cache"),d=0;d<s.length;d++)if(r=s[d],r.contains(t)&&(o=!0,a=l[r.toString()],c.default.is_deferred(a)||this.get("data_mode_compatible")(a,e)&&this.get("can_subset")(a))){if(this.move_key_to_end(r,d),!c.default.is_deferred(a)){var u=this.subset_entry(a,t);this.set_data(t,u),a=u}return a}if(!o&&t.length()<this.attributes.min_region_size){t=t.copy();var h=this.most_recently_added();!h||t.get("start")>h.get("start")?t.set("end",t.get("start")+this.attributes.min_region_size):t.set("start",t.get("end")-this.attributes.min_region_size),t.set("genome",this.attributes.genome),t.trim()}return this.load_data(t,e,i,n)},set_data:function(t,e){this.set_elt(t,e)},DEEP_DATA_REQ:"deep",BROAD_DATA_REQ:"breadth",get_more_data:function(e,i,n,a,r){var o=this._mark_stale(e);if(!o||!this.get("data_mode_compatible")(o,i))return void console.log("ERROR: problem with getting more data: current data is not compatible");var s=e.get("start");r===this.DEEP_DATA_REQ?t.extend(a,{start_val:o.data.length+1}):r===this.BROAD_DATA_REQ&&(s=(o.max_high?o.max_high:o.data[o.data.length-1][2])+1);var l=e.copy().set("start",s),d=this,c=this.load_data(l,i,n,a),u=t.Deferred();return this.set_data(e,u),t.when(c).then(function(t){t.data&&(t.data=o.data.concat(t.data),t.max_low&&(t.max_low=o.max_low),t.message&&(t.message=t.message.replace(/[0-9]+/,t.data.length))),d.set_data(e,t),u.resolve(t)}),u},can_get_more_detailed_data:function(t){var e=this.get_elt(t);return"bigwig"===e.dataset_type&&e.data.length<8e3},get_more_detailed_data:function(t,e,i,n,a){var r=this._mark_stale(t);return r?(a||(a={}),"bigwig"===r.dataset_type&&(a.num_samples=1e3*n),this.load_data(t,e,i,a)):void console.log("ERROR getting more detailed data: no current data")},_mark_stale:function(t){var e=this.get_elt(t);return e||console.log("ERROR: no data to mark as stale: ",this.get("dataset"),t.toString()),e.stale=!0,e},get_genome_wide_data:function(e){var i=this,n=!0,a=o.map(e.get("chroms_info").chrom_info,function(t){var e=i.get_elt(new S({chrom:t.chrom,start:0,end:t.len}));return e||(n=!1),e});if(n)return a;var r=t.Deferred();return t.getJSON(this.get("dataset").url(),{data_type:"genome_data"},function(t){i.add_data(t.data),r.resolve(t.data)}),r},subset_entry:function(t,e){var i={bigwig:function(t,e){return o.filter(t,function(t){return t[0]>=e.get("start")&&t[0]<=e.get("end")})},refseq:function(e,i){var n=i.get("start")-t.region.get("start");return t.data.slice(n,n+i.length())}},n=t.data;return!t.region.same(e)&&t.dataset_type in i&&(n=i[t.dataset_type](t.data,e)),{region:e,data:n,dataset_type:t.dataset_type}}}),k=x.extend({initialize:function(t){var e=new n.Model;e.urlRoot=t.data_url,this.set("dataset",e)},load_data:function(t,e,i,n){return t.length()<=1e5?x.prototype.load_data.call(this,t,e,i,n):{data:null,region:t}}}),C=n.Model.extend({defaults:{name:null,key:null,chroms_info:null},initialize:function(t){this.id=t.dbkey},get_chroms_info:function(){return this.attributes.chroms_info.chrom_info},get_chrom_region:function(t){var e=o.find(this.get_chroms_info(),function(e){return e.chrom===t});return new S({chrom:e.chrom,end:e.len})},get_chrom_len:function(t){return o.find(this.get_chroms_info(),function(e){return e.chrom===t}).len}}),S=n.Model.extend({defaults:{chrom:null,start:0,end:0,str_val:null,genome:null},same:function(t){return this.attributes.chrom===t.get("chrom")&&this.attributes.start===t.get("start")&&this.attributes.end===t.get("end")},initialize:function(t){if(t.from_str){var e=t.from_str.split(":"),i=e[0],n=e[1].split("-");this.set({chrom:i,start:parseInt(n[0],10),end:parseInt(n[1],10)})}this.attributes.str_val=this.get("chrom")+":"+this.get("start")+"-"+this.get("end"),this.on("change",function(){this.attributes.str_val=this.get("chrom")+":"+this.get("start")+"-"+this.get("end")},this)},copy:function(){return new S({chrom:this.get("chrom"),start:this.get("start"),end:this.get("end")})},length:function(){return this.get("end")-this.get("start")},toString:function(){return this.attributes.str_val},toJSON:function(){return{chrom:this.get("chrom"),start:this.get("start"),end:this.get("end")}},compute_overlap:function(t){var e=this.get("chrom"),i=t.get("chrom"),n=this.get("start"),a=t.get("start"),r=this.get("end"),o=t.get("end");return e&&i&&e!==i?S.overlap_results.DIF_CHROMS:n<a?r<a?S.overlap_results.BEFORE:r<o?S.overlap_results.OVERLAP_START:S.overlap_results.CONTAINS:n>a?n>o?S.overlap_results.AFTER:r<=o?S.overlap_results.CONTAINED_BY:S.overlap_results.OVERLAP_END:r>=o?S.overlap_results.CONTAINS:S.overlap_results.CONTAINED_BY},trim:function(t){if(this.attributes.start<0&&(this.attributes.start=0),this.attributes.genome){var e=this.attributes.genome.get_chrom_len(this.attributes.chrom);this.attributes.end>e&&(this.attributes.end=e-1)}return this},contains:function(t){return this.compute_overlap(t)===S.overlap_results.CONTAINS},overlaps:function(t){return 0===o.intersection([this.compute_overlap(t)],[S.overlap_results.DIF_CHROMS,S.overlap_results.BEFORE,S.overlap_results.AFTER]).length}},{overlap_results:{DIF_CHROMS:1e3,BEFORE:1001,CONTAINS:1002,OVERLAP_START:1003,OVERLAP_END:1004,CONTAINED_BY:1005,AFTER:1006}}),$=n.Collection.extend({model:S}),T=n.Model.extend({defaults:{region:null,note:""},initialize:function(t){this.set("region",new S(t.region))}}),M=n.Collection.extend({model:T}),O=n.Model.extend(v).extend({defaults:{mode:"Auto"},initialize:function(t){this.set("dataset",new l.default.Dataset(t.dataset));var e=[{key:"name",default_value:this.get("dataset").get("name")},{key:"color"},{key:"min_value",label:"Min Value",type:"float",default_value:0},{key:"max_value",label:"Max Value",type:"float",default_value:1}];this.set("config",h.default.ConfigSettingCollection.from_models_and_saved_values(e,t.prefs));var i=this.get("preloaded_data");i=i?i.data:[],this.set("data_manager",new x({dataset:this.get("dataset"),init_data:i}))}},{to_json_keys:["track_type","dataset","prefs","mode","filters","tool_state"],to_json_mappers:{prefs:function(t,e){return 0===o.size(t)&&(t={name:e.get("config").get("name").get("value"),color:e.get("config").get("color").get("value")}),t},dataset:function(t){return{id:t.id,hda_ldda:t.get("hda_ldda")}}}}),A=n.Collection.extend({model:O}),E=n.Model.extend({defaults:{title:"",type:""},urlRoot:Galaxy.root+"api/visualizations",save:function(){return t.ajax({url:this.url(),type:"POST",dataType:"json",data:{vis_json:JSON.stringify(this)}})}}),z=E.extend(v).extend({defaults:o.extend({},E.prototype.defaults,{dbkey:"",drawables:null,bookmarks:null,viewport:null}),initialize:function(t){this.set("drawables",new A(t.tracks));var e=[];this.set("config",h.default.ConfigSettingCollection.from_models_and_saved_values(e,t.prefs)),this.unset("tracks"),this.get("drawables").each(function(t){t.unset("preloaded_data")})},add_tracks:function(t){this.get("drawables").add(t)}},{to_json_keys:["view","viewport","bookmarks"],to_json_mappers:{view:function(t,e){return{obj_type:"View",prefs:{name:e.get("title"),content_visible:!0},drawables:e.get("drawables")}}}}),R=n.Router.extend({initialize:function(t){this.view=t.view,this.route(/([\w]+)$/,"change_location"),this.route(/([\w\+]+\:[\d,]+-[\d,]+)$/,"change_location");var e=this;e.view.on("navigate",function(t){e.navigate(t)})},change_location:function(t){this.view.go_to(t)}});e.default={BackboneTrack:O,BrowserBookmark:T,BrowserBookmarkCollection:M,Cache:y,CanvasManager:w,Genome:C,GenomeDataManager:x,GenomeRegion:S,GenomeRegionCollection:$,GenomeVisualization:z,GenomeReferenceDataManager:k,TrackBrowserRouter:R,Visualization:E,select_datasets:b}}).call(e,i(0),i(1))},function(t,e,i){"use strict";(function(t,i){function n(t){t+="";for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){return"promise"in t},r=t.Model.extend({defaults:{ajax_settings:{},interval:1e3,success_fn:function(t){return!0}},go:function(){var t=i.Deferred(),e=this,n=e.get("ajax_settings"),a=e.get("success_fn"),r=e.get("interval");return function e(){i.ajax(n).success(function(i){a(i)?t.resolve(i):setTimeout(e,r)})}(),t}}),o=function(t){t||(t="#ffffff"),"string"==typeof t&&(t=[t]);for(var e=0;e<t.length;e++)t[e]=parseInt(t[e].slice(1),16);var i,n,a,r,o,s,l,d,c,u,h,f=function(t,e,i){return(299*t+587*e+114*i)/1e3},p=!1,_=0;do{for(i=Math.round(16777215*Math.random()),n=(16711680&i)>>16,a=(65280&i)>>8,r=255&i,c=f(n,a,r),p=!0,e=0;e<t.length;e++)if(o=t[e],s=(16711680&o)>>16,l=(65280&o)>>8,d=255&o,u=f(s,l,d),h=function(t,e,i,n,a,r){return Math.max(t,n)-Math.min(t,n)+(Math.max(e,a)-Math.min(e,a))+(Math.max(i,r)-Math.min(i,r))}(n,a,r,s,l,d),Math.abs(c-u)<40||h<200){p=!1;break}_++}while(!p&&_<=10);return"#"+(16777216+i).toString(16).substr(1,6)};e.default={commatize:n,is_deferred:a,ServerStateDeferred:r,get_random_color:o}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(9),s=(r(o),i(45)),l=(r(s),i(41)),d=r(l),c=t.Model.extend({}),u=t.Model.extend({defaults:{id:"",type:"",name:"",hda_ldda:"hda",metadata:null},initialize:function(){this.get("metadata")||this._set_metadata(),this.on("change",this._set_metadata,this)},_set_metadata:function(){var t=new c;n.each(n.keys(this.attributes),function(e){if(0===e.indexOf("metadata_")){var i=e.split("metadata_")[1];t.set(i,this.attributes[e]),delete this.attributes[e]}},this),this.set("metadata",t,{silent:!0})},get_metadata:function(t){return this.attributes.metadata.get(t)},urlRoot:Galaxy.root+"api/datasets"}),h=u.extend({defaults:n.extend({},u.prototype.defaults,{chunk_url:null,first_data_chunk:null,offset:0,at_eof:!1}),initialize:function(t){u.prototype.initialize.call(this),this.attributes.first_data_chunk&&(this.attributes.offset=this.attributes.first_data_chunk.offset),this.attributes.chunk_url=Galaxy.root+"dataset/display?dataset_id="+this.id,this.attributes.url_viz=Galaxy.root+"visualization"},get_next_chunk:function(){if(this.attributes.at_eof)return null;var t=this,e=a.Deferred();return a.getJSON(this.attributes.chunk_url,{offset:t.attributes.offset}).success(function(i){var n;""!==i.ck_data?(n=i,t.attributes.offset=i.offset):(t.attributes.at_eof=!0,n=null),e.resolve(n)}),e}}),f=t.Collection.extend({model:u}),p=t.View.extend({initialize:function(t){this.row_count=0,this.loading_chunk=!1,new g({model:t.model,$el:this.$el})},expand_to_container:function(){this.$el.height()<this.scroll_elt.height()&&this.attempt_to_fetch()},attempt_to_fetch:function(t){var e=this;!this.loading_chunk&&this.scrolled_to_bottom()&&(this.loading_chunk=!0,this.loading_indicator.show(),a.when(e.model.get_next_chunk()).then(function(t){t&&(e._renderChunk(t),e.loading_chunk=!1),e.loading_indicator.hide(),e.expand_to_container()}))},render:function(){this.loading_indicator=a("<div/>").attr("id","loading_indicator"),this.$el.append(this.loading_indicator);var t=a("<table/>").attr({id:"content_table",cellpadding:0});this.$el.append(t);var e=this.model.get_metadata("column_names"),i=a("<thead/>").appendTo(t),n=a("<tr/>").appendTo(i);if(e)n.append("<th>"+e.join("</th><th>")+"</th>");else for(var r=1;r<=this.model.get_metadata("columns");r++)n.append("<th>"+r+"</th>");var o=this,s=this.model.get("first_data_chunk");s?this._renderChunk(s):a.when(o.model.get_next_chunk()).then(function(t){o._renderChunk(t)}),this.scroll_elt.scroll(function(){o.attempt_to_fetch()})},scrolled_to_bottom:function(){return!1},_renderCell:function(t,e,i){var n=a("<td>").text(t),r=this.model.get_metadata("column_types");return void 0!==i?n.attr("colspan",i).addClass("stringalign"):r&&e<r.length&&("str"!==r[e]&&"list"!==r[e]||n.addClass("stringalign")),n},_renderRow:function(t){var e=t.split("\t"),i=a("<tr>"),r=this.model.get_metadata("columns");return this.row_count%2!=0&&i.addClass("dark_row"),e.length===r?n.each(e,function(t,e){i.append(this._renderCell(t,e))},this):e.length>r?(n.each(e.slice(0,r-1),function(t,e){i.append(this._renderCell(t,e))},this),i.append(this._renderCell(e.slice(r-1).join("\t"),r-1))):1===e.length?i.append(this._renderCell(t,0,r)):(n.each(e,function(t,e){i.append(this._renderCell(t,e))},this),n.each(n.range(r-e.length),function(){i.append(a("<td>"))})),this.row_count++,i},_renderChunk:function(t){var e=this.$el.find("table");n.each(t.ck_data.split("\n"),function(t,i){""!==t&&e.append(this._renderRow(t))},this)}}),_=p.extend({initialize:function(t){p.prototype.initialize.call(this,t);var e=n.find(this.$el.parents(),function(t){return"auto"===a(t).css("overflow")});e||(e=window),this.scroll_elt=a(e)},scrolled_to_bottom:function(){return this.$el.height()-this.scroll_elt.scrollTop()-this.scroll_elt.height()<=0}}),m=p.extend({initialize:function(t){p.prototype.initialize.call(this,t),this.scroll_elt=this.$el.css({position:"relative",overflow:"scroll",height:t.height||"500px"})},scrolled_to_bottom:function(){return this.$el.scrollTop()+this.$el.innerHeight()>=this.el.scrollHeight}}),g=t.View.extend({col:{chrom:null,start:null,end:null},url_viz:null,dataset_id:null,genome_build:null,file_ext:null,initialize:function(t){var e=parent.Galaxy;if(e&&e.modal&&(this.modal=e.modal),e&&e.frame&&(this.frame=e.frame),this.modal&&this.frame){var i=t.model,n=i.get("metadata");if(i.get("file_ext")){if(this.file_ext=i.get("file_ext"),"bed"==this.file_ext){if(!(n.get("chromCol")&&n.get("startCol")&&n.get("endCol")))return void console.log("TabularButtonTrackster : Bed-file metadata incomplete.");this.col.chrom=n.get("chromCol")-1,this.col.start=n.get("startCol")-1,this.col.end=n.get("endCol")-1}if("vcf"==this.file_ext){var a=function(t,e){for(var i=0;i<e.length;i++)if(e[i].match(t))return i;return-1};if(this.col.chrom=a("Chrom",n.get("column_names")),this.col.start=a("Pos",n.get("column_names")),this.col.end=null,-1==this.col.chrom||-1==this.col.start)return void console.log("TabularButtonTrackster : VCF-file metadata incomplete.")}if(void 0!==this.col.chrom){if(!i.id)return void console.log("TabularButtonTrackster : Dataset identification is missing.");if(this.dataset_id=i.id,!i.get("url_viz"))return void console.log("TabularButtonTrackster : Url for visualization controller is missing.");this.url_viz=i.get("url_viz"),i.get("genome_build")&&(this.genome_build=i.get("genome_build"));var r=new d.default.IconButtonView({model:new d.default.IconButton({title:"Visualize",icon_class:"chart_curve",id:"btn_viz"})});this.setElement(t.$el),this.$el.append(r.render().$el),this.hide()}}}},events:{"mouseover tr":"show",mouseleave:"hide"},show:function(t){var e=this;if(null!==this.col.chrom){var i=a(t.target).parent(),n=i.children().eq(this.col.chrom).html(),r=i.children().eq(this.col.start).html(),o=this.col.end?i.children().eq(this.col.end).html():r;if(!n.match("^#")&&""!==n&&function(t){return!isNaN(parseFloat(t))&&isFinite(t)}(r)){var s={dataset_id:this.dataset_id,gene_region:n+":"+r+"-"+o},l=i.offset(),d=l.left-10,c=l.top-a(window).scrollTop()+3;a("#btn_viz").css({position:"fixed",top:c+"px",left:d+"px"}),a("#btn_viz").off("click"),a("#btn_viz").click(function(){e.frame.add({title:"Trackster",url:e.url_viz+"/trackster?"+a.param(s)})}),a("#btn_viz").show()}else a("#btn_viz").hide()}},hide:function(){this.$("#btn_viz").hide()}}),v=function(t){t.model||(t.model=new h(t.dataset_config));var e=t.parent_elt,i=t.embedded;delete t.embedded,delete t.parent_elt,delete t.dataset_config;var n=i?new m(t):new _(t);return n.render(),e&&(e.append(n.$el),n.expand_to_container()),n};e.default={Dataset:u,TabularDataset:h,DatasetCollection:f,TabularDatasetChunkedView:p,createTabularDatasetChunkedView:v}}).call(e,i(1),i(2),i(0))},function(t,e,i){"use strict";(function(e){function n(t,e){!a.isUndefined(t)&&a.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var a=i(5),r=i(77),o={"Content-Type":"application/x-www-form-urlencoded"},s={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=i(28):void 0!==e&&(t=i(28)),t}(),transformRequest:[function(t,e){return r(e,"Content-Type"),a.isFormData(t)||a.isArrayBuffer(t)||a.isBuffer(t)||a.isStream(t)||a.isFile(t)||a.isBlob(t)?t:a.isArrayBufferView(t)?t.buffer:a.isURLSearchParams(t)?(n(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):a.isObject(t)?(n(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};s.headers={common:{Accept:"application/json, text/plain, */*"}},a.forEach(["delete","get","head"],function(t){s.headers[t]={}}),a.forEach(["post","put","patch"],function(t){s.headers[t]=a.merge(o)}),t.exports=s}).call(e,i(76))},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(18)),n(i(19)),n(i(96))},function(t,e,i){"use strict";function n(t,e,i,n){if(void 0===n&&(n={writable:!0,enumerable:!0,configurable:!0}),!(t instanceof Object))throw new TypeError('"target" isn\'t an Object instance');if(void 0!==e){if(!(e instanceof Object))throw new TypeError('"properties" isn\'t an Object instance');if(void 0===n)n={writable:!0,enumerable:!0,configurable:!0};else if(!(n instanceof Object))throw new TypeError('"attributes" isn\'t an Object instance');if(void 0===i)for(var a in e)void 0!==e[a]&&Object.defineProperty(t,a,Object.create(n,{value:{value:e[a]}}));else if(i instanceof Array)i.forEach(function(i){void 0!==e[i]&&Object.defineProperty(t,i,Object.create(n,{value:{value:e[i]}}))});else{if(!(i instanceof Object))throw new TypeError('"keys" isn\'t an Object instance');for(var r in i){var a=i[r];void 0!==e[a]&&Object.defineProperty(t,r,Object.create(n,{value:{value:e[a]}}))}}}}function a(t,e,i,n){if(void 0===n&&(n=!0),!(t instanceof Object))throw new TypeError('"target" isn\'t an Object instance');if(void 0===e)return!0;if(!(e instanceof Object))throw new TypeError('"properties" isn\'t an Object instance');if(void 0===n&&(n=!0),void 0===i){for(var a in e)if(t[a]!==e[a]&&(void 0!==e[a]||!n))return!1}else{if(i instanceof Array)return i.every(function(i){return t[i]===e[i]||void 0===e[i]&&n});if(!(i instanceof Object))throw new TypeError('"keys" isn\'t an Object instance');for(var r in i){var a=i[r];if(t[r]!==e[a]&&(void 0!==e[a]||!n))return!1}}return!0}function r(t){return"number"==typeof t}function o(t){return"string"==typeof t}function s(t,e){if(!t)throw new Error(e);return t}function l(t,e){if(!(t instanceof Object))throw new TypeError(e||"Expected Object");return t}function d(t,e){if("string"!=typeof t)throw new TypeError(e||"Expected string");return t}function c(t,e){if(!u(t))throw new TypeError(e||"Expected Array");return t}function u(t){return!!t&&t.constructor===Array}function h(t,e){return[].concat.apply([],t.map(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.updateProperties=n,e.testProperties=a,e.mustBeNumber=function(t,e){if(!r(t))throw new TypeError(e||"Expected number");return t},e.isNumber=r,e.isString=o,e.mustNotBeUndefined=s,e.mustBeObject=l,e.mustBeString=d,e.mustBeArray=c,e.isArray=u,e.mconcat=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduceRight(t)},e.snd=function(t){return t[1]},e.concatMap=h},function(t,e,i){"use strict";function n(t){return r(t)||o(t)}function a(t){return e.measureTypes.hasOwnProperty(t)}function r(t){return a(t.type)&&X.isNumber(t.value)}function o(t){return _(t.expression)}function s(t){if(void 0===t)return!1;switch(t){case"Parentheses":case"Square":case"Dollar":return!0;default:return!1}}function l(t,e){return void 0!==t&&(void 0===e?"string"==typeof t.name:e===t.name)}function d(t){return void 0!==t&&"string"==typeof t.text}function c(t){return void 0!==t&&X.isArray(t.latex)}function u(t){return t.arguments instanceof Array}function h(t){return t===W.SUP||t===W.SUB}function f(t){switch(t){case"#":return"\\#";case"$":return"\\$";case"%":return"\\%";case"^":return"\\^{}";case"&":return"\\&";case"{":return"\\{";case"}":return"\\}";case"~":return"\\~{}";case"\\":return"\\textbackslash{}";case"_":return"\\_{}";default:return t}}function p(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return 0===e.length?"string"==typeof t.type:e.some(function(e){return t.type===e})}function _(t){return g(t)||m(t)}function m(t){return A(t)||b(t)||w(t)||x(t)||k(t)||C(t)||$(t)||O(t)}function g(t){return A(t)||v(t)||w(t)||x(t)||k(t)||C(t)||$(t)||O(t)}function v(t){return void 0!==t&&void 0!==t.type&&d(t)&&p(t,e.typeTeXRaw)}function b(t){return void 0!==t&&"string"==typeof t.string&&"number"==typeof t.category}function w(t){return l(t)&&u(t)&&p(t,e.typeTeXComm,e.typeTeXCommS)}function y(t){return w(t)&&0===t.arguments.length}function x(t,i){return p(t,e.typeTeXEnv)}function k(t){return c(t)&&p(t)&&s(t.type)}function C(t){return void 0!==t&&"boolean"==typeof t.noNewPage&&(void 0===t.measure||n(t.measure))}function S(t){return h(t.type)}function $(t){return c(t)&&p(t,e.typeTeXBraces)}function T(t){return p(t,"FixArg")}function M(t){return p(t,"OptArg")}function O(t){return d(t)&&p(t,e.typeTeXComment)}function A(t){return void 0!==t&&0===Object.keys(t).length}function E(t){return{type:"FixArg",latex:t}}function z(t){return 1===t.length?{type:"OptArg",latex:t}:{type:"MOptArg",latex:t}}function R(t){return{type:"SymArg",latex:[t]}}function P(t){return{type:"ParArg",latex:[t]}}function j(t){return{type:"MOptArg",latex:t}}function q(t){return{type:"MSymArg",latex:t}}function D(t){return{type:"MParArg",latex:t}}function I(t){return{name:t,arguments:[],type:e.typeTeXCommS}}function L(t){return{text:t,type:e.typeTeXRaw,characterCategories:J.convertToTeXCharsDefault(t)}}function N(t,e,i,n){return{latex:n,type:t,startSymbol:e,endSymbol:i}}function B(t){return{latex:[t],type:e.typeTeXBraces}}function V(t){return{text:t,type:e.typeTeXComment}}function G(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return{name:t,arguments:i,type:e.typeTeXComm}}function U(t,e,i){return{type:t,symbol:e,arguments:i}}function F(t,i){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return{name:t,latex:i,arguments:n,type:e.typeTeXEnv}}function H(t){var e=[];return Y(t,e),e.join("")}function Y(t,e){if(w(t))e.push("\\",t.name),t.arguments.forEach(function(t){return Y(t,e)});else{if(x(t))throw new Error("not supported yet");if(k(t))e.push(t.startSymbol),t.latex.forEach(function(t){return Y(t,e)}),e.push(t.endSymbol);else if(C(t))e.push("\n");else if(S(t))e.push(t.symbol),t.arguments&&t.arguments.forEach(function(t){return Y(t,e)});else if($(t))e.push("{"),t.latex.forEach(function(t){return Y(t,e)}),e.push("}");else if(O(t))e.push("%"+t.text+"\n");else if(v(t))e.push(t.text);else{if(b(t))throw new Error("not supported yet");if(T(t))e.push("{"),t.latex.forEach(function(t){return Y(t,e)}),e.push("}");else{if(!M(t))throw new Error("Did not recognize "+JSON.stringify(t));e.push("["),t.latex.forEach(function(t){return Y(t,e)}),e.push("]")}}}}Object.defineProperty(e,"__esModule",{value:!0});var X=i(18),J=i(33);e.isMeasure=n,e.measureTypes={pt:!0,mm:!0,cm:!0,in:!0,ex:!0,em:!0},e.isMeasureType=a,e.isBuiltInMeasure=r,e.isCustomMeasure=o,e.mathTypes={Parentheses:"Parentheses",Square:"Square",Dollar:"Dollar"},e.isMathType=s,e.isNameHaving=l,e.isTextHaving=d,e.isLaTeXHaving=c,e.isArgumentHaving=u,e.typeTeXSeq="TeXSeq",e.typeTeXEnv="TeXEnv",e.typeTeXBraces="TeXBraces",e.typeTeXComment="TeXComment",e.typeTeXRaw="TeXRaw",e.typeTeXComm="TeXComm",e.typeTeXCommS="TeXCommS";var W;!function(t){t[t.SUP=0]="SUP",t[t.SUB=1]="SUB"}(W=e.SubOrSuperSymbol||(e.SubOrSuperSymbol={})),e.isSubOrSuperSymbol=h,e.fromStringLaTeX=function(t){return L(e.protectString(t))},e.protectString=function(t){for(var e=[],i=0;i<t.length;i++)e.push(f(t.charAt(i)));return e.join()},e.protectChar=f,e.isTypeHaving=p,e.isLaTeXBlock=_,e.isLaTeXNoRaw=m,e.isLaTeXRaw=g,e.isTeXRaw=v,e.isTeXChar=b,e.isTeXComm=w,e.isTeXCommS=y,e.isTeXEnv=x,e.isTeXMath=k,e.isTeXLineBreak=C,e.isSubOrSuperScript=S,e.isTeXBraces=$,e.isFixArg=T,e.isOptArg=M,e.isTeXComment=O,e.isTeXEmpty=A,e.newFixArg=E,e.newOptArg=z,e.newSymArg=R,e.newParArg=P,e.newMOptArg=j,e.newMSymArg=q,e.newMParArg=D,e.newCommandS=I,e.newTeXRaw=L,e.newTeXMath=N,e.newTeXBraces=B,e.newTeXMathDol=function(t){return N("Dollar","$","$",t)},e.newTeXComment=V,e.newTeXComm=G,e.newSubOrSuperScript=U,e.newTeXEnv=F,e.stringifyLaTeX=H},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=(r(o),i(11)),l=r(s),d=i(4),c=r(d),u=i(48),h=r(u),f=i(44),p=r(f);e.default=t.View.extend({initialize:function(e){this.model=new t.Model({initial_errors:!1,cls:"ui-portlet-limited",icon:null,always_refresh:!0,status:"warning",hide_operations:!1,onchange:function(){}}).set(e),this.setElement("<div/>"),this.render()},update:function(t){var e=this;this.data.matchModel(t,function(t,i){var a=e.input_list[i];if(a&&a.options&&!n.isEqual(a.options,t.options)){a.options=t.options;var r=e.field_list[i];if(r.update){var o=[];if(-1!=["data","data_collection","drill_down"].indexOf(a.type))o=a.options;else for(var s in t.options){var l=t.options[s];l.length>2&&o.push({label:l[0],value:l[1]})}r.update(o),r.trigger("change"),Galaxy.emit.debug("form-view::update()","Updating options for "+i)}}})},wait:function(t){for(var e in this.input_list){var i=this.field_list[e];this.input_list[e].is_dynamic&&i.wait&&i.unwait&&i[t?"wait":"unwait"]()}},highlight:function(t,e,i){var n=this.element_list[t];if(n&&(n.error(e||"Please verify this parameter."),this.portlet.expand(),this.trigger("expand",t),!i)){var r=this.$el.parents().filter(function(){return-1!=["auto","scroll"].indexOf(a(this).css("overflow"))}).first();r.animate({scrollTop:r.scrollTop()+n.$el.offset().top-120},500)}},errors:function(t){if(this.trigger("reset"),t&&t.errors){var e=this.data.matchResponse(t.errors);for(var i in this.element_list){this.element_list[i];e[i]&&this.highlight(i,e[i],!0)}}},render:function(){var t=this;this.off("change"),this.off("reset"),this.field_list={},this.input_list={},this.element_list={},this.data=new p.default.Manager(this),this._renderForm(),this.data.create(),this.model.get("initial_errors")&&this.errors(this.model.attributes);var e=this.data.checksum();return this.on("change",function(i){var n=t.input_list[i];if(!n||n.refresh_on_change||t.model.get("always_refresh")){var a=t.data.checksum();a!=e&&(e=a,t.model.get("onchange")())}}),this.on("reset",function(){n.each(t.element_list,function(t){t.reset()})}),this},_renderForm:function(){a(".tooltip").remove();var t=this.model.attributes;this.message=new c.default.UnescapedMessage,this.section=new h.default.View(this,{inputs:t.inputs}),this.portlet=new l.default.View({icon:t.icon,title:t.title,cls:t.cls,operations:!t.hide_operations&&t.operations,buttons:t.buttons,collapsible:t.collapsible,collapsed:t.collapsed,onchange_title:t.onchange_title}),this.portlet.append(this.message.$el),this.portlet.append(this.section.$el),this.$el.empty(),t.inputs&&this.$el.append(this.portlet.$el),t.message&&this.message.update({persistent:!0,status:t.status,message:t.message}),Galaxy.emit.debug("form-view::initialize()","Completed")}})}).call(e,i(1),i(2),i(0))},function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),s=i(14),l=a(s),d=i(21),c=(a(d),t.Model.extend({initialize:function(t){var e=this.get("key");this.set("id",e);var i=o.find([{key:"name",label:"Name",type:"text",default_value:""},{key:"color",label:"Color",type:"color",default_value:null},{key:"min_value",label:"Min Value",type:"float",default_value:null},{key:"max_value",label:"Max Value",type:"float",default_value:null},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:32,hidden:!0},{key:"pos_color",label:"Positive Color",type:"color",default_value:"#FF8C00"},{key:"neg_color",label:"Negative Color",type:"color",default_value:"#4169E1"},{key:"block_color",label:"Block color",type:"color",default_value:null},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_insertions",label:"Show insertions",type:"bool",default_value:!1},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0},{key:"reverse_strand_color",label:"Antisense strand color",type:"color",default_value:null},{key:"show_differences",label:"Show differences only",type:"bool",default_value:!0}],function(t){return t.key===e});i&&this.set(o.extend({},i,t)),void 0===this.get("value")&&void 0!==this.get("default_value")&&(this.set_value(this.get("default_value")),this.get("value")||"color"!==this.get("type")||this.set("value",l.default.get_random_color()))},set_value:function(t,e){var i=this.get("type");"float"===i?t=parseFloat(t):"int"===i&&(t=parseInt(t,10)),this.set({value:t},e)}})),u=t.Collection.extend({model:c,to_key_value_dict:function(){var t={};return this.each(function(e){t[e.get("key")]=e.get("value")}),t},get_value:function(t){var e=this.get(t);if(e)return e.get("value")},set_value:function(t,e,i){var n=this.get(t);if(n)return n.set_value(e,i)},set_default_value:function(t,e){var i=this.get(t);if(i)return i.set("default_value",e)}},{from_models_and_saved_values:function(t,e){return e&&(t=o.map(t,function(t){return o.extend({},t,{value:e[t.key]})})),new u(t)}}),h=t.View.extend({className:"config-settings-view",render:function(){var t=this.$el;return this.collection.each(function(e,i){if(!e.get("hidden")){var a="param_"+i,r=e.get("type"),s=e.get("value"),d=n("<div class='form-row' />").appendTo(t);if(d.append(n("<label />").attr("for",a).text(e.get("label")+":")),"bool"===r)d.append(n('<input type="checkbox" />').attr("id",a).attr("name",a).attr("checked",s));else if("text"===r)d.append(n('<input type="text"/>').attr("id",a).val(s).click(function(){n(this).select()}));else if("select"===r){var c=n("<select />").attr("id",a);o.each(e.get("options"),function(t){n("<option/>").text(t.label).attr("value",t.value).appendTo(c)}),c.val(s),d.append(c)}else if("color"===r){var u=n("<div/>").appendTo(d),h=n("<input />").attr("id",a).attr("name",a).val(s).css("float","left").appendTo(u).click(function(t){n(".tooltip").removeClass("in");var e=n(this).siblings(".tooltip").addClass("in");e.css({left:n(this).position().left+n(this).width()+5,top:n(this).position().top-n(e).height()/2+n(this).height()/2}).show(),e.click(function(t){t.stopPropagation()}),n(document).bind("click.color-picker",function(){e.hide(),n(document).unbind("click.color-picker")}),t.stopPropagation()}),f=n("<a href='javascript:void(0)'/>").addClass("icon-button arrow-circle").appendTo(u).attr("title","Set new random color").tooltip(),p=n("<div class='tooltip right' style='position: absolute;' />").appendTo(u).hide(),_=n("<div class='tooltip-inner' style='text-align: inherit'></div>").appendTo(p),m=(n("<div class='tooltip-arrow'></div>").appendTo(p),n.farbtastic(_,{width:100,height:100,callback:h,color:s}));u.append(n("<div/>").css("clear","both")),function(t){f.click(function(){t.setColor(l.default.get_random_color())})}(m)}else d.append(n("<input />").attr("id",a).attr("name",a).val(s));e.help&&d.append(n("<div class='help'/>").text(e.help))}}),this},render_in_modal:function(t){var e=this,i=function(){Galaxy.modal.hide(),n(window).unbind("keypress.check_enter_esc")},a=function(){Galaxy.modal.hide(),n(window).unbind("keypress.check_enter_esc"),e.update_from_form()},r=function(t){27===(t.keyCode||t.which)?i():13===(t.keyCode||t.which)&&a()};n(window).bind("keypress.check_enter_esc",r),0===this.$el.children().length&&this.render(),Galaxy.modal.show({title:t||"Configure",body:this.$el,buttons:{Cancel:i,OK:a}})},update_from_form:function(){var t=this;this.collection.each(function(e,i){if(!e.get("hidden")){var n="param_"+i,a=t.$el.find("#"+n).val();"bool"===e.get("type")&&(a=t.$el.find("#"+n).is(":checked")),e.set_value(a)}})}});e.default={ConfigSetting:c,ConfigSettingCollection:u,ConfigSettingCollectionView:h}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=r(o),l=i(12),d=r(l),c=t.View.extend({initialize:function(e){var i=this;this.data=[],this.data2=[],this.model=e&&e.model||new t.Model({id:s.default.uid(),cls:"ui-select",error_text:"No options available",empty_text:"Nothing selected",visible:!0,wait:!1,multiple:!1,searchable:!0,optional:!1,disabled:!1,readonly:!1,onchange:function(){},value:null,individual:!1,pagesize:20}).set(e),this.on("change",function(){i.model.get("onchange")&&i.model.get("onchange")(i.value())}),this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:disabled",this._changeDisabled,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:visible",this._changeVisible,this),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:multiple change:searchable change:cls change:id",this.render,this),this.render()},render:function(){var t=this;this.model.get("searchable")?this._renderSearchable():this._renderClassic(),this.$el.addClass(this.model.get("cls")).attr("id",this.model.get("id")),this.$select.empty().addClass("select").attr("id",this.model.get("id")+"_select").prop("multiple",this.model.get("multiple")).on("change",function(){t.value(t._getValue()),t.trigger("change")}),this._changeData(),this._changeWait(),this._changeVisible(),this._changeDisabled()},_renderClassic:function(){var t=this;this.$el.addClass(this.model.get("multiple")?"ui-select-multiple":"ui-select").append(this.$select=n("<select/>")).append(this.$dropdown=n("<div/>")).append(this.$resize=n("<div/>").append(this.$resize_icon=n("<i/>"))),this.model.get("multiple")?(this.$dropdown.hide(),this.$resize_icon.addClass("fa fa-angle-double-right fa-rotate-45").show(),this.$resize.removeClass().addClass("icon-resize").show().off("mousedown").on("mousedown",function(e){var i=e.pageY,a=t.$select.height();t.minHeight=t.minHeight||a,n("#dd-helper").show().on("mousemove",function(e){t.$select.height(Math.max(a+(e.pageY-i),t.minHeight))}).on("mouseup mouseleave",function(){n("#dd-helper").hide().off()})})):(this.$dropdown.show(),this.$resize.hide(),this.$resize_icon.hide())},_renderSearchable:function(){var t=this;this.$el.append(this.$select=n("<div/>")).append(this.$dropdown=n("<div/>")),this.$dropdown.hide(),this.model.get("multiple")||this.$dropdown.show().on("click",function(){t.$select.select2&&t.$select.select2("open")}),this.all_button=null,!this.model.get("multiple")||this.model.get("individual")||this.model.get("readonly")||(this.all_button=new d.default.ButtonCheck({onclick:function(){var e=[];0!==t.all_button.value()&&a.each(t.model.get("data"),function(t){e.push(t.value)}),t.value(e),t.trigger("change")}}),this.$el.prepend(this.all_button.$el))},_match:function(t,e){return!t||""==t||String(e).toUpperCase().indexOf(t.toUpperCase())>=0},_changeData:function(){var t=this;this.data=[],!this.model.get("multiple")&&this.model.get("optional")&&this.data.push({value:"__null__",label:t.model.get("empty_text")}),a.each(this.model.get("data"),function(e){t.data.push(e)}),0==this.length()&&this.data.push({value:"__null__",label:this.model.get("error_text")}),this.model.get("searchable")?(this.data2=[],a.each(this.data,function(e,i){t.data2.push({order:i,id:e.value,text:e.label,tags:e.tags})}),this.$select.data("select2")&&this.$select.select2("destroy"),this.matched_tags={},this.$select.select2({data:t.data2,closeOnSelect:!this.model.get("multiple"),multiple:this.model.get("multiple"),query:function(e){t.matched_tags={};var i=t.model.get("pagesize"),n=a.filter(t.data2,function(i){var n=!1;return a.each(i.tags,function(i){t._match(e.term,i)&&(n=t.matched_tags[i]=!0)}),n||t._match(e.term,i.text)});e.callback({results:n.slice((e.page-1)*i,e.page*i),more:n.length>=e.page*i})},formatResult:function(e){return a.escape(e.text)+'<div class="ui-tags">'+a.reduce(e.tags,function(e,i){return t.matched_tags[i]?e+'&nbsp;<div class="label label-info">'+a.escape(i)+"</div>":e},"")+"</div>"}}),this.$(".select2-container .select2-search input").off("blur")):(this.$select.find("option").remove(),a.each(this.data,function(e){t.$select.append(n("<option/>").attr("value",e.value).html(a.escape(e.label)))})),this.model.set("disabled",this.model.get("readonly")||0==this.length()),this._changeValue()},_changeDisabled:function(){this.model.get("searchable")?this.$select.select2(this.model.get("disabled")?"disable":"enable"):this.$select.prop("disabled",this.model.get("disabled"))},_changeWait:function(){this.$dropdown.removeClass().addClass("icon-dropdown fa").addClass(this.model.get("wait")?"fa-spinner fa-spin":"fa-caret-down")},_changeVisible:function(){this.$el[this.model.get("visible")?"show":"hide"](),this.$select[this.model.get("visible")?"show":"hide"]()},_changeValue:function(){if(this._setValue(this.model.get("value")),this.model.get("multiple")){if(this.all_button){var t=this._getValue();this.all_button.value(n.isArray(t)?t.length:0,this.length())}}else null!==this._getValue()||this.model.get("optional")||this._setValue(this.first())},value:function(t){return void 0!==t&&this.model.set("value",t),this._getValue()},first:function(){return this.data.length>0?this.data[0].value:null},exists:function(t){return a.findWhere(this.data,{value:t})},text:function(){var t=this._getValue(),e=this.exists(n.isArray(t)?t[0]:t);return e?e.label:""},show:function(){this.model.set("visible",!0)},hide:function(){this.model.set("visible",!1)},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},disabled:function(){return this.model.get("disabled")},enable:function(){this.model.set("disabled",!1)},disable:function(){this.model.set("disabled",!0)},add:function(t,e){a.each(this.model.get("data"),function(e){e.keep&&!a.findWhere(t,{value:e.value})&&t.push(e)}),e&&t&&t.sort(e),this.model.set("data",t)},update:function(t){this.model.set("data",t)},setOnChange:function(t){this.model.set("onchange",t)},length:function(){return n.isArray(this.model.get("data"))?this.model.get("data").length:0},_setValue:function(t){var e=this;if(null!==t&&void 0!==t||(t="__null__"),this.model.get("multiple")?t=n.isArray(t)?t:[t]:n.isArray(t)&&(t=t.length>0?t[0]:"__null__"),this.model.get("searchable")){if(n.isArray(t)){var i=[];a.each(t,function(t){var n=a.findWhere(e.data2,{id:t});n&&i.push(n)}),t=i}else{t=a.findWhere(this.data2,{id:t})}this.$select.select2("data",t)}else this.$select.val(t)},_getValue:function(){var t=null;if(this.model.get("searchable")){var e=this.$select.select2("data");e&&(n.isArray(e)?(t=[],e.sort(function(t,e){return t.order-e.order}),a.each(e,function(e){t.push(e.id)})):t=e.id)}else t=this.$select.val();return s.default.isEmpty(t)?null:t}});e.default={View:c}}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=r(o),l=i(12),d=r(l),c=t.View.extend({initialize:function(e){var i=this;this.model=e&&e.model||new t.Model({visible:!0,data:[],id:s.default.uid(),error_text:"No options available.",wait_text:"Please wait...",multiple:!1,optional:!1,onchange:function(){}}).set(e),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:visible",this._changeVisible,this),this.on("change",function(){i.model.get("onchange")(i.value())}),this.render()},render:function(){var t=this;this.$el.empty().removeClass().addClass("ui-options").append(this.$message=n("<div/>")).append(this.$menu=n("<div/>").addClass("ui-options-menu")).append(this.$options=n(this._template())),this.all_button=null,this.model.get("multiple")&&(this.all_button=new d.default.ButtonCheck({onclick:function(){t.$("input").prop("checked",0!==t.all_button.value()),t.value(t._getValue()),t.trigger("change")}}),this.$menu.append(this.all_button.$el)),this._changeData(),this._changeWait(),this._changeVisible()},update:function(t){this.model.set("data",t)},_changeData:function(){var t=this;this.$options.empty(),this._templateOptions?this.$options.append(this._templateOptions(this.model.get("data"))):a.each(this.model.get("data"),function(e){t.$options.append(n(t._templateOption(e)).addClass("ui-option").tooltip({title:e.tooltip,placement:"bottom"}))});var t=this;this.$("input").on("change",function(){t.value(t._getValue()),t.trigger("change")}),this._changeValue(),this._changeWait()},_changeVisible:function(){this.$el[this.model.get("visible")?"show":"hide"]()},_changeWait:function(){this.model.get("wait")?0===this.length()&&(this._messageShow(this.model.get("wait_text"),"info"),this.$options.hide(),this.$menu.hide()):0===this.length()?(this._messageShow(this.model.get("error_text"),"danger"),this.$options.hide(),this.$menu.hide()):(this.$message.hide(),this.$options.css("display","inline-block"),this.$menu.show())},_changeValue:function(){this._setValue(this.model.get("value")),null!==this._getValue()||this.model.get("multiple")||this.model.get("optional")||this._setValue(this.first()),this.all_button&&this.all_button.value(n.isArray(this._getValue())?this._getValue().length:0,this.length())},value:function(t){return void 0!==t&&this.model.set("value",t),this._getValue()},first:function(){var t=this.$("input").first();return t.length>0?t.val():null},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},length:function(){return this.$(".ui-option").length},_setValue:function(t){var e=this;if(void 0!==t&&(this.$("input").prop("checked",!1),null!==t)){var i=n.isArray(t)?t:[t];a.each(i,function(t){e.$('input[value="'+t+'"]').first().prop("checked",!0)})}},_getValue:function(){var t=[];return this.$(":checked").each(function(){t.push(n(this).val())}),s.default.isEmpty(t)?null:this.model.get("multiple")?t:t[0]},_messageShow:function(t,e){this.$message.show().removeClass().addClass("ui-message alert alert-"+e).html(t)},_template:function(){return n("<div/>").addClass("ui-options-list")}}),u=c.extend({_templateOption:function(t){var e=s.default.uid();return n("<div/>").addClass("ui-option").append(n("<input/>").attr({id:e,type:this.model.get("type"),name:this.model.id,value:t.value})).append(n("<label/>").addClass("ui-options-label").attr("for",e).html(t.label))}}),h={};h.View=u.extend({initialize:function(t){t.type="radio",u.prototype.initialize.call(this,t)}});var f={};f.View=u.extend({initialize:function(t){t.type="checkbox",t.multiple=!0,u.prototype.initialize.call(this,t)}});var p={};p.View=c.extend({initialize:function(t){c.prototype.initialize.call(this,t)},_setValue:function(t){void 0!==t&&(this.$("input").prop("checked",!1),this.$("label").removeClass("active"),this.$('[value="'+t+'"]').prop("checked",!0).closest("label").addClass("active"))},_templateOption:function(t){var e=n("<label/>").addClass("btn btn-default");return t.icon&&e.append(n("<i/>").addClass("fa").addClass(t.icon).addClass(!t.label&&"no-padding")),e.append(n("<input/>").attr({type:"radio",name:this.model.id,value:t.value})),t.label&&e.append(t.label),e},_template:function(){return n("<div/>").addClass("btn-group ui-radiobutton").attr("data-toggle","buttons")}}),e.default={Base:c,BaseIcons:u,Radio:h,RadioButton:p,Checkbox:f}}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=a(r),s=i(11),l=a(s),d=i(4),c=a(d),u=t.View.extend({initialize:function(t){var e=this;this.options=t,this.name=t.name||"element",this.multiple=t.multiple||!1,this.message=new c.default.Message,this.portlet=new l.default.View({cls:"ui-portlet-section"}),this.select=new c.default.Select.View({optional:t.optional}),this.button=new c.default.ButtonIcon({icon:"fa fa-sign-in",tooltip:"Insert new "+this.name,onclick:function(){e.add({id:e.select.value(),name:e.select.text()})}}),this.setElement(this._template(t)),this.$(".ui-list-message").append(this.message.$el),this.$(".ui-list-portlet").append(this.portlet.$el),this.$(".ui-list-button").append(this.button.$el),this.$(".ui-list-select").append(this.select.$el)},value:function(t){if(void 0!==t){if(this.portlet.empty(),n.isArray(t))for(var e in t){var i=t[e],a=null,r=null;"string"!=n.type(i)?(a=i.id,r=i.name):a=r=i,null!=a&&this.add({id:a,name:r})}this._refresh()}var o=[];return this.$(".ui-list-id").each(function(){o.push({id:n(this).prop("id"),name:n(this).find(".ui-list-name").html()})}),0==o.length?null:o},add:function(t){var e=this;if(0===this.$('[id="'+t.id+'"]').length)if(o.default.isEmpty(t.id))this.message.update({message:"Please select a valid "+this.name+".",status:"danger"});else{var i=n(this._templateRow({id:t.id,name:t.name}));i.on("click",function(){i.remove(),e._refresh()}),i.on("mouseover",function(){i.addClass("portlet-highlight")}),i.on("mouseout",function(){i.removeClass("portlet-highlight")}),this.portlet.append(i),this._refresh()}else this.message.update({message:"This "+this.name+" is already in the list."})},update:function(t){this.select.update(t)},_refresh:function(){this.$(".ui-list-id").length>0?(!this.multiple&&this.button.disable(),this.$(".ui-list-portlet").show()):(this.button.enable(),this.$(".ui-list-portlet").hide()),this.options.onchange&&this.options.onchange()},_template:function(t){return'<div class="ui-list"><div class="ui-margin-top"><span class="ui-list-button"/><span class="ui-list-select"/></div><div class="ui-list-message"/><div class="ui-list-portlet"/></div>'},_templateRow:function(t){return'<div id="'+t.id+'" class="ui-list-id"><span class="ui-list-delete fa fa-trash"/><span class="ui-list-name">'+t.name+"</span></div>"}});e.default={View:u}}).call(e,i(1),i(0))},function(t,e,i){"use strict";var n=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n),r=a.default;r.fn.make_text_editable=function(t){var e="num_cols"in t?t.num_cols:30,i="num_rows"in t?t.num_rows:4,n="use_textarea"in t&&t.use_textarea,a="on_finish"in t?t.on_finish:null,o="help_text"in t?t.help_text:null,s=r(this);return s.addClass("editable-text").click(function(o){if(!(r(this).children(":input").length>0)){s.removeClass("editable-text");var l,d,c=function(t){s.find(":input").remove(),""!==t?s.text(t):s.html("<br>"),s.addClass("editable-text"),a&&a(t)},u="cur_text"in t?t.cur_text:s.text();n?(l=r("<textarea/>").attr({rows:i,cols:e}).text(r.trim(u)).keyup(function(t){27===t.keyCode&&c(u)}),d=r("<button/>").text("Done").click(function(){return c(l.val()),!1})):l=r("<input type='text'/>").attr({value:r.trim(u),size:e}).blur(function(){c(u)}).keyup(function(t){27===t.keyCode?r(this).trigger("blur"):13===t.keyCode&&c(r(this).val()),t.stopPropagation()}),s.text(""),s.append(l),d&&s.append(d),l.focus(),l.select(),o.stopPropagation()}}),o&&s.attr("title",o).tooltip(),s}},function(t,e,i){"use strict";(function(t,n,a,r){function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(3),l=o(s),d=i(143),c=o(d),u=i(144),h=o(u),f=i(67),p=o(f);t.ajaxSettings.traditional=!0,e.default=n.View.extend({grid:null,initialize:function(t){this.grid=new c.default,this.dict_format=t.dict_format,this.title=t.title;var e=this;if(window.add_tag_to_grid_filter=function(t,i){var n=t+(void 0!==i&&""!==i?":"+i:"");a("#advanced-search").is(":visible")||(a("#standard-search").slideToggle("fast"),a("#advanced-search").slideToggle("fast")),e.add_filter_condition("tags",n)},this.dict_format)if(this.setElement("<div/>"),t.url_base&&!t.items){var i=t.url_data||{};r.each(t.filters,function(t,e){i["f-"+e]=t}),a.ajax({url:t.url_base+"?"+a.param(i),success:function(i){i.embedded=t.embedded,i.filters=t.filters||{},e.init_grid(i)}})}else this.init_grid(t);else this.setElement("#grid-container"),this.init_grid(t);t.use_panels&&a("#center").css({padding:"10px",overflow:"auto"})},handle_refresh:function(t){t&&a.inArray("history",t)>-1&&window.top.Galaxy&&window.top.Galaxy.currHistoryPanel&&window.top.Galaxy.currHistoryPanel.loadCurrentHistory()},init_grid:function(t){this.grid.set(t);var e=this.grid.attributes;this.allow_title_display&&e.title&&l.default.setWindowTitle(e.title),this.handle_refresh(e.refresh_frames);var i=this.grid.get("url_base");if(i=i.replace(/^.*\/\/[^\/]+/,""),this.grid.set("url_base",i),this.$el.html(h.default.grid(e)),this.$el.find("#grid-table-header").html(h.default.header(e)),this.$el.find("#grid-table-body").html(h.default.body(e)),this.$el.find("#grid-table-footer").html(h.default.footer(e)),e.message){this.$el.find("#grid-message").html(h.default.message(e));var n=this;e.use_hide_message&&setTimeout(function(){n.$el.find("#grid-message").html("")},5e3)}this.init_grid_elements(),this.init_grid_controls(),init_refresh_on_change()},init_grid_controls:function(){var t=this;this.$el.find(".operation-button").each(function(){a(this).off(),a(this).click(function(){return t.submit_operation(this),!1})}),this.$el.find("input[type=text]").each(function(){a(this).off(),a(this).click(function(){a(this).select()}).keyup(function(){a(this).css("font-style","normal")})}),this.$el.find(".sort-link").each(function(){a(this).off(),a(this).click(function(){return t.set_sort_condition(a(this).attr("sort_key")),!1})}),this.$el.find(".text-filter-form").each(function(){a(this).off(),a(this).submit(function(){var e=a(this).attr("column_key"),i=a("#input-"+e+"-filter"),n=i.val();return i.val(""),t.add_filter_condition(e,n),!1})}),this.$el.find(".text-filter-val > a").each(function(){a(this).off(),a(this).click(function(){return a(this).parent().remove(),t.remove_filter_condition(a(this).attr("filter_key"),a(this).attr("filter_val")),!1})}),this.$el.find(".categorical-filter > a").each(function(){a(this).off(),a(this).click(function(){return t.set_categorical_filter(a(this).attr("filter_key"),a(this).attr("filter_val")),!1})}),this.$el.find(".advanced-search-toggle").each(function(){a(this).off(),a(this).click(function(){return t.$el.find("#standard-search").slideToggle("fast"),t.$el.find("#advanced-search").slideToggle("fast"),!1})}),this.$el.find("#check_all").off(),this.$el.find("#check_all").on("click",function(){t.check_all_items()})},init_grid_elements:function(){this.$el.find(".grid").each(function(){var t=a(this).find("input.grid-row-select-checkbox"),e=a(this).find("span.grid-selected-count"),i=function(){e.text(a(t).filter(":checked").length)};a(t).each(function(){a(this).change(i)}),i()}),0!==this.$el.find(".community_rating_star").length&&this.$el.find(".community_rating_star").rating({});var t=this.grid.attributes,e=this;this.$el.find(".page-link > a").each(function(){a(this).click(function(){return e.set_page(a(this).attr("page_num")),!1})}),this.$el.find(".use-target").each(function(){a(this).click(function(t){return e.execute({href:a(this).attr("href"),target:a(this).attr("target")}),!1})}),0!=t.items.length&&r.each(t.items,function(i,n){var a=e.$("#grid-"+n+"-popup").off(),o=new p.default(a);r.each(t.operations,function(t){e._add_operation(o,t,i)})})},_add_operation:function(t,e,i){var n=this,r=i.operation_config[e.label];r.allowed&&e.allow_popup&&t.addItem({html:e.label,href:r.url_args,target:r.target,confirmation_text:e.confirm,func:function(t){t.preventDefault();var r=a(t.target).html();e.onclick?e.onclick(i.encode_id):n.execute(this.findItemByHtml(r))}})},add_filter_condition:function(t,e){if(""===e)return!1;this.grid.add_filter(t,e,!0);var i=a(h.default.filter_element(t,e)),n=this;i.click(function(){a(this).remove(),n.remove_filter_condition(t,e)}),this.$el.find("#"+t+"-filtering-criteria").append(i),this.go_page_one(),this.execute()},remove_filter_condition:function(t,e){this.grid.remove_filter(t,e),this.go_page_one(),this.execute()},set_sort_condition:function(t){var e=this.grid.get("sort_key"),i=t;-1!==e.indexOf(t)&&"-"!==e.substring(0,1)&&(i="-"+t),this.$el.find(".sort-arrow").remove();var n="-"==i.substring(0,1)?"&uarr;":"&darr;",r=a("<span>"+n+"</span>").addClass("sort-arrow");this.$el.find("#"+t+"-header").append(r),this.grid.set("sort_key",i),this.go_page_one(),this.execute()},set_categorical_filter:function(t,e){var i=this.grid.get("categorical_filters")[t],n=this.grid.get("filters")[t],r=this;this.$el.find("."+t+"-filter").each(function(){var o=a.trim(a(this).text()),s=i[o],l=s[t];if(l==e)a(this).empty(),a(this).addClass("current-filter"),a(this).append(o);else if(l==n){a(this).empty();var d=a('<a href="#">'+o+"</a>");d.click(function(){r.set_categorical_filter(t,l)}),a(this).removeClass("current-filter"),a(this).append(d)}}),this.grid.add_filter(t,e),this.go_page_one(),this.execute()},set_page:function(t){var e=this;this.$el.find(".page-link").each(function(){var i,n=a(this).attr("id"),r=parseInt(n.split("-")[2],10),o=e.grid.get("cur_page");if(r===t)i=a(this).children().text(),a(this).empty(),a(this).addClass("inactive-link"),a(this).text(i);else if(r===o){i=a(this).text(),a(this).empty(),a(this).removeClass("inactive-link");var s=a('<a href="#">'+i+"</a>");s.click(function(){e.set_page(r)}),a(this).append(s)}}),"all"===t?this.grid.set("cur_page",t):this.grid.set("cur_page",parseInt(t,10)),this.execute()},submit_operation:function(t,e){var i=a(t).val();if(!this.$el.find('input[name="id"]:checked').length>0)return!1;var n=r.findWhere(this.grid.attributes.operations,{label:i});n&&!e&&(e=n.confirm||"");var o=[];this.$el.find("input[name=id]:checked").each(function(){o.push(a(this).val())});var s={operation:i,id:o,confirmation_text:e};return"top"!=n.target&&"center"!=n.target||(s=r.extend(s,{href:n.href,target:n.target})),this.execute(s),!0},check_all_items:function(){var t=this.$(".grid-row-select-checkbox"),e=this.$("#check_all").prop("checked");r.each(t,function(t){a(t).prop("checked",e)}),this.init_grid_elements()},go_page_one:function(){var t=this.grid.get("cur_page");null!==t&&void 0!==t&&"all"!==t&&this.grid.set("cur_page",1)},execute:function(t){var e=null,i=null,n=null,r=null,o=null;if(t&&(i=t.href,n=t.operation,e=t.id,r=t.confirmation_text,o=t.target,void 0!==i&&-1!=i.indexOf("operation="))){var s=i.split("?");if(s.length>1)for(var l=s[1],d=l.split("&"),c=0;c<d.length;c++)-1!=d[c].indexOf("operation")?(n=d[c].split("=")[1],n=n.replace(/\+/g," ")):-1!=d[c].indexOf("id")&&(e=d[c].split("=")[1])}return n&&e?!(r&&""!=r&&"None"!=r&&"null"!=r&&!confirm(r))&&(n=n.toLowerCase(),this.grid.set({operation:n,item_ids:e}),"top"==o?window.top.location=i+"?"+a.param(this.grid.get_url_data()):"center"==o?a("#galaxy_main").attr("src",i+"?"+a.param(this.grid.get_url_data())):this.grid.can_async_op(n)||this.dict_format?this.update_grid():this.go_to(o,i),!1):i?(this.go_to(o,i),!1):(this.grid.get("async")||this.dict_format?this.update_grid():this.go_to(o,i),!1)},go_to:function(t,e){var i=this.grid.get("async");this.grid.set("async",!1);var n=this.$el.find("#advanced-search").is(":visible");switch(this.grid.set("advanced_search",n),e||(e=this.grid.get("url_base")+"?"+a.param(this.grid.get_url_data())),this.grid.set({operation:void 0,item_ids:void 0,async:i}),t){case"center":a("#galaxy_main").attr("src",e);break;case"top":window.top.location=e;break;default:window.location=e}},update_grid:function(){var t=this.grid.get("operation")?"POST":"GET";this.$el.find(".loading-elt-overlay").show();var e=this;a.ajax({type:t,url:e.grid.get("url_base"),data:e.grid.get_url_data(),error:function(t){alert("Grid refresh failed")},success:function(t){var i=e.grid.get("embedded"),n=e.grid.get("insert"),r=e.$el.find("#advanced-search").is(":visible"),o=e.dict_format?t:a.parseJSON(t);o.embedded=i,o.insert=n,o.advanced_search=r,e.init_grid(o),e.$el.find(".loading-elt-overlay").hide()},complete:function(){e.grid.set({operation:void 0,item_ids:void 0})}})}})}).call(e,i(0),i(1),i(0),i(2))},function(t,e,i){"use strict";t.exports=function(t,e){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return t.apply(e,i)}}},function(t,e,i){"use strict";var n=i(5),a=i(78),r=i(80),o=i(81),s=i(82),l=i(29),d="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||i(83);t.exports=function(t){return new Promise(function(e,c){var u=t.data,h=t.headers;n.isFormData(u)&&delete h["Content-Type"];var f=new XMLHttpRequest,p="onreadystatechange",_=!1;if(window.XMLHttpRequest||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in f||s(t.url)||(f=new window.XDomainRequest,p="onload",_=!0,f.onprogress=function(){},f.ontimeout=function(){}),t.auth){var m=t.auth.username||"",g=t.auth.password||"";h.Authorization="Basic "+d(m+":"+g)}if(f.open(t.method.toUpperCase(),r(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f[p]=function(){if(f&&(4===f.readyState||_)&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in f?o(f.getAllResponseHeaders()):null,n=t.responseType&&"text"!==t.responseType?f.response:f.responseText,r={data:n,status:1223===f.status?204:f.status,statusText:1223===f.status?"No Content":f.statusText,headers:i,config:t,request:f};a(e,c,r),f=null}},f.onerror=function(){c(l("Network Error",t,null,f)),f=null},f.ontimeout=function(){c(l("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var v=i(84),b=(t.withCredentials||s(t.url))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;b&&(h[t.xsrfHeaderName]=b)}if("setRequestHeader"in f&&n.forEach(h,function(t,e){void 0===u&&"content-type"===e.toLowerCase()?delete h[e]:f.setRequestHeader(e,t)}),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){f&&(f.abort(),c(t),f=null)}),void 0===u&&(u=null),f.send(u)})}},function(t,e,i){"use strict";var n=i(79);t.exports=function(t,e,i,a,r){var o=new Error(t);return n(o,e,i,a,r)}},function(t,e,i){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,i){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.supportedMarkups={ascii:!0,unicode:!0,html:!0}},function(t,e,i){"use strict";function n(t){return a(e.defaultCategories,t)}function a(t,e){for(var i=[],n=0;n<e.length;n++){var a=e.charAt(n);i.push({string:a,category:t(a)})}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.defaultCategories=function(t){switch(t){case"\\":return 0;case"{":return 1;case"}":return 2;case"$":return 3;case"&":return 4;case"\r":return 5;case"#":return 6;case"^":return 7;case"_":return 8;case"\0":return 9;case" ":return 10;case"~":return 13;case"%":return 14;case"d":return 15;default:return 11}},e.convertToTeXCharsDefault=n,e.convertToTeXChars=a},function(t,e,i){!function(e,i){t.exports=i()}(0,function(){return function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this._=t}function a(t){return t instanceof n}function r(t){return"[object Array]"==={}.toString.call(t)}function o(t,e){return{status:!0,index:t,value:e,furthest:-1,expected:[]}}function s(t,e){return{status:!1,index:-1,value:null,furthest:t,expected:[e]}}function l(t,e){if(!e)return t;if(t.furthest>e.furthest)return t;var i=t.furthest===e.furthest?c(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:i}}function d(t,e){var i=t.slice(0,e).split("\n");return{offset:e,line:i.length,column:i[i.length-1].length+1}}function c(t,e){var i=t.length,n=e.length;if(0===i)return e;if(0===n)return t;for(var a={},r=0;r<i;r++)a[t[r]]=!0;for(var o=0;o<n;o++)a[e[o]]=!0;var s=[];for(var l in a)a.hasOwnProperty(l)&&s.push(l);return s.sort(),s}function u(t){if(!a(t))throw new Error("not a parser: "+t)}function h(t){if(!r(t))throw new Error("not an array: "+t)}function f(t){if("number"!=typeof t)throw new Error("not a number: "+t)}function p(t){if(!(t instanceof RegExp))throw new Error("not a regexp: "+t);for(var e=w(t),i=0;i<e.length;i++){var n=e.charAt(i);if("i"!==n&&"m"!==n&&"u"!==n)throw new Error('unsupported regexp flag "'+n+'": '+t)}}function _(t){if("function"!=typeof t)throw new Error("not a function: "+t)}function m(t){if("string"!=typeof t)throw new Error("not a string: "+t)}function g(t){return 1===t.length?t[0]:"one of "+t.join(", ")}function v(t,e){var i=e.index,n=i.offset;if(n===t.length)return", got the end of the input";var a=n>0?"'...":"'",r=t.length-n>12?"...'":"'";return" at line "+i.line+" column "+i.column+", got "+a+t.slice(n,n+12)+r}function b(t,e){return"expected "+g(e.expected)+v(t,e)}function w(t){var e=""+t;return e.slice(e.lastIndexOf("/")+1)}function y(t){return RegExp("^(?:"+t.source+")",w(t))}function x(){for(var t=[].slice.call(arguments),e=t.length,i=0;i<e;i+=1)u(t[i]);return n(function(i,n){for(var a,r=new Array(e),s=0;s<e;s+=1){if(a=l(t[s]._(i,n),a),!a.status)return a;r[s]=a.value,n=a.index}return l(o(n,r),a)})}function k(){for(var t={},e=0,i=[].slice.call(arguments),s=i.length,d=0;d<s;d+=1){var c=i[d];if(!a(c)){if(r(c)&&2===c.length&&"string"==typeof c[0]&&a(c[1])){var u=c[0];if(t[u])throw new Error("seqObj: duplicate key "+u);t[u]=!0,e++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(0===e)throw new Error("seqObj expects at least one named parser, found zero");return n(function(t,e){for(var n,a={},d=0;d<s;d+=1){var c,u;if(r(i[d])?(c=i[d][0],u=i[d][1]):(c=null,u=i[d]),n=l(u._(t,e),n),!n.status)return n;c&&(a[c]=n.value),e=n.index}return l(o(e,a),n)})}function C(){var t=[].slice.call(arguments);if(0===t.length)throw new Error("seqMap needs at least one argument");var e=t.pop();return _(e),x.apply(null,t).map(function(t){return e.apply(null,t)})}function S(t){var e={};for(var i in t)({}).hasOwnProperty.call(t,i)&&function(i){var n=function(){return t[i](e)};e[i]=B(n)}(i);return e}function $(){var t=[].slice.call(arguments),e=t.length;if(0===e)return z("zero alternates");for(var i=0;i<e;i+=1)u(t[i]);return n(function(e,i){for(var n,a=0;a<t.length;a+=1)if(n=l(t[a]._(e,i),n),n.status)return n;return n})}function T(t,e){return M(t,e).or(E([]))}function M(t,e){u(t),u(e);var i=e.then(t).many();return t.chain(function(t){return i.map(function(e){return[t].concat(e)})})}function O(t){m(t);var e="'"+t+"'";return n(function(i,n){var a=n+t.length,r=i.slice(n,a);return r===t?o(a,r):s(n,e)})}function A(t,e){p(t),arguments.length>=2?f(e):e=0;var i=y(t),a=""+t;return n(function(t,n){var r=i.exec(t.slice(n));if(r){if(0<=e&&e<=r.length){var l=r[0],d=r[e];return o(n+l.length,d)}return s(n,"valid match group (0 to "+r.length+") in "+a)}return s(n,a)})}function E(t){return n(function(e,i){return o(i,t)})}function z(t){return n(function(e,i){return s(i,t)})}function R(t){if(a(t))return n(function(e,i){var n=t._(e,i);return n.index=i,n.value="",n});if("string"==typeof t)return R(O(t));if(t instanceof RegExp)return R(A(t));throw new Error("not a string, regexp, or parser: "+t)}function P(t){return u(t),n(function(e,i){var n=t._(e,i),a=e.slice(i,n.index);return n.status?s(i,'not "'+a+'"'):o(i,null)})}function j(t){return _(t),n(function(e,i){var n=e.charAt(i);return i<e.length&&t(n)?o(i+1,n):s(i,"a character matching "+t)})}function q(t){return j(function(e){return t.indexOf(e)>=0})}function D(t){return j(function(e){return t.indexOf(e)<0})}function I(t){return n(t(o,s))}function L(t,e){return j(function(i){return t<=i&&i<=e}).desc(t+"-"+e)}function N(t){return _(t),n(function(e,i){for(var n=i;n<e.length&&t(e.charAt(n));)n++;return o(n,e.slice(i,n))})}function B(t,e){arguments.length<2&&(e=t,t=void 0);var i=n(function(t,n){return i._=e()._,i._(t,n)});return t?i.desc(t):i}function V(){return z("fantasy-land/empty")}var G=n.prototype;G.parse=function(t){if("string"!=typeof t)throw new Error(".parse must be called with a string as its argument");var e=this.skip(Y)._(t,0);return e.status?{status:!0,value:e.value}:{status:!1,index:d(t,e.furthest),expected:e.expected}},G.tryParse=function(t){var e=this.parse(t);if(e.status)return e.value;var i=b(t,e),n=new Error(i);throw n.type="ParsimmonError",n.result=e,n},G.or=function(t){return $(this,t)},G.trim=function(t){return this.wrap(t,t)},G.wrap=function(t,e){return C(t,this,e,function(t,e){return e})},G.thru=function(t){return t(this)},G.then=function(t){return u(t),x(this,t).map(function(t){return t[1]})},G.many=function(){var t=this;return n(function(e,i){for(var n=[],a=void 0;;){if(a=l(t._(e,i),a),!a.status)return l(o(i,n),a);i=a.index,n.push(a.value)}})},G.tie=function(){return this.map(function(t){h(t);for(var e="",i=0;i<t.length;i++)m(t[i]),e+=t[i];return e})},G.times=function(t,e){var i=this;return arguments.length<2&&(e=t),f(t),f(e),n(function(n,a){for(var r=[],s=void 0,d=void 0,c=0;c<t;c+=1){if(s=i._(n,a),d=l(s,d),!s.status)return d;a=s.index,r.push(s.value)}for(;c<e&&(s=i._(n,a),d=l(s,d),s.status);c+=1)a=s.index,r.push(s.value);return l(o(a,r),d)})},G.result=function(t){return this.map(function(){return t})},G.atMost=function(t){return this.times(0,t)},G.atLeast=function(t){return C(this.times(t),this.many(),function(t,e){return t.concat(e)})},G.map=function(t){_(t);var e=this;return n(function(i,n){var a=e._(i,n);return a.status?l(o(a.index,t(a.value)),a):a})},G.skip=function(t){return x(this,t).map(function(t){return t[0]})},G.mark=function(){return C(U,this,U,function(t,e,i){return{start:t,value:e,end:i}})},G.node=function(t){return C(U,this,U,function(e,i,n){return{name:t,value:i,start:e,end:n}})},G.sepBy=function(t){return T(this,t)},G.sepBy1=function(t){return M(this,t)},G.lookahead=function(t){return this.skip(R(t))},G.notFollowedBy=function(t){return this.skip(P(t))},G.desc=function(t){var e=this;return n(function(i,n){var a=e._(i,n);return a.status||(a.expected=[t]),a})},G.fallback=function(t){return this.or(E(t))},G.ap=function(t){return C(t,this,function(t,e){return t(e)})},G.chain=function(t){var e=this;return n(function(i,n){var a=e._(i,n);return a.status?l(t(a.value)._(i,a.index),a):a})},G.concat=G.or,G.empty=V,G.of=E,G["fantasy-land/ap"]=G.ap,G["fantasy-land/chain"]=G.chain,G["fantasy-land/concat"]=G.concat,G["fantasy-land/empty"]=G.empty,G["fantasy-land/of"]=G.of,G["fantasy-land/map"]=G.map;var U=n(function(t,e){return o(e,d(t,e))}),F=n(function(t,e){return e>=t.length?s(e,"any character"):o(e+1,t.charAt(e))}),H=n(function(t,e){return o(t.length,t.slice(e))}),Y=n(function(t,e){return e<t.length?s(e,"EOF"):o(e,null)}),X=A(/[0-9]/).desc("a digit"),J=A(/[0-9]*/).desc("optional digits"),W=A(/[a-z]/i).desc("a letter"),K=A(/[a-z]*/i).desc("optional letters"),Z=A(/\s*/).desc("optional whitespace"),Q=A(/\s+/).desc("whitespace");n.all=H,n.alt=$,n.any=F,n.createLanguage=S,n.custom=I,n.digit=X,n.digits=J,n.empty=V,n.eof=Y,n.fail=z,n.formatError=b,n.index=U,n.isParser=a,n.lazy=B,n.letter=W,n.letters=K,n.lookahead=R,n.makeFailure=s,n.makeSuccess=o,n.noneOf=D,n.notFollowedBy=P,n.of=E,n.oneOf=q,n.optWhitespace=Z,n.Parser=n,n.range=L,n.regex=A,n.regexp=A,n.sepBy=T,n.sepBy1=M,n.seq=x,n.seqMap=C,n.seqObj=k,n.string=O,n.succeed=E,n.takeWhile=N,n.test=j,n.whitespace=Q,n["fantasy-land/empty"]=V,n["fantasy-land/of"]=E,t.exports=n}])})},function(t,e,i){"use strict";function n(t){return new Error("I do not know command "+t)}Object.defineProperty(e,"__esModule",{value:!0}),e.unknownCommandError=n},function(t,e,i){"use strict";function n(t,e,i,n){return{name:t,optionalArguments:e,argumentCount:i,apply:n}}function a(t,e,i){return{name:t,optionalArguments:e,argumentCount:i}}function r(t,e){return{name:t,optionalArguments:0,argumentCount:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.createCommandHandler=n,e.createKnownCommandWithOptArgs=a,e.createKnownCommandWithArgs=r},function(t,e,i){"use strict";function n(t){return"bb"===t||"mathbb"===t||"textbb"===t}function a(t){return"bf"===t||"mathbf"===t||"textbf"===t}function r(t){return"mono"===t}function o(t){return"frak"===t||"mathfrak"===t||"textfrak"===t}function s(t){return"it"===t||"mathit"===t||"textit"===t}function l(t){return"tt"===t||"mathtt"===t||"texttt"===t}function d(t){return"cal"===t||"mathcal"===t||"textcal"===t}function c(t){return"sup"===t||"mathsup"===t||"textsup"===t||"superscript"===t||"mathsuperscript"===t||"textsuperscript"===t}function u(t){return"sub"===t||"mathsub"===t||"textsub"===t||"subscript"===t||"mathsubscript"===t||"textsubscript"===t}function h(t){return e.formattingText.hasOwnProperty(t)||e.formattingMath.hasOwnProperty(t)||e.formattingNoMode.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.formattingText={textbb:!0,textbf:!0,textfrak:!0,textit:!0,texttt:!0,textcal:!0,textsup:!0,textsub:!0,textsuperscript:!0,textsubscript:!0},e.formattingNoMode={bb:!0,bf:!0,frak:!0,it:!0,tt:!0,cal:!0,mono:!0,sup:!0,sub:!0,superscript:!0,subscript:!0},e.formattingMath={mathbb:!0,mathbf:!0,mathfrak:!0,mathit:!0,mathtt:!0,mathcal:!0,mathsup:!0,mathsub:!0,mathsuperscript:!0,mathsubscript:!0},e.isBbCmd=n,e.isBfCmd=a,e.isMonoCmd=r,e.isFrakCmd=o,e.isItCmd=s,e.isTtCmd=l,e.isCalCmd=d,e.isSupCmd=c,e.isSubCmd=u,e.isFormattingCmd=h},function(t,e,i){"use strict";function n(t){return e.superscriptCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.superscriptCharacters={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","+":"⁺","-":"⁻","=":"⁼","(":"⁽",")":"⁾",a:"ᵃ",b:"ᵇ",c:"ᶜ",d:"ᵈ",e:"ᵉ",f:"ᶠ",g:"ᵍ",h:"ʰ",i:"ⁱ",j:"ʲ",k:"ᵏ",l:"ˡ",m:"ᵐ",n:"ⁿ",o:"ᵒ",p:"ᵖ",r:"ʳ",s:"ˢ",t:"ᵗ",u:"ᵘ",v:"ᵛ",w:"ʷ",x:"ˣ",y:"ʸ",z:"ᶻ",A:"ᴬ",B:"ᴮ",D:"ᴰ",E:"ᴱ",G:"ᴳ",H:"ᴴ",I:"ᴵ",J:"ᴶ",K:"ᴷ",L:"ᴸ",M:"ᴹ",N:"ᴺ",O:"ᴼ",P:"ᴾ",R:"ᴿ",T:"ᵀ",U:"ᵁ",V:"ⱽ",W:"ᵂ","α":"ᵅ","β":"ᵝ","γ":"ᵞ","δ":"ᵟ","∊":"ᵋ","θ":"ᶿ","ι":"ᶥ","Φ":"ᶲ","φ":"ᵠ","χ":"ᵡ"},e.isSuperscriptCharacter=n,e.translateCharToSuperscript=function(t){return n(t)?e.superscriptCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.oneArgsCommands.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(128),r=i(129),o=i(37);e.oneArgsCommands=Object.assign({},a.spaceCmds1arg,o.formattingText,o.formattingMath,o.formattingNoMode,r.diacriticsTextMode,r.diacriticsMathMode,{cyrchar:!0,vec:!0,mono:!0}),e.is1argsCommand=n},function(t,e,i){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0});var n=t.Model.extend({defaults:{activate:!1}}),a=t.Collection.extend({model:n}),r=t.View.extend({el:"#webhook-view",initialize:function(t){var e=this,i=t.toolId||"",a=t.toolVersion||"";this.$el.attr("tool_id",i),this.$el.attr("tool_version",a),this.model=new n,this.model.urlRoot=t.urlRoot,this.model.fetch({success:function(){e.render()}})},render:function(){var t=this.model.toJSON();return this.$el.html('<div id="'+t.name+'"></div>'),t.styles&&i("<style/>",{type:"text/css"}).text(t.styles).appendTo("head"),t.script&&i("<script/>",{type:"text/javascript"}).text(t.script).appendTo("head"),this}}),o=function(t){var e=new a;e.url=Galaxy.root+t.url,e.fetch({async:!t.async||t.async,success:t.callback})};e.default={Webhooks:a,WebhookView:r,add:o}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,i,n){Object.defineProperty(e,"__esModule",{value:!0});var a=t.Model.extend({defaults:{title:"",icon_class:"",on_click:null,menu_options:null,is_menu_button:!0,id:null,href:null,target:null,enabled:!0,visible:!0,tooltip_config:{}}}),r=t.View.extend({initialize:function(){this.model.attributes.tooltip_config={placement:"bottom"},this.model.bind("change",this.render,this)},render:function(){this.$el.tooltip("hide");var t=this.template(this.model.toJSON());return t.tooltip(this.model.get("tooltip_config")),this.$el.replaceWith(t),this.setElement(t),this},events:{click:"click"},click:function(t){return!i.isFunction(this.model.get("on_click"))||(this.model.get("on_click")(t),!1)},template:function(t){var e='title="'+t.title+'" class="icon-button';return t.is_menu_button&&(e+=" menu-button"),e+=" "+t.icon_class,t.enabled||(e+="_disabled"),e+='"',t.id&&(e+=' id="'+t.id+'"'),e+=' href="'+t.href+'"',t.target&&(e+=' target="'+t.target+'"'),t.visible||(e+=' style="display: none;"'),e=t.enabled?"<a "+e+"/>":"<span "+e+"/>",n(e)}}),o=t.Collection.extend({model:a}),s=t.View.extend({tagName:"div",initialize:function(){this.render()},render:function(){var t=this;return this.collection.each(function(e){var i=n("<a/>").attr("href","javascript:void(0)").attr("title",e.attributes.title).addClass("icon-button menu-button").addClass(e.attributes.icon_class).appendTo(t.$el).click(e.attributes.on_click);e.attributes.tooltip_config&&i.tooltip(e.attributes.tooltip_config);var a=e.get("options");a&&make_popupmenu(i,a)}),this}}),l=function(t,e){e||(e={});var n=new o(i.map(t,function(t){return new a(i.extend(t,e))}));return new s({collection:n})};e.default={IconButton:a,IconButtonView:r,IconButtonCollection:o,IconButtonMenuView:s,create_icon_buttons_menu:l}}).call(e,i(1),i(2),i(0))},,function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=function(t){return t&&t.__esModule?t:{default:t}}(a),o=t.View.extend({initialize:function(t){this.options=r.default.merge(t,{content:"No content available.",onchange:null,ondblclick:null,onconfirm:null,cls:"ui-table",selectable:!0,cls_tr:""}),this.setElement(this._template()),this.$thead=this.$("thead"),this.$tbody=this.$("tbody"),this.$tmessage=this.$("tmessage"),this.row=this._row(),this.row_count=0},events:{click:"_onclick",dblclick:"_ondblclick"},addHeader:function(t){this.row.append(n("<th/>").append(t))},appendHeader:function(){this.$thead.append(this.row),this.row=n("<tr/>")},add:function(t,e,i){var a=n("<td/>");e&&a.css("width",e),i&&a.css("text-align",i),this.row.append(a.append(t))},append:function(t,e){this._commit(t,e,!1)},prepend:function(t,e){this._commit(t,e,!0)},get:function(t){return this.$("#"+t)},del:function(t){var e=this.$tbody.find("#"+t);e.length>0&&(e.remove(),this.row_count--,this._refresh())},delAll:function(){this.$tbody.empty(),this.row_count=0,this._refresh()},value:function(t){if(this.options.selectable){this.before=this.$tbody.find(".current").attr("id"),void 0!==t&&(this.$tbody.find("tr").removeClass("current"),t&&this.$tbody.find("#"+t).addClass("current"));var e=this.$tbody.find(".current").attr("id");return void 0===e?null:(e!=this.before&&this.options.onchange&&this.options.onchange(t),e)}},size:function(){return this.$tbody.find("tr").length},_commit:function(t,e,i){this.del(t),this.row.attr("id",t),i?this.$tbody.prepend(this.row):this.$tbody.append(this.row),e&&(this.row.hide(),this.row.fadeIn()),this.row=this._row(),this.row_count++,this._refresh()},_row:function(){return n('<tr class="'+this.options.cls_tr+'"></tr>')},_onclick:function(t){var e=this.value(),i=n(t.target).closest("tr").attr("id");""!=i&&i&&e!=i&&(this.options.onconfirm?this.options.onconfirm(i):this.value(i))},_ondblclick:function(t){var e=this.value();e&&this.options.ondblclick&&this.options.ondblclick(e)},_refresh:function(){0==this.row_count?this.$tmessage.show():this.$tmessage.hide()},_template:function(){return'<div><table class="'+this.options.cls+'"><thead/><tbody/></table><tmessage>'+this.options.content+"</tmessage><div>"}});e.default={View:o}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n,a){Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=(function(t){t&&t.__esModule}(r),t.Model.extend({initialize:function(t){this.app=t},checksum:function(){var t="",e=this;return this.app.section.$el.find(".section-row").each(function(){var i=n(this).attr("id"),a=e.app.field_list[i];a&&(t+=i+":"+JSON.stringify(a.value&&a.value())+":"+a.collapsed+";")}),t},create:function(){function t(t,e,n){i.flat_dict[t]=e,a[t]=n,i.app.element_list[e]&&i.app.element_list[e].$el.attr("tour_id",t)}function e(n,a){for(var r in a){var o=a[r];if(o.input){var l=o.input,d=n;switch(""!=n&&(d+="|"),d+=l.name,l.type){case"repeat":var c=[],u=null;for(var h in o){var f=h.indexOf("section-");-1!=f&&(f+="section-".length,c.push(parseInt(h.substr(f))),u||(u=h.substr(0,f)))}c.sort(function(t,e){return t-e});var r=0;for(var p in c)e(d+"_"+r++,o[u+c[p]]);break;case"conditional":var _=i.app.field_list[l.id].value();t(d+"|"+l.test_param.name,l.id,_);var m=s(l,_);-1!=m&&e(d,a[l.id+"-section-"+m]);break;case"section":e(!l.flat&&d||"",o);break;default:var g=i.app.field_list[l.id];if(g&&g.value){var _=g.value();if((void 0===l.ignore||l.ignore!=_)&&(g.collapsed&&l.collapsible_value&&(_=l.collapsible_value),t(d,l.id,_),l.payload))for(var v in l.payload)t(v,l.id,l.payload[v])}}}}}var i=this,n={};this._iterate(this.app.section.$el,n);var a={};return this.flat_dict={},e("",n),a},match:function(t){return this.flat_dict&&this.flat_dict[t]},matchCase:function(t,e){return s(t,e)},matchModel:function(t,e){var i=this;l(t.inputs,function(t,n){i.flat_dict[n]&&e(t,i.flat_dict[n])})},matchResponse:function(t){function e(t,a){if("string"==typeof a){var r=n.flat_dict[t];r&&(i[r]=a)}else for(var o in a){var s=o;if(""!==t){var l="|";a instanceof Array&&(l="_"),s=t+l+s}e(s,a[o])}}var i={},n=this;return e("",t),i},_iterate:function(t,e){var i=this;n(t).children().each(function(){var t=this,a=n(t).attr("id");if(n(t).hasClass("section-row")){var r=i.app.input_list[a];e[a]=r&&{input:r}||{},i._iterate(t,e[a])}else i._iterate(t,e)})}})),s=function(t,e){"boolean"==t.test_param.type&&(e="true"==e?t.test_param.truevalue||"true":t.test_param.falsevalue||"false");for(var i in t.cases)if(t.cases[i].value==e)return i;return-1},l=function t(e,i,r,o){o=n.extend(!0,{},o),a.each(e,function(t){t&&t.type&&t.name&&(o[t.name]=t)});for(var l in e){var d=e[l];d.name=d.name||l;var c=r?r+"|"+d.name:d.name;switch(d.type){case"repeat":a.each(d.cache,function(e,n){t(e,i,c+"_"+n,o)});break;case"conditional":if(d.test_param){i(d.test_param,c+"|"+d.test_param.name,o);var u=s(d,d.test_param.value);-1!=u?t(d.cases[u].inputs,i,c,o):Galaxy.emit.debug("form-data::visitInputs() - Invalid case for "+c+".")}else Galaxy.emit.debug("form-data::visitInputs() - Conditional test parameter missing for "+c+".");break;case"section":t(d.inputs,i,c,o);break;default:i(d,c,o)}}};e.default={Manager:o,visitInputs:l}}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";(function(t,i,n){Object.defineProperty(e,"__esModule",{value:!0});var a=t.View.extend({initialize:function(e){this.model=e&&e.model||new t.Model(e),this.setElement(i("<div/>").addClass("corner frame")),this.$el.append(i("<div/>").addClass("f-header corner").append(i("<div/>").addClass("f-title")).append(i("<div/>").addClass("f-icon f-close fa fa-close").tooltip({title:"Close",placement:"bottom"}))).append(i("<div/>").addClass("f-content")).append(i("<div/>").addClass("f-resize f-icon corner fa fa-expand").tooltip({title:"Resize"})).append(i("<div/>").addClass("f-cover")),this.$header=this.$(".f-header"),this.$title=this.$(".f-title"),this.$content=this.$(".f-content"),this.render(),this.listenTo(this.model,"change",this.render,this)},render:function(){var t=this,e=this.model.attributes;this.$title.html(e.title||""),this.$header.find(".f-icon-left").remove(),n.each(e.menu,function(e){var a=i("<div/>").addClass("f-icon-left").addClass(e.icon);n.isFunction(e.disabled)&&e.disabled()?a.attr("disabled",!0):a.on("click",function(){e.onclick(t)}).tooltip({title:e.tooltip,placement:"bottom"}),t.$header.append(a)}),e.url?this.$content.html(i("<iframe/>").addClass("f-iframe").attr("scrolling","auto").attr("src",e.url+(-1===e.url.indexOf("?")?"?":"&")+"widget=True")):e.content&&(n.isFunction(e.content)?e.content(t.$content):t.$content.html(e.content))}}),r=t.View.extend({defaultOptions:{frame:{cols:6,rows:3},rows:1e3,cell:130,margin:5,scroll:5,top_min:40,frame_max:9,visible:!0},cols:0,top:0,top_max:0,frame_z:0,frame_counter:0,frame_uid:0,frame_list:{},frame_shadow:null,visible:!1,event:{},initialize:function(e){var a=this;this.options=n.defaults(e||{},this.defaultOptions),this.visible=this.options.visible,this.top=this.top_max=this.options.top_min,this.setElement(i("<div/>").addClass("galaxy-frame").append(i("<div/>").addClass("frame-background")).append(i("<div/>").addClass("frame-menu frame-scroll-up fa fa-chevron-up fa-2x")).append(i("<div/>").addClass("frame-menu frame-scroll-down fa fa-chevron-down fa-2x"))),this.frame_shadow=new t.View({el:i("<div/>").addClass("corner frame-shadow")}),this.$el.append(this.frame_shadow.$el),this._frameInit(this.frame_shadow,"#frame-shadow"),this._frameResize(this.frame_shadow,{width:0,height:0}),this.frame_list["#frame-shadow"]=this.frame_shadow,this.visible?this.show():this.hide(),this._panelRefresh(),i(window).resize(function(){a.visible&&a._panelRefresh()})},render:function(){this.$(".frame-scroll-up")[this.top!=this.options.top_min&&"show"||"hide"](),this.$(".frame-scroll-down")[this.top!=this.top_max&&"show"||"hide"]()},add:function(t){if(this.frame_counter>=this.options.frame_max)Galaxy.modal.show({title:"Warning",body:"You have reached the maximum number of allowed frames ("+this.options.frame_max+").",buttons:{Close:function(){Galaxy.modal.hide()}}});else{var e="#frame-"+this.frame_uid++;if(0!==i(e).length)Galaxy.modal.show({title:"Error",body:"This frame already exists. This page might contain multiple frame managers.",buttons:{Close:function(){Galaxy.modal.hide()}}});else{this.top=this.options.top_min;var n=new a(t);this.$el.append(n.$el),t.width=this._toPixelCoord("width",this.options.frame.cols),t.height=this._toPixelCoord("height",this.options.frame.rows),this.frame_z=parseInt(n.$el.css("z-index")),this.frame_list[e]=n,this.frame_counter++,this._frameInit(n,e),this._frameResize(n,{width:t.width,height:t.height}),this._frameInsert(n,{top:0,left:0},!0),!this.visible&&this.show(),this.trigger("add")}}},del:function(t){var e=this,i=t.$el;i.fadeOut("fast",function(){i.remove(),delete e.frame_list[t.id],e.frame_counter--,e._panelRefresh(!0),e._panelAnimationComplete(),e.trigger("remove")})},show:function(){this.visible=!0,this.$el.fadeIn("fast"),this.trigger("show")},hide:function(){this.event.type||(this.visible=!1,this.$el.fadeOut("fast",function(){i(this).hide()}),this.trigger("hide"))},length:function(){return this.frame_counter},events:{mousemove:"_eventFrameMouseMove",mouseup:"_eventFrameMouseUp",mouseleave:"_eventFrameMouseUp",mousewheel:"_eventPanelScroll",DOMMouseScroll:"_eventPanelScroll","mousedown .frame":"_eventFrameMouseDown","mousedown .frame-background":"_eventHide","mousedown .frame-scroll-up":"_eventPanelScroll_up","mousedown .frame-scroll-down":"_eventPanelScroll_down","mousedown .f-close":"_eventFrameClose"},_eventFrameMouseDown:function(t){i(".tooltip").hide(),this.event.type||((i(t.target).hasClass("f-header")||i(t.target).hasClass("f-title"))&&(this.event.type="drag"),i(t.target).hasClass("f-resize")&&(this.event.type="resize"),this.event.type&&(t.preventDefault(),this.event.target=this._frameIdentify(t.target),this.event.xy={x:t.originalEvent.pageX,y:t.originalEvent.pageY},this._frameDragStart(this.event.target)))},_eventFrameMouseMove:function(t){if(this.event.type){var e={x:t.originalEvent.pageX,y:t.originalEvent.pageY},i={x:e.x-this.event.xy.x,y:e.y-this.event.xy.y};this.event.xy=e;var n=this._frameScreen(this.event.target);if("resize"==this.event.type){n.width+=i.x,n.height+=i.y;var a=this.options.cell-this.options.margin-1;n.width=Math.max(n.width,a),n.height=Math.max(n.height,a),this._frameResize(this.event.target,n),n.width=this._toGridCoord("width",n.width)+1,n.height=this._toGridCoord("height",n.height)+1,n.width=this._toPixelCoord("width",n.width),n.height=this._toPixelCoord("height",n.height),this._frameResize(this.frame_shadow,n),this._frameInsert(this.frame_shadow,{top:this._toGridCoord("top",n.top),left:this._toGridCoord("left",n.left)})}else if("drag"==this.event.type){n.left+=i.x,n.top+=i.y,this._frameOffset(this.event.target,n);var r={top:this._toGridCoord("top",n.top),left:this._toGridCoord("left",n.left)};0!==r.left&&r.left++,this._frameInsert(this.frame_shadow,r)}}},_eventFrameMouseUp:function(t){this.event.type&&(this._frameDragStop(this.event.target),this.event.type=null)},_eventFrameClose:function(t){this.event.type||(t.preventDefault(),this.del(this._frameIdentify(t.target)))},_eventHide:function(t){!this.event.type&&this.hide()},_eventPanelScroll:function(t){if(!this.event.type&&this.visible){0!==i(t.srcElement).parents(".frame").length?t.stopPropagation():(t.preventDefault(),this._panelScroll(t.originalEvent.detail?t.originalEvent.detail:t.originalEvent.wheelDelta/-3))}},_eventPanelScroll_up:function(t){this.event.type||(t.preventDefault(),this._panelScroll(-this.options.scroll))},_eventPanelScroll_down:function(t){this.event.type||(t.preventDefault(),this._panelScroll(this.options.scroll))},_frameIdentify:function(t){return this.frame_list["#"+i(t).closest(".frame").attr("id")]},_frameDragStart:function(t){this._frameFocus(t,!0);var e=this._frameScreen(t);this._frameResize(this.frame_shadow,e),this._frameGrid(this.frame_shadow,t.grid_location),t.grid_location=null,this.frame_shadow.$el.show(),i(".f-cover").show()},_frameDragStop:function(t){this._frameFocus(t,!1);var e=this._frameScreen(this.frame_shadow);this._frameResize(t,e),this._frameGrid(t,this.frame_shadow.grid_location,!0),this.frame_shadow.grid_location=null,this.frame_shadow.$el.hide(),i(".f-cover").hide(),this._panelAnimationComplete()},_toGridCoord:function(t,e){var i="width"==t||"height"==t?1:-1;return"top"==t&&(e-=this.top),parseInt((e+i*this.options.margin)/this.options.cell,10)},_toPixelCoord:function(t,e){var i="width"==t||"height"==t?1:-1,n=e*this.options.cell-i*this.options.margin;return"top"==t&&(n+=this.top),n},_toGrid:function(t){return{top:this._toGridCoord("top",t.top),left:this._toGridCoord("left",t.left),width:this._toGridCoord("width",t.width),height:this._toGridCoord("height",t.height)}},_toPixel:function(t){return{top:this._toPixelCoord("top",t.top),left:this._toPixelCoord("left",t.left),width:this._toPixelCoord("width",t.width),height:this._toPixelCoord("height",t.height)}},_isCollision:function(t){for(var e in this.frame_list){var i=this.frame_list[e];if(null!==i.grid_location&&function(t,e){return!(t.left>e.left+e.width-1||t.left+t.width-1<e.left||t.top>e.top+e.height-1||t.top+t.height-1<e.top)}(t,i.grid_location))return!0}return!1},_locationRank:function(t){return t.top*this.cols+t.left},_panelRefresh:function(t){this.cols=parseInt(i(window).width()/this.options.cell,10)+1,this._frameInsert(null,null,t)},_panelAnimationComplete:function(){var t=this;i(".frame").promise().done(function(){t._panelScroll(0,!0)})},_panelScroll:function(t,e){var i=this.top-this.options.scroll*t;if(i=Math.max(i,this.top_max),i=Math.min(i,this.options.top_min),this.top!=i){for(var n in this.frame_list){var a=this.frame_list[n];if(null!==a.grid_location){var r={top:a.screen_location.top-(this.top-i),left:a.screen_location.left};this._frameOffset(a,r,e)}}this.top=i}this.render()},_frameInit:function(t,e){t.id=e,t.screen_location={},t.grid_location={},t.grid_rank=null,t.$el.attr("id",e.substring(1))},_frameInsert:function(t,e,a){var r=this,o=[];t&&(t.grid_location=null,o.push([t,this._locationRank(e)])),n.each(this.frame_list,function(t){null!==t.grid_location&&(t.grid_location=null,o.push([t,t.grid_rank]))}),o.sort(function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:0}),n.each(o,function(t){r._framePlace(t[0],a)}),this.top_max=0,n.each(this.frame_list,function(t){null!==t.grid_location&&(r.top_max=Math.max(r.top_max,t.grid_location.top+t.grid_location.height))}),this.top_max=i(window).height()-this.top_max*this.options.cell-2*this.options.margin,this.top_max=Math.min(this.top_max,this.options.top_min),this.render()},_framePlace:function(t,e){t.grid_location=null;for(var i=this._toGrid(this._frameScreen(t)),n=!1,a=0;a<this.options.rows;a++){for(var r=0;r<Math.max(1,this.cols-i.width);r++)if(i.top=a,i.left=r,!this._isCollision(i)){n=!0;break}if(n)break}n?this._frameGrid(t,i,e):console.log("Grid dimensions exceeded.")},_frameFocus:function(t,e){t.$el.css("z-index",this.frame_z+(e?1:0))},_frameOffset:function(t,e,i){if(t.screen_location.left=e.left,t.screen_location.top=e.top,i){this._frameFocus(t,!0);var n=this;t.$el.animate({top:e.top,left:e.left},"fast",function(){n._frameFocus(t,!1)})}else t.$el.css({top:e.top,left:e.left})},_frameResize:function(t,e){t.$el.css({width:e.width,height:e.height}),t.screen_location.width=e.width,t.screen_location.height=e.height},_frameGrid:function(t,e,i){t.grid_location=e,this._frameOffset(t,this._toPixel(e),i),t.grid_rank=this._locationRank(e)},_frameScreen:function(t){var e=t.screen_location;return{top:e.top,left:e.left,width:e.width,height:e.height}}});e.default={View:r}}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=function(t){return t&&t.__esModule?t:{default:t}}(a),o=t.View.extend({initialize:function(e){var i=this;this.model=e&&e.model||new t.Model({id:r.default.uid(),min:null,max:null,step:null,precise:!1,split:1e4,value:null,onchange:function(){}}).set(e),this.setElement(this._template()),this.$el.attr("id",this.model.id),this.$text=this.$(".ui-form-slider-text"),this.$slider=this.$(".ui-form-slider-element");var a=[];this.$text.on("change",function(){i.value(n(this).val())}).on("keyup",function(t){a[t.which]=!1}).on("keydown",function(t){var e=t.which;a[e]=!0,i.model.get("is_workflow")&&a[16]&&52==e?(i.value("$"),event.preventDefault()):8==e||9==e||13==e||37==e||39==e||e>=48&&e<=57&&!a[16]||e>=96&&e<=105||(190==e||110==e)&&-1==n(this).val().indexOf(".")&&i.model.get("precise")||(189==e||109==e)&&-1==n(this).val().indexOf("-")||i._isParameter(n(this).val())||a[91]||a[17]||event.preventDefault()});var o=this.model.attributes;this.has_slider=null!==o.max&&null!==o.min&&o.max>o.min;var s=o.step;s||(s=o.precise&&this.has_slider?(o.max-o.min)/o.split:1),this.has_slider?(this.$text.addClass("ui-form-slider-left"),this.$slider.slider({min:o.min,max:o.max,step:s}).on("slide",function(t,e){i.value(e.value)})):this.$slider.hide(),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this.model.get("value");this.has_slider&&this.$slider.slider("value",t),t!==this.$text.val()&&this.$text.val(t)},value:function(t){var e=this.model.attributes;return void 0!==t&&(null===t||""===t||this._isParameter(t)||(isNaN(t)&&(t=0),!e.precise&&(t=Math.round(t)),null!==e.max&&(t=Math.min(t,e.max)),null!==e.min&&(t=Math.max(t,e.min))),this.model.set("value",t),this.model.trigger("change"),e.onchange(t)),this.model.get("value")},_isParameter:function(t){return this.model.get("is_workflow")&&"$"===String(t).substring(0,1)},_template:function(){return'<div class="ui-form-slider"><input class="ui-form-slider-text" type="text"/><div class="ui-form-slider-element"/></div>'}});e.default={View:o}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=a(r),s=i(23),l=a(s),d=l.default.BaseIcons.extend({initialize:function(t){t.type=t.display||"checkbox",t.multiple="checkbox"==t.type,l.default.BaseIcons.prototype.initialize.call(this,t)},_setValue:function(e){if(l.default.BaseIcons.prototype._setValue.call(this,e),void 0!==e&&null!==e&&this.header_index){var i=this,a=t.isArray(e)?e:[e];n.each(a,function(t){var e=i.header_index[t];n.each(e,function(t){i._setState(t,!0)})})}},_setState:function(t,e){var i=this.$(".button-"+t),n=this.$(".subgroup-"+t);i.data("is_expanded",e),e?(n.show(),i.removeClass("fa-plus-square").addClass("fa-minus-square")):(n.hide(),i.removeClass("fa-minus-square").addClass("fa-plus-square"))},_templateOptions:function(){function e(t,e){var i=t.find(".button-"+e);i.on("click",function(){n._setState(e,!i.data("is_expanded"))})}function i(a,r,s){s=s||[];for(var l in r){var d=r[l],c=d.options&&d.options.length>0,u=s.slice(0);n.header_index[d.value]=u.slice(0);var h=t("<div/>");if(c){var f=o.default.uid(),p=t("<span/>").addClass("button-"+f).addClass("ui-drilldown-button fa fa-plus-square"),_=t("<div/>").addClass("subgroup-"+f).addClass("ui-drilldown-subgroup");h.append(t("<div/>").append(p).append(n._templateOption({label:d.name,value:d.value}))),u.push(f),i(_,d.options,u),h.append(_),e(h,f)}else h.append(n._templateOption({label:d.name,value:d.value}));a.append(h)}}var n=this;this.header_index={};var a=t("<div/>");return i(a,this.model.get("data")),a},_template:function(){return t("<div/>").addClass("ui-options-list drilldown-container").attr("id",this.model.id)}});e.default={View:d}}).call(e,i(0),i(2))},function(t,e,i){"use strict";(function(t,n,a,r){function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(3),l=o(s),d=i(4),c=(o(d),i(11)),u=o(c),h=i(49),f=o(h),p=i(50),_=o(p),m=i(51),g=o(m),v=t.View.extend({initialize:function(t,e){this.app=t,this.inputs=e.inputs,this.parameters=new g.default,this.setElement(n("<div/>")),this.render()},render:function(){var t=this;this.$el.empty(),a.each(this.inputs,function(e){t.add(e)})},add:function(t){var e=r.extend(!0,{},t);switch(e.id=t.id=l.default.uid(),this.app.input_list[e.id]=e,e.type){case"conditional":this._addConditional(e);break;case"repeat":this._addRepeat(e);break;case"section":this._addSection(e);break;default:this._addRow(e)}},_addConditional:function(t){var e=this;t.test_param.id=t.id,this.app.model.get("sustain_conditionals")&&(t.test_param.disabled=!0);var i=this._addRow(t.test_param);i.model&&i.model.set("onchange",function(i){var n=e.app.data.matchCase(t,i);for(var a in t.cases){var r=t.cases[a],o=e.$("#"+t.id+"-section-"+a),s=!1;for(var l in r.inputs)if(!r.inputs[l].hidden){s=!0;break}a==n&&s?o.fadeIn("fast"):o.hide()}e.app.trigger("change")});for(var n in t.cases){var a=new v(this.app,{inputs:t.cases[n].inputs});this._append(a.$el.addClass("ui-form-section"),t.id+"-section-"+n)}i.trigger("change")},_addRepeat:function(t){function e(e){var a=t.id+"-section-"+n++,o=new v(i.app,{inputs:e});r.add({id:a,$el:o.$el,ondel:function(){r.del(a),i.app.trigger("change")}})}for(var i=this,n=0,r=new f.default.View({title:t.title||"Repeat",min:t.min,max:t.max,onnew:function(){e(t.inputs),i.app.trigger("change")}}),o=a.size(t.cache),s=0;s<Math.max(Math.max(o,t.min||0),t.default||0);s++)e(s<o?t.cache[s]:t.inputs);this.app.model.get("sustain_repeats")&&r.hideOptions();var l=new _.default(this.app,{label:t.title||t.name,help:t.help,field:r});this._append(l.$el,t.id)},_addSection:function(t){var e=new u.default.View({title:t.title||t.name,cls:"ui-portlet-section",collapsible:!0,collapsible_button:!0,collapsed:!t.expanded});e.append(new v(this.app,{inputs:t.inputs}).$el),e.append(n("<div/>").addClass("ui-form-info").html(t.help)),this.app.on("expand",function(t){e.$("#"+t).length>0&&e.expand()}),this._append(e.$el,t.id)},_addRow:function(t){var e=this,i=t.id;t.onchange=t.onchange||function(){e.app.trigger("change",i)};var n=this.parameters.create(t);this.app.field_list[i]=n;var a=new _.default(this.app,{name:t.name,label:t.hide_label?"":t.label||t.name,value:t.value,text_value:t.text_value,collapsible_value:t.collapsible_value,collapsible_preview:t.collapsible_preview,help:t.help,argument:t.argument,disabled:t.disabled,color:t.color,style:t.style,backdrop:t.backdrop,hidden:t.hidden,fixed:t.fixed,field:n});return this.app.element_list[i]=a,this._append(a.$el,t.id),n},_append:function(t,e){this.$el.append(t.addClass("section-row").attr("id",e))}});e.default={View:v}}).call(e,i(1),i(0),i(2),i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=r(o),l=i(11),d=r(l),c=i(4),u=r(c),h=t.View.extend({initialize:function(t){this.list={},this.options=s.default.merge(t,{title:"Repeat",empty_text:"Not available.",max:null,min:null}),this.button_new=new u.default.ButtonIcon({icon:"fa-plus",title:"Insert "+this.options.title,tooltip:"Add new "+this.options.title+" block",cls:"ui-button-icon ui-clear-float form-repeat-add",onclick:function(){t.onnew&&t.onnew()}}),this.setElement(n("<div/>").append(this.$list=n("<div/>")).append(n("<div/>").append(this.button_new.$el)))},size:function(){return a.size(this.list)},add:function(t){if(!t.id||this.list[t.id])return void Galaxy.emit.debug("form-repeat::add()","Duplicate or invalid repeat block id.");var e=new u.default.ButtonIcon({icon:"fa-trash-o",tooltip:"Delete this repeat block",cls:"ui-button-icon-plain form-repeat-delete",onclick:function(){t.ondel&&t.ondel()}}),i=new d.default.View({id:t.id,title:"placeholder",cls:t.cls||"ui-portlet-repeat",operations:{button_delete:e}});i.append(t.$el),i.$el.addClass("section-row").hide(),this.list[t.id]=i,this.$list.append(i.$el.fadeIn("fast")),this.options.max>0&&this.size()>=this.options.max&&this.button_new.disable(),this._refresh()},del:function(t){if(!this.list[t])return void Galaxy.emit.debug("form-repeat::del()","Invalid repeat block id.");this.$list.find("#"+t).remove(),delete this.list[t],this.button_new.enable(),this._refresh()},delAll:function(){for(var t in this.list)this.del(t)},hideOptions:function(){this.button_new.$el.hide(),a.each(this.list,function(t){t.hideOperation("button_delete")}),a.isEmpty(this.list)&&this.$el.append(n("<div/>").addClass("ui-form-info").html(this.options.empty_text))},_refresh:function(){var t=0;for(var e in this.list){var i=this.list[e];i.title(++t+": "+this.options.title),i[this.size()>this.options.min?"showOperation":"hideOperation"]("button_delete")}}});e.default={View:h}}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";(function(t,i,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.View.extend({initialize:function(e,i){this.app=e,this.app_options=e.model?e.model.attributes:{},this.field=i&&i.field||new t.View,this.model=i&&i.model||new t.Model({text_enable:this.app_options.text_enable||"Enable",text_disable:this.app_options.text_disable||"Disable",cls_enable:this.app_options.cls_enable||"fa fa-caret-square-o-down",cls_disable:this.app_options.cls_disable||"fa fa-caret-square-o-up",always_refresh:this.app_options.always_refresh}).set(i),this.setElement(this._template()),this.$field=this.$(".ui-form-field"),this.$info=this.$(".ui-form-info"),this.$preview=this.$(".ui-form-preview"),this.$collapsible=this.$(".ui-form-collapsible"),this.$collapsible_text=this.$(".ui-form-collapsible-text"),this.$collapsible_icon=this.$(".ui-form-collapsible-icon"),this.$title=this.$(".ui-form-title"),this.$title_text=this.$(".ui-form-title-text"),this.$error_text=this.$(".ui-form-error-text"),this.$error=this.$(".ui-form-error"),this.$backdrop=this.$(".ui-form-backdrop"),this.$field.prepend(this.field.$el);var n=this.model.get("collapsible_value");this.field.collapsed=void 0!==n&&JSON.stringify(this.model.get("value"))==JSON.stringify(n),this.listenTo(this.model,"change",this.render,this),this.render();var a=this;this.$collapsible.on("click",function(){a.field.collapsed=!a.field.collapsed,e.trigger&&e.trigger("change"),a.render()}),this.field.model&&!this.model.get("always_refresh")&&this.listenTo(this.field.model,"change:value",function(){a.reset()})},backdrop:function(){this.model.set("backdrop",!0)},error:function(t){this.model.set("error_text",t)},reset:function(){!this.model.get("fixed")&&this.model.set("error_text",null)},render:function(){i(".tooltip").hide();var t=this.model.get("help",""),e=this.model.get("argument");e&&-1==t.indexOf("("+e+")")&&(t+=" ("+e+")"),this.$info.html(t),this.$el[this.model.get("hidden")?"hide":"show"](),this.$preview[this.field.collapsed&&this.model.get("collapsible_preview")||this.model.get("disabled")?"show":"hide"]().html(n.escape(this.model.get("text_value")));var a=this.model.get("error_text");if(this.$error[a?"show":"hide"](),this.$el[a?"addClass":"removeClass"]("ui-error"),this.$error_text.html(a),this.$backdrop[this.model.get("backdrop")?"show":"hide"](),this.field.collapsed||this.model.get("disabled")?this.$field.hide():this.$field.show(),this.field.model&&this.field.model.set({color:this.model.get("color"),style:this.model.get("style")}),this.model.get("disabled")||void 0===this.model.get("collapsible_value"))this.$title_text.show().text(this.model.get("label")),this.$collapsible.hide();else{var r=this.field.collapsed?"enable":"disable";this.$title_text.hide(),this.$collapsible.show(),this.$collapsible_text.text(this.model.get("label")),this.$collapsible_icon.removeClass().addClass("icon").addClass(this.model.get("cls_"+r)).attr("data-original-title",this.model.get("text_"+r)).tooltip({placement:"bottom"})}},_template:function(){return i("<div/>").addClass("ui-form-element").append(i("<div/>").addClass("ui-form-error ui-error").append(i("<span/>").addClass("fa fa-arrow-down")).append(i("<span/>").addClass("ui-form-error-text"))).append(i("<div/>").addClass("ui-form-title").append(i("<div/>").addClass("ui-form-collapsible").append(i("<i/>").addClass("ui-form-collapsible-icon")).append(i("<span/>").addClass("ui-form-collapsible-text"))).append(i("<span/>").addClass("ui-form-title-text"))).append(i("<div/>").addClass("ui-form-field").append(i("<span/>").addClass("ui-form-info")).append(i("<div/>").addClass("ui-form-backdrop"))).append(i("<div/>").addClass("ui-form-preview"))}})}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=r(o),l=i(4),d=r(l),c=i(52),u=r(c),h=i(53),f=r(h),p=i(54),_=r(p),m=i(55),g=r(m),v=i(57),b=r(v);e.default=t.Model.extend({types:{text:"_fieldText",password:"_fieldText",select:"_fieldSelect",data_column:"_fieldSelect",genomebuild:"_fieldSelect",data:"_fieldData",data_collection:"_fieldData",integer:"_fieldSlider",float:"_fieldSlider",boolean:"_fieldBoolean",drill_down:"_fieldDrilldown",color:"_fieldColor",hidden:"_fieldHidden",hidden_data:"_fieldHidden",baseurl:"_fieldHidden",library_data:"_fieldLibrary",ftpfile:"_fieldFtp",upload:"_fieldUpload",genomespacefile:"_fieldGenomeSpace"},create:function(t){var e=this.types[t.type],i="function"==typeof this[e]?this[e].call(this,t):null;return i||(i=t.options?this._fieldSelect(t):this._fieldText(t),Galaxy.emit.debug("form-parameters::_addRow()","Auto matched field type ("+t.type+").")),void 0===t.value&&(t.value=null),i.value(t.value),i},_fieldData:function(t){return new u.default.View({id:"field-"+t.id,extensions:t.extensions,optional:t.optional,multiple:t.multiple,type:t.type,flavor:t.flavor,data:t.options,onchange:t.onchange})},_fieldSelect:function(t){if(t.is_workflow)return this._fieldText(t);"data_column"==t.type&&(t.error_text="Missing columns in referenced dataset.");var e=t.data;e||(e=[],n.each(t.options,function(t){e.push({label:t[0],value:t[1]})}));var i=d.default.Select;switch(t.display){case"checkboxes":i=d.default.Checkbox;break;case"radio":i=d.default.Radio;break;case"radiobutton":i=d.default.RadioButton}return new i.View({id:"field-"+t.id,data:e,error_text:t.error_text||"No options available",readonly:t.readonly,multiple:t.multiple,optional:t.optional,onchange:t.onchange,individual:t.individual,searchable:"workflow"!==t.flavor})},_fieldDrilldown:function(t){return t.is_workflow?this._fieldText(t):new d.default.Drilldown.View({id:"field-"+t.id,data:t.options,display:t.display,optional:t.optional,onchange:t.onchange})},_fieldText:function(t){if(t.options&&t.data)if(t.area=t.multiple,s.default.isEmpty(t.value))t.value=null;else if(a.isArray(t.value)){var e="";for(var i in t.value){if(e+=String(t.value[i]),!t.multiple)break;e+="\n"}t.value=e}return new d.default.Input({id:"field-"+t.id,type:t.type,area:t.area,readonly:t.readonly,placeholder:t.placeholder,datalist:t.datalist,onchange:t.onchange})},_fieldSlider:function(t){return new d.default.Slider.View({id:"field-"+t.id,precise:"float"==t.type,is_workflow:t.is_workflow,min:t.min,max:t.max,onchange:t.onchange})},_fieldHidden:function(t){return new d.default.Hidden({id:"field-"+t.id,info:t.info})},_fieldBoolean:function(t){return new d.default.RadioButton.View({id:"field-"+t.id,data:[{label:"Yes",value:"true"},{label:"No",value:"false"}],onchange:t.onchange})},_fieldColor:function(t){return new b.default({id:"field-"+t.id,onchange:t.onchange})},_fieldLibrary:function(t){return new f.default.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:t.onchange})},_fieldFtp:function(t){return new _.default.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:t.onchange})},_fieldGenomeSpace:function(t){var e=this;return new g.default.View({id:"field-"+t.id,onchange:function(){e.app.trigger("change")}})},_fieldUpload:function(t){return new d.default.Upload({id:"field-"+t.id,onchange:t.onchange})}})}).call(e,i(1),i(2),i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=r(o),l=i(4),d=r(l),c=i(22),u=r(c),h={DISABLED:"disabled",ENABLED:"enabled",LINKED:"linked"},f={data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:h.DISABLED},{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:h.LINKED},{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:h.LINKED}],data_multiple:[{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:h.DISABLED},{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collections",multiple:!0,batch:h.DISABLED}],data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:h.DISABLED}],workflow_data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:h.DISABLED}],workflow_data_multiple:[{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:h.DISABLED}],workflow_data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:h.DISABLED}],module_data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:h.DISABLED},{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:h.ENABLED}],module_data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:h.DISABLED},{src:"hdca",icon:"fa-folder",tooltip:"Multiple collections",multiple:!0,batch:h.ENABLED}]},p=t.View.extend({initialize:function(e){var i=this;this.model=e&&e.model||new t.Model({src_labels:{hda:"dataset",hdca:"dataset collection"},pagelimit:100,statustimer:1e3}).set(e),this.setElement(n("<div/>").addClass("ui-select-content")),this.button_product=new d.default.RadioButton.View({value:"false",data:[{icon:"fa fa-chain",value:"false",tooltip:"Linked inputs will be run in matched order with other datasets e.g. use this for matching forward and reverse reads."},{icon:"fa fa-chain-broken",value:"true",tooltip:"Unlinked dataset inputs will be run against *all* other inputs."}]});var a=n("<div/>").addClass("ui-form-info").append(n("<i/>").addClass("fa fa-sitemap")).append(n("<span/>").html("This is a batch mode input field. Separate jobs will be triggered for each dataset selection."));this.$batch={linked:a.clone(),enabled:a.clone().append(n("<div/>").append(n("<div/>").addClass("ui-form-title").html("Batch options:")).append(this.button_product.$el)).append(n("<div/>").css("clear","both"))},this.$el.on("dragenter",function(t){this.lastenter=t.target,i.$el.addClass("ui-dragover")}).on("dragover",function(t){t.preventDefault()}).on("dragleave",function(t){this.lastenter===t.target&&i.$el.removeClass("ui-dragover")}).on("drop",function(t){i._handleDrop(t)}),this.history={},this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:current",this._changeCurrent,this),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:type change:optional change:multiple change:extensions",this._changeType,this),this.render(),this.on("change",function(){e.onchange&&e.onchange(i.value())})},render:function(){this._changeType(),this._changeValue(),this._changeWait()},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},update:function(t){this.model.set("data",t)},value:function(t){void 0!==t&&this.model.set("value",t);var e=this.model.get("current");if(this.config[e]){var i=this.fields[e].value();if(null!==i&&(i=n.isArray(i)?i:[i],i.length>0)){var a=this._batch({values:[]});for(var r in i){var o=this.history[i[r]+"_"+this.config[e].src];if(!o)return Galaxy.emit.debug("ui-select-content::value()","Requested details not found for '"+i[r]+"'."),null;a.values.push(o)}return a.values.sort(function(t,e){return t.hid-e.hid}),a}}else Galaxy.emit.debug("ui-select-content::value()","Invalid value/source '"+t+"'.");return null},_changeCurrent:function(){var t=this;a.each(this.fields,function(e,i){t.model.get("current")==i?(e.$el.show(),a.each(t.$batch,function(e,n){e[t.config[i].batch==n?"show":"hide"]()}),t.button_type.value(i)):e.$el.hide()})},_changeType:function(){var t=this,e=(this.model.get("flavor")?this.model.get("flavor")+"_":"")+String(this.model.get("type"))+(this.model.get("multiple")?"_multiple":"");f[e]?this.config=f[e]:(this.config=f.data,Galaxy.emit.debug("ui-select-content::_changeType()","Invalid configuration/type id '"+e+"'."));var i=t.model.get("data"),n=s.default.textify(this.model.get("extensions")),r=this.model.get("src_labels");this.fields=[],this.button_data=[],a.each(this.config,function(e,a){t.button_data.push({value:a,icon:e.icon,tooltip:e.tooltip}),t.fields.push(new u.default.View({optional:t.model.get("optional"),multiple:e.multiple,searchable:!e.multiple||i&&i[e.src]&&i[e.src].length>t.model.get("pagelimit"),individual:!0,error_text:"No "+(n?n+" ":"")+(r[e.src]||"content")+" available.",onchange:function(){t.trigger("change")}}))}),this.button_type=new d.default.RadioButton.View({value:this.model.get("current"),data:this.button_data,onchange:function(e){t.model.set("current",e),t.trigger("change")}}),this.$el.empty();var o=0;this.fields.length>1&&(this.$el.append(this.button_type.$el),o=Math.max(0,36*this.fields.length)+"px"),a.each(this.fields,function(e){t.$el.append(e.$el.css({"margin-left":o}))}),a.each(this.$batch,function(e,i){t.$el.append(e.css({"margin-left":o}))}),this.model.set("current",0),this._changeCurrent(),this._changeData()},_changeWait:function(){var t=this;a.each(this.fields,function(e){e[t.model.get("wait")?"wait":"unwait"]()})},_changeData:function(){var t=this.model.get("data"),e=this,i={};a.each(t,function(t,n){i[n]=[],a.each(t,function(t){i[n].push({hid:t.hid,keep:t.keep,label:t.hid+": "+t.name,value:t.id,tags:t.tags}),e.history[t.id+"_"+n]=t})}),a.each(this.config,function(t,n){i[t.src]&&e.fields[n].add(i[t.src],function(t,e){return e.hid-t.hid})})},_changeValue:function(){var t=this.model.get("value");if(t&&t.values&&t.values.length>0){var e=[];a.each(t.values,function(t){e.push(t.id)});for(var i=t.values[0].src,n=t.values.length>1,r=0;r<this.config.length;r++){var o=this.fields[r],s=this.config[r];if(s.src==i&&-1!==[n,!0].indexOf(s.multiple)){this.model.set("current",r),o.value(e);break}}}else a.each(this.fields,function(t){t.value(null)})},_handleDrop:function(t){try{var e=this.model.get("data"),i=this.model.get("current"),n=this.config[i],r=this.fields[i],o=JSON.parse(t.originalEvent.dataTransfer.getData("text"))[0],s=o.id,l="dataset"==o.history_content_type?"hda":"hdca",d={id:s,src:l};if(e&&a.findWhere(e[l],d)){if(n.src==l){var c=r.value();c&&n.multiple?-1==c.indexOf(s)&&c.push(s):c=s,r.value(c)}else this.model.set("value",{values:[d]}),this.model.trigger("change:value");this.trigger("change"),this._handleDropStatus("success")}else this._handleDropStatus("danger")}catch(t){this._handleDropStatus("danger")}t.preventDefault()},_handleDropStatus:function(t){var e=this;this.$el.removeClass("ui-dragover").addClass("ui-dragover-"+t),setTimeout(function(){e.$el.removeClass("ui-dragover-"+t)},this.model.get("statustimer"))},_batch:function(t){t.batch=!1;var e=this.model.get("current"),i=this.config[e];if("hdca"==i.src&&!i.multiple){var n=this.history[this.fields[e].value()+"_hdca"];n&&n.map_over_type&&(t.batch=!0)}return i.batch!=h.LINKED&&i.batch!=h.ENABLED||(t.batch=!0,i.batch==h.ENABLED&&"true"===this.button_product.value()&&(t.product=!0)),t}});e.default={View:p}}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=(n(a),i(4)),o=n(r),s=i(43),l=(n(s),i(24)),d=n(l),c=t.Collection.extend({url:Galaxy.root+"api/libraries?deleted=false"}),u=t.Collection.extend({initialize:function(){var e=this;this.config=new t.Model({library_id:null}),this.config.on("change",function(){e.fetch({reset:!0})})},url:function(){return Galaxy.root+"api/libraries/"+this.config.get("library_id")+"/contents"}}),h=t.View.extend({initialize:function(t){var e=this;this.libraries=new c,this.datasets=new u,this.options=t,this.library_select=new o.default.Select.View({onchange:function(t){e.datasets.config.set("library_id",t)}}),this.dataset_list=new d.default.View({name:"dataset",optional:t.optional,multiple:t.multiple,onchange:function(){e.trigger("change")}}),this.libraries.on("reset",function(){var t=[];e.libraries.each(function(e){t.push({value:e.id,label:e.get("name")})}),e.library_select.update(t)}),this.datasets.on("reset",function(){var t=[];null!==e.library_select.text()&&e.datasets.each(function(e){"file"===e.get("type")&&t.push({value:e.id,label:e.get("name")})}),e.dataset_list.update(t)}),this.on("change",function(){t.onchange&&t.onchange(e.value())}),this.setElement(this._template()),this.$(".library-select").append(this.library_select.$el),this.$el.append(this.dataset_list.$el),this.libraries.fetch({reset:!0,success:function(){e.library_select.trigger("change"),void 0!==e.options.value&&e.value(e.options.value)}})},value:function(t){return this.dataset_list.value(t)},_template:function(){return'<div class="ui-select-library"><div class="library ui-margin-bottom"><span class="library-title">Select Library</span><span class="library-select"/></div></div>'}});e.default={View:h}}).call(e,i(1))},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=n(a),o=i(24),s=n(o),l=t.View.extend({initialize:function(t){var e=this;this.ftpfile_list=new s.default.View({name:"file",optional:t.optional,multiple:t.multiple,onchange:function(){t.onchange&&t.onchange(e.value())}}),this.setElement(this.ftpfile_list.$el),r.default.get({url:Galaxy.root+"api/remote_files",success:function(t){var i=[];for(var n in t)i.push({value:t[n].path,label:t[n].path});e.ftpfile_list.update(i)}})},value:function(t){return this.ftpfile_list.value(t)}});e.default={View:l}}).call(e,i(1))},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=(n(a),i(4)),o=n(r),s=i(56),l=n(s),d=t.View.extend({initialize:function(t){var e=this;this.browse_button=new o.default.ButtonIcon({title:"Browse",icon:"fa fa-sign-in",tooltip:"Browse GenomeSpace",onclick:function(){e.browseGenomeSpace()}}),this.filename_textbox=new o.default.Input,this.token_textbox=new o.default.Input({type:"password"}),this.setElement(this._template(t)),this.$(".ui-gs-browse-button").append(this.browse_button.$el),this.$(".ui-gs-filename-textbox").append(this.filename_textbox.$el),this.$(".ui-gs-token-textbox").append(this.token_textbox.$el)},browseGenomeSpace:function(t){var e=this;l.default.openFileBrowser({successCallback:function(t){e.value(t.destination+"^"+t.token)}})},_template:function(t){return'<div class="ui-gs-select-file"><div class="ui-gs-browse-field"><span class="ui-gs-browse-button" /><span class="ui-gs-filename-textbox" /></div><div class="ui-gs-token-field"><span class=ui-gs-label"><div class="ui-gs-token-label">Token</div></span><span class="ui-gs-token-textbox" /></div></div>'},value:function(t){if(void 0===t)return this._getValue();this._setValue(t)},_getValue:function(){return this.filename_textbox.value()+"^"+this.token_textbox.value()},_setValue:function(t){t&&(values=t.split("^"),this.filename_textbox.value(values[0]),this.token_textbox.value(values[1]))}});e.default={View:d}}).call(e,i(1))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={openFileBrowser:function(t){var e=window.Galaxy.config.genomespace_ui_url,i=e+"upload/loadUrlToGenomespace.html?getLocation=true",n=window.open(i,"GenomeSpace File Browser","height=360px,width=600px");successCalBack=t.successCallback,window.addEventListener("message",function(t){successCalBack(t.data)},!1),n.focus(),null!=t.errorCallback&&(n.setCallbackOnGSUploadError=config.errorCallback)}}},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default=t.View.extend({colors:{standard:["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"],base:["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646"],theme:[["f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada"],["d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5"],["bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f"],["a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09"],["7f7f7e","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"]]},initialize:function(t){this.options=r.default.merge(t,{}),this.setElement(this._template()),this.$panel=this.$(".ui-color-picker-panel"),this.$view=this.$(".ui-color-picker-view"),this.$value=this.$(".ui-color-picker-value"),this.$header=this.$(".ui-color-picker-header"),this._build(),this.visible=!1,this.value(this.options.value),this.$boxes=this.$(".ui-color-picker-box");var e=this;this.$boxes.on("click",function(){e.value(n(this).css("background-color")),e.$header.trigger("click")}),this.$header.on("click",function(){e.visible=!e.visible,e.visible?e.$view.fadeIn("fast"):e.$view.fadeOut("fast")})},value:function(t){return void 0!==t&&null!==t&&(this.$value.css("background-color",t),this.$(".ui-color-picker-box").empty(),this.$(this._getValue()).html(this._templateCheck()),this.options.onchange&&this.options.onchange(t)),this._getValue()},_getValue:function(){var t=this.$value.css("background-color");if(t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/)){var e=function(t){return("0"+parseInt(t).toString(16)).slice(-2)};return"#"+e(t[1])+e(t[2])+e(t[3])}return null},_build:function(){this._content({colors:this.colors.base});for(var t in this.colors.theme){var e={};0==t?e.bottom=!0:t!=this.colors.theme.length-1?(e.top=!0,e.bottom=!0):e.top=!0,e.colors=this.colors.theme[t],this._content(e)}this._content({colors:this.colors.standard})},_content:function(t){var e=t.colors,i=n(this._templateContent()),a=i.find(".line");this.$panel.append(i);for(var r in e){var o=n(this._templateBox(e[r]));t.top&&(o.css("border-top","none"),o.css("border-top-left-radius","0px"),o.css("border-top-right-radius","0px")),t.bottom&&(o.css("border-bottom","none"),o.css("border-bottom-left-radius","0px"),o.css("border-bottom-right-radius","0px")),a.append(o)}return i},_templateCheck:function(){return'<div class="ui-color-picker-check fa fa-check"/>'},_templateContent:function(){return'<div class="ui-color-picker-content"><div class="line"/></div>'},_templateBox:function(t){return'<div id="'+t+'" class="ui-color-picker-box" style="background-color: #'+t+';"/>'},_template:function(){return'<div class="ui-color-picker"><div class="ui-color-picker-header"><div class="ui-color-picker-value"/><div class="ui-color-picker-label">Select a color</div></div><div class="ui-color-picker-view ui-input"><div class="ui-color-picker-panel"/></div>'}})}).call(e,i(1),i(0))},,function(t,e,i){"use strict";function n(t,e){var i=void 0!==t.prototype?t.prototype:t;return void 0!==e&&(i._logNamespace=e),a.forEach(function(t){i[t]=function(){if(this.logger)return this.logger.emit?this.logger.emit(t,this._logNamespace,arguments):this.logger[t]?this.logger[t].apply(this.logger,arguments):void 0}}),t}Object.defineProperty(e,"__esModule",{value:!0});var a=["log","debug","info","warn","error","metric"];e.default=n},function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=(a(r),i(61)),s=a(o),l=i(4),d=a(l),c=i(20),u=a(c),h=i(62),f=a(h),p=i(142),_=a(p);e.default=u.default.extend({initialize:function(t){var e=this;this.deferred=new s.default,u.default.prototype.initialize.call(this,t),this._update(this.model.get("initialmodel")),this.model.get("listen_to_history")&&parent.Galaxy&&parent.Galaxy.currHistoryPanel&&this.listenTo(parent.Galaxy.currHistoryPanel.collection,"change",function(){e.model.get("onchange")()}),this.$el.on("remove",function(){e._destroy()})},_update:function(t){var e=this;t=t||this.model.get("buildmodel"),t?(this.deferred.reset(),this.deferred.execute(function(i){t(i,e),i.then(function(){e._render()})})):this._render()},_destroy:function(){var t=this;this.$el.off().hide(),this.deferred.execute(function(){u.default.prototype.remove.call(t),Galaxy.emit.debug("tool-form-base::_destroy()","Destroy view.")})},_render:function(){var e=this,i=this.model.attributes;this.model.set({title:i.fixed_title||"<b>"+i.name+"</b> "+i.description+" (Galaxy Version "+i.version+")",operations:!i.hide_operations&&this._operations(),onchange:function(){e.deferred.reset(),e.deferred.execute(function(t){e.model.get("postchange")(t,e)})}}),this.render(),this.model.get("collapsible")||this.$el.append(t("<div/>").addClass("ui-margin-top-large").append(this._footer())),this.show_message&&this.message.update({status:"success",message:"Now you are using '"+i.name+"' version "+i.version+", id '"+i.id+"'.",persistent:!1}),this.show_message=!0},_operations:function(){var e=this,i=this.model.attributes,a=new d.default.ButtonMenu({icon:"fa-cubes",title:!i.narrow&&"Versions"||null,tooltip:"Select another tool version"});if(!i.sustain_version&&i.versions&&i.versions.length>1)for(var r in i.versions){var o=i.versions[r];o!=i.version&&a.addMenu({title:"Switch to "+o,version:o,icon:"fa-cube",onclick:function(){e.model.set("id",i.id.replace(i.version,this.version)),e.model.set("version",this.version),e._update()}})}else a.$el.hide();var s=new d.default.ButtonMenu({id:"options",icon:"fa-caret-down",title:!i.narrow&&"Options"||null,tooltip:"View available options"});return i.biostar_url&&(s.addMenu({icon:"fa-question-circle",title:"Question?",onclick:function(){window.open(i.biostar_url+"/p/new/post/")}}),s.addMenu({icon:"fa-search",title:"Search",onclick:function(){window.open(i.biostar_url+"/local/search/page/?q="+i.name)}})),s.addMenu({icon:"fa-share",title:"Share",onclick:function(){prompt("Copy to clipboard: Ctrl+C, Enter",window.location.origin+Galaxy.root+"root?tool_id="+i.id)}}),Galaxy.user&&Galaxy.user.get("is_admin")&&s.addMenu({icon:"fa-download",title:"Download",onclick:function(){window.location.href=Galaxy.root+"api/tools/"+i.id+"/download"}}),i.requirements&&i.requirements.length>0&&s.addMenu({icon:"fa-info-circle",title:"Requirements",onclick:function(){!this.requirements_visible||e.portlet.collapsed?(this.requirements_visible=!0,e.portlet.expand(),e.message.update({persistent:!0,message:e._templateRequirements(i),status:"info"})):(this.requirements_visible=!1,e.message.update({message:""}))}}),i.sharable_url&&s.addMenu({icon:"fa-external-link",title:"See in Tool Shed",onclick:function(){window.open(i.sharable_url)}}),t.getJSON("/api/webhooks/tool-menu/all",function(t){n.each(t,function(t){t.activate&&t.config.function&&s.addMenu({icon:t.config.icon,title:t.config.title,onclick:function(){new Function("options",t.config.function)(i)}})})}),{menu:s,versions:a}},_footer:function(){var e=this.model.attributes,i=t("<div/>").append(this._templateHelp(e));if(e.citations){var n=_.default.extend(f.default),a=document.createElement("div");i.append(a),new n({propsData:{id:e.id,source:"tools"}}).$mount(a)}return i},_templateHelp:function(e){var i=t("<div/>").addClass("ui-form-help").append(e.help);return i.find("a").attr("target","_blank"),i},_templateRequirements:function(e){var i=e.requirements.length;if(i>0){var a="This tool requires ";n.each(e.requirements,function(t,e){a+=t.name+(t.version?" (Version "+t.version+")":"")+(e<i-2?", ":e==i-2?" and ":"")});var r=t("<a/>").attr("target","_blank").attr("href","https://galaxyproject.org/tools/requirements/").text("here");return t("<span/>").append(a+". Click ").append(r).append(" for more information.")}return"No requirements found."}})}).call(e,i(0),i(2))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default=t.Model.extend({initialize:function(){this.active={},this.last=null},execute:function(t){var e=this,i=r.default.uid(),a=t.length>0;this.active[i]=!0;var o=n.Deferred();o.promise().always(function(){delete e.active[i],a&&Galaxy.emit.debug("deferred::execute()",this.state().charAt(0).toUpperCase()+this.state().slice(1)+" "+i)}),n.when(this.last).always(function(){e.active[i]?(a&&Galaxy.emit.debug("deferred::execute()","Running "+i),t(o),!a&&o.resolve()):o.reject()}),this.last=o.promise()},reset:function(){Galaxy.emit.debug("deferred::execute()","Reset");for(var t in this.active)this.active[t]=!1},ready:function(){return n.isEmptyObject(this.active)}})}).call(e,i(1),i(0))},function(t,e,i){"use strict";function n(t){i(69)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(72),r=i.n(a),o=i(138),s=i(65),l=n,d=s(r.a,o.a,!1,l,null,null);e.default=d.exports},function(t,e){function i(t,e){var i=t[1]||"",a=t[3];if(!a)return i;if(e&&"function"==typeof btoa){var r=n(a);return[i].concat(a.sources.map(function(t){return"/*# sourceURL="+a.sourceRoot+t+" */"})).concat([r]).join("\n")}return[i].join("\n")}function n(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=i(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},a=0;a<this.length;a++){var r=this[a][0];"number"==typeof r&&(n[r]=!0)}for(a=0;a<t.length;a++){var o=t[a];"number"==typeof o[0]&&n[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),e.push(o))}},e}},function(t,e,i){function n(t){for(var e=0;e<t.length;e++){var i=t[e],n=c[i.id];if(n){n.refs++;for(var a=0;a<n.parts.length;a++)n.parts[a](i.parts[a]);for(;a<i.parts.length;a++)n.parts.push(r(i.parts[a]));n.parts.length>i.parts.length&&(n.parts.length=i.parts.length)}else{for(var o=[],a=0;a<i.parts.length;a++)o.push(r(i.parts[a]));c[i.id]={id:i.id,refs:1,parts:o}}}}function a(){var t=document.createElement("style");return t.type="text/css",u.appendChild(t),t}function r(t){var e,i,n=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(n){if(p)return _;n.parentNode.removeChild(n)}if(m){var r=f++;n=h||(h=a()),e=o.bind(null,n,r,!1),i=o.bind(null,n,r,!0)}else n=a(),e=s.bind(null,n),i=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else i()}}function o(t,e,i,n){var a=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=g(e,a);else{var r=document.createTextNode(a),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(r,o[e]):t.appendChild(r)}}function s(t,e){var i=e.css,n=e.media,a=e.sourceMap;if(n&&t.setAttribute("media",n),a&&(i+="\n/*# sourceURL="+a.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var d=i(71),c={},u=l&&(document.head||document.getElementsByTagName("head")[0]),h=null,f=0,p=!1,_=function(){},m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,i){p=i;var a=d(t,e);return n(a),function(e){for(var i=[],r=0;r<a.length;r++){var o=a[r],s=c[o.id];s.refs--,i.push(s)}e?(a=d(t,e),n(a)):a=[];for(var r=0;r<i.length;r++){var s=i[r];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete c[s.id]}}}};var g=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t,e,i,n,a,r){var o,s=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(o=t,s=t.default);var d="function"==typeof s?s.options:s;e&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0),i&&(d.functional=!0),a&&(d._scopeId=a);var c;if(r?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=c):n&&(c=n),c){var u=d.functional,h=u?d.render:d.beforeCreate;u?(d._injectStyles=c,d.render=function(t,e){return c.call(e),h(t,e)}):d.beforeCreate=h?[].concat(h,c):[c]}return{esModule:o,exports:s,options:d}}},function(t,e,i){t.exports=i(73)},function(t,e,i){"use strict";(function(t,i,n,a){Object.defineProperty(e,"__esModule",{value:!0});var r=t.View.extend({initialize:function(t,e){this.$button=t,this.$button.length||(this.$button=i("<div/>")),this.options=e||[],this.$button.data("popupmenu",this);var n=this;this.$button.click(function(t){return i(".popmenu-wrapper").remove(),n._renderAndShow(t),!1})},_renderAndShow:function(t){this.render(),this.$el.appendTo("body").css(this._getShownPosition(t)).show(),this._setUpCloseBehavior()},render:function(){if(this.$el.addClass("popmenu-wrapper").hide().css({position:"absolute"}).html(this.template(this.$button.attr("id"),this.options)),this.options.length){var t=this;this.$el.find("li").each(function(e,n){var a=t.options[e];a.func&&i(this).children("a.popupmenu-option").click(function(e){a.func.call(t,e,a),e.preventDefault()})})}return this},template:function(t,e){return['<ul id="',t,'-menu" class="dropdown-menu">',this._templateOptions(e),"</ul>"].join("")},_templateOptions:function(t){return t.length?n.map(t,function(t){return t.divider?'<li class="divider"></li>':t.header?['<li class="head"><a href="javascript:void(0);">',t.html,"</a></li>"].join(""):['<li><a class="popupmenu-option" href="',t.href||"javascript:void(0);",'"',t.target?' target="'+t.target+'"':"",">",t.checked?'<span class="fa fa-check"></span>':"",t.html,"</a></li>"].join("")}).join(""):"<li>(no options)</li>"},_getShownPosition:function(t){var e=this.$el.width(),n=t.pageX-e/2;return n=Math.min(n,i(document).scrollLeft()+i(window).width()-e-5),n=Math.max(n,i(document).scrollLeft()+5),{top:t.pageY,left:n}},_setUpCloseBehavior:function(){function t(t){if(i(document).off("click.close_popup"),window&&window.parent!==window)try{i(window.parent.document).off("click.close_popup")}catch(t){}else try{i("iframe#galaxy_main").contents().off("click.close_popup")}catch(t){}e.remove()}var e=this;if(i("html").one("click.close_popup",t),window&&window.parent!==window)try{i(window.parent.document).find("html").one("click.close_popup",t)}catch(t){}else try{i("iframe#galaxy_main").contents().one("click.close_popup",t)}catch(t){}},addItem:function(t,e){return e=e>=0?e:this.options.length,this.options.splice(e,0,t),this},removeItem:function(t){return t>=0&&this.options.splice(t,1),this},findIndexByHtml:function(t){for(var e=0;e<this.options.length;e++)if(n.has(this.options[e],"html")&&this.options[e].html===t)return e;return null},findItemByHtml:function(t){return this.options[this.findIndexByHtml(t)]},toString:function(){return"PopupMenu"}});r.create=function(t,e){return new r(t,e)},r.make_popupmenu=function(t,e){var o=[];return n.each(e,function(t,e){var i={html:e};null===t?i.header=!0:"function"===a.type(t)&&(i.func=t),o.push(i)}),new r(i(t),o)},r.convertLinksToOptions=function(t,e){t=i(t),e=e||"a";var n=[];return t.find(e).each(function(t,e){var a={},r=i(t);if(a.html=r.text(),r.attr("href")){var o=r.attr("href"),s=r.attr("target"),l=r.attr("confirm");a.func=function(){if(!l||confirm(l))switch(s){case"_parent":window.parent.location=o;break;case"_top":window.top.location=o;break;default:window.location=o}}}n.push(a)}),n},r.fromExistingDom=function(t,e,n){t=i(t),e=i(e);var a=r.convertLinksToOptions(e,n);return e.remove(),new r(t,a)},r.make_popup_menus=function(t,e,n){t=t||document,e=e||"div[popupmenu]",n=n||function(t,e){return"#"+t.attr("popupmenu")};var a=[];return i(t).find(e).each(function(){var e=i(this),o=i(t).find(n(e,t));a.push(r.fromDom(o,e)),o.addClass("popup")}),a},e.default=r}).call(e,i(1),i(0),i(2),i(0))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=(function(t){t&&t.__esModule}(a),t.View.extend({initialize:function(e){this.collection=new t.Collection,this.model=e&&e.model||new t.Model({onchange:null,visible:!0}).set(e),this.setElement(n(this._template())),this.$nav=this.$(".tab-navigation"),this.$content=this.$(".tab-content"),this.$el.on("click",function(){n(".tooltip").hide()}),this.render(),this.listenTo(this.model,"change",this.render,this),this.listenTo(this.collection,"add",this._add,this),this.listenTo(this.collection,"remove",this._remove,this),this.listenTo(this.collection,"change",this._change,this),this.listenTo(this.collection,"reset",this._reset,this),this.listenTo(this.collection,"add remove reset",this.render,this)},render:function(){var t=this.model.get("current");t=this.$("#"+t).length>0?t:this.first(),t&&(this.$nav.children().removeClass("active"),this.$content.children().removeClass("active"),this.$("#tab-"+t).addClass("active"),this.$("#"+t).addClass("active")),this.$el[this.model.get("visible")?"fadeIn":"fadeOut"]("fast"),this.$nav[this.size()>1?"show":"hide"]()},current:function(){return this.model.get("current")},show:function(t){t&&(this.model.set({current:t,visible:!0}),this.model.get("onchange")&&this.model.get("onchange")(t))},hide:function(){this.model.set("visible",!1)},first:function(){var t=this.collection.first();return t&&t.id},size:function(){return this.collection.length},add:function(t){this.collection.add(t)},del:function(t){this.collection.remove(t)},delAll:function(){this.collection.reset()},showTab:function(t){this.collection.get(t).set("hidden",!1)},hideTab:function(t){this.collection.get(t).set("hidden",!0)},_add:function(t){var e=this,i=t.attributes;this.$content.append(n("<div/>").attr("id",i.id).addClass("tab-pane").append(i.$el)),this.$nav.append(n(this._template_tab(i)).show().tooltip({title:i.tooltip,placement:"bottom",container:e.$el}).on("click",function(t){t.preventDefault(),e.show(i.id)})),1==this.size()&&this.show(i.id)},_remove:function(t){this.$("#tab-"+t.id).remove(),this.$("#"+t.id).remove()},_reset:function(){this.$nav.empty(),this.$content.empty()},_change:function(t){this.$("#tab-"+t.id)[t.get("hidden")?"hide":"show"]()},_template:function(){return n("<div/>").addClass("ui-tabs tabbable tabs-left").append(n("<ul/>").addClass("tab-navigation nav nav-tabs")).append(n("<div/>").addClass("tab-content"))},_template_tab:function(t){var e=n("<li/>").addClass("tab-element").attr("id","tab-"+t.id).append(n("<a/>").attr("id","tab-title-link-"+t.id)),i=e.find("a");return t.icon&&i.append(n("<i/>").addClass("tab-icon fa").addClass(t.icon)),i.append(n("<span/>").attr("id","tab-title-text-"+t.id).addClass("tab-title-text").append(t.title)),e}}));e.default={View:r}}).call(e,i(1),i(0))},function(t,e,i){var n=i(70);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(64)("52175cf9",n,!0)},function(t,e,i){e=t.exports=i(63)(void 0),e.push([t.i,".citations-formatted{word-wrap:break-word}.citations-bibtex-text{width:100%;height:500px}.citation-padding{padding:5px 10px}",""])},function(t,e){t.exports=function(t,e){for(var i=[],n={},a=0;a<e.length;a++){var r=e[a],o=r[0],s=r[1],l=r[2],d=r[3],c={id:t+":"+a,css:s,media:l,sourceMap:d};n[o]?n[o].parts.push(c):i.push(n[o]={id:o,parts:[c]})}return i}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i(66),a=function(t){return t&&t.__esModule?t:{default:t}}(n),r=i(92),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),s=i(93),l=i(17);e.default={props:{source:{type:String,required:!0},id:{type:String,required:!0},viewRender:{type:Boolean,requried:!1,default:!0}},data:function(){return{citations:[],content:"",errors:[]}},computed:{formattedReferences:function(){var t=this;return this.citations.reduce(function(e,i){return e.concat('<p class="formatted-reference">'+t.formattedReference(i)+"</p>")},"")}},created:function(){var e=this;a.default.get(Galaxy.root+"api/"+this.source+"/"+this.id+"/citations").then(function(i){e.content="";var n=!0,a=!1,r=void 0;try{for(var s,l=i.data[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var d=s.value;try{var c={fields:{},entryType:void 0},u=o.toJSON(d.content);if(u){u=t.first(u),c.entryType=u.entryType||void 0;for(var h in u.entryTags)c.fields[h.toLowerCase()]=u.entryTags[h]}e.citations.push(c),e.content+=d.content}catch(t){console.warn("Error parsing bibtex: "+t)}}}catch(t){a=!0,r=t}finally{try{!n&&l.return&&l.return()}finally{if(a)throw r}}}).catch(function(t){console.error(t)})},methods:{formattedReference:function(t){var e=t.entryType,i=t.fields,n="",a=this._asSentence((i.author?i.author:"")+(i.year?" ("+i.year+")":""))+" ",r=i.title||"",o=i.pages?"pp. "+i.pages:"",d=i.address;if("article"==e){var c=(i.volume?i.volume:"")+(i.number?" ("+i.number+")":"")+(o?", "+o:"");n=a+this._asSentence(r)+(i.journal?"In <em>"+i.journal+", ":"")+this._asSentence(c)+this._asSentence(i.address)+"</em>"}else n="inproceedings"==e||"proceedings"==e?a+this._asSentence(r)+(i.booktitle?"In <em>"+i.booktitle+", ":"")+(o||"")+(d?", "+d:"")+".</em>":"mastersthesis"==e||"phdthesis"==e?a+this._asSentence(r)+(i.howpublished?i.howpublished+". ":"")+(i.note?i.note+".":""):"techreport"==e?a+this._asSentence(r)+this._asSentence(i.institution)+this._asSentence(i.number)+this._asSentence(i.type):"book"==e||"inbook"==e||"incollection"==e?a+" "+this._formatBookInfo(i):a+" "+this._asSentence(r)+this._asSentence(i.howpublished)+this._asSentence(i.note);var u="";i.doi&&(u="http://dx.doi.org/"+i.doi,n+='[<a href="'+u+'" target="_blank">doi:'+i.doi+"</a>]");var h=i.url||u;return h&&(n+='[<a href="'+h+'" target="_blank">Link</a>]'),(0,s.convertLaTeX)({onError:function(t,e){return"{"+(0,l.stringifyLaTeX)(e)+"}"}},n)},_formatBookInfo:function(t){var e="";return t.chapter&&(e+=t.chapter+" in "),t.title&&(e+="<em>"+t.title+"</em>"),t.editor&&(e+=", Edited by "+t.editor+", "),t.publisher&&(e+=", "+t.publisher),t.pages&&(e+=", pp. "+t.pages),t.series&&(e+=", <em>"+t.series+"</em>"),t.volume&&(e+=", Vol."+t.volume),t.issn&&(e+=", ISBN: "+t.issn),e+"."},_asSentence:function(t){return t&&t.trim()?t+". ":""},toggleViewRender:function(){this.viewRender=!this.viewRender}}}}).call(e,i(2))},function(t,e,i){"use strict";function n(t){var e=new o(t),i=r(o.prototype.request,e);return a.extend(i,o.prototype,e),a.extend(i,e),i}var a=i(5),r=i(27),o=i(75),s=i(16),l=n(s);l.Axios=o,l.create=function(t){return n(a.merge(s,t))},l.Cancel=i(31),l.CancelToken=i(90),l.isCancel=i(30),l.all=function(t){return Promise.all(t)},l.spread=i(91),t.exports=l,t.exports.default=l},function(t,e){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function n(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(i(t)||n(t)||!!t._isBuffer)}},function(t,e,i){"use strict";function n(t){this.defaults=t,this.interceptors={request:new o,response:new o}}var a=i(16),r=i(5),o=i(85),s=i(86);n.prototype.request=function(t){"string"==typeof t&&(t=r.merge({url:arguments[0]},arguments[1])),t=r.merge(a,this.defaults,{method:"get"},t),t.method=t.method.toLowerCase();var e=[s,void 0],i=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)i=i.then(e.shift(),e.shift());return i},r.forEach(["delete","get","head","options"],function(t){n.prototype[t]=function(e,i){return this.request(r.merge(i||{},{method:t,url:e}))}}),r.forEach(["post","put","patch"],function(t){n.prototype[t]=function(e,i,n){return this.request(r.merge(n||{},{method:t,url:e,data:i}))}}),t.exports=n},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function a(t){if(c===setTimeout)return setTimeout(t,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function r(t){if(u===clearTimeout)return clearTimeout(t);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}function o(){_&&f&&(_=!1,f.length?p=f.concat(p):m=-1,p.length&&s())}function s(){if(!_){var t=a(o);_=!0;for(var e=p.length;e;){for(f=p,p=[];++m<e;)f&&f[m].run();m=-1,e=p.length}f=null,_=!1,r(t)}}function l(t,e){this.fun=t,this.array=e}function d(){}var c,u,h=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:i}catch(t){c=i}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(t){u=n}}();var f,p=[],_=!1,m=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];p.push(new l(t,e)),1!==p.length||_||a(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=d,h.addListener=d,h.once=d,h.off=d,h.removeListener=d,h.removeAllListeners=d,h.emit=d,h.prependListener=d,h.prependOnceListener=d,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,i){"use strict";var n=i(5);t.exports=function(t,e){n.forEach(t,function(i,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[n])})}},function(t,e,i){"use strict";var n=i(29);t.exports=function(t,e,i){var a=i.config.validateStatus;i.status&&a&&!a(i.status)?e(n("Request failed with status code "+i.status,i.config,null,i.request,i)):t(i)}},function(t,e,i){"use strict";t.exports=function(t,e,i,n,a){return t.config=e,i&&(t.code=i),t.request=n,t.response=a,t}},function(t,e,i){"use strict";function n(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var a=i(5);t.exports=function(t,e,i){if(!e)return t;var r;if(i)r=i(e);else if(a.isURLSearchParams(e))r=e.toString();else{var o=[];a.forEach(e,function(t,e){null!==t&&void 0!==t&&(a.isArray(t)&&(e+="[]"),a.isArray(t)||(t=[t]),a.forEach(t,function(t){a.isDate(t)?t=t.toISOString():a.isObject(t)&&(t=JSON.stringify(t)),o.push(n(e)+"="+n(t))}))}),r=o.join("&")}return r&&(t+=(-1===t.indexOf("?")?"?":"&")+r),t}},function(t,e,i){"use strict";var n=i(5),a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,i,r,o={};return t?(n.forEach(t.split("\n"),function(t){if(r=t.indexOf(":"),e=n.trim(t.substr(0,r)).toLowerCase(),i=n.trim(t.substr(r+1)),e){if(o[e]&&a.indexOf(e)>=0)return;o[e]="set-cookie"===e?(o[e]?o[e]:[]).concat([i]):o[e]?o[e]+", "+i:i}}),o):o}},function(t,e,i){"use strict";var n=i(5);t.exports=n.isStandardBrowserEnv()?function(){function t(t){var e=t;return i&&(a.setAttribute("href",e),e=a.href),a.setAttribute("href",e),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:"/"===a.pathname.charAt(0)?a.pathname:"/"+a.pathname}}var e,i=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");return e=t(window.location.href),function(i){var a=n.isString(i)?t(i):i;return a.protocol===e.protocol&&a.host===e.host}}():function(){return function(){return!0}}()},function(t,e,i){"use strict";function n(){this.message="String contains an invalid character"}function a(t){for(var e,i,a=String(t),o="",s=0,l=r;a.charAt(0|s)||(l="=",s%1);o+=l.charAt(63&e>>8-s%1*8)){if((i=a.charCodeAt(s+=.75))>255)throw new n;e=e<<8|i}return o}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",t.exports=a},function(t,e,i){"use strict";var n=i(5);t.exports=n.isStandardBrowserEnv()?function(){return{write:function(t,e,i,a,r,o){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),n.isString(a)&&s.push("path="+a),n.isString(r)&&s.push("domain="+r),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(t,e,i){"use strict";function n(){this.handlers=[]}var a=i(5);n.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},n.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},n.prototype.forEach=function(t){a.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=n},function(t,e,i){"use strict";function n(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var a=i(5),r=i(87),o=i(30),s=i(16),l=i(88),d=i(89);t.exports=function(t){return n(t),t.baseURL&&!l(t.url)&&(t.url=d(t.baseURL,t.url)),t.headers=t.headers||{},t.data=r(t.data,t.headers,t.transformRequest),t.headers=a.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),a.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||s.adapter)(t).then(function(e){return n(t),e.data=r(e.data,e.headers,t.transformResponse),e},function(e){return o(e)||(n(t),e&&e.response&&(e.response.data=r(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,i){"use strict";var n=i(5);t.exports=function(t,e,i){return n.forEach(i,function(i){t=i(t,e)}),t}},function(t,e,i){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,i){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,i){"use strict";function n(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var i=this;t(function(t){i.reason||(i.reason=new a(t),e(i.reason))})}var a=i(31);n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var t;return{token:new n(function(e){t=e}),cancel:t}},t.exports=n},function(t,e,i){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,i){!function(t){function e(){this.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],this.notKey=[",","{","}"," ","="],this.pos=0,this.input="",this.entries=new Array,this.currentEntry="",this.setInput=function(t){this.input=t},this.getEntries=function(){return this.entries},this.isWhitespace=function(t){return" "==t||"\r"==t||"\t"==t||"\n"==t},this.match=function(t,e){if(void 0!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)!=t)throw"Token mismatch, expected "+t+", found "+this.input.substring(this.pos);this.pos+=t.length,this.skipWhitespace(e)},this.tryMatch=function(t,e){return void 0!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)==t},this.matchAt=function(){for(;this.input.length>this.pos&&"@"!=this.input[this.pos];)this.pos++;return"@"==this.input[this.pos]},this.skipWhitespace=function(t){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]&&1==t){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace(t)}},this.value_braces=function(){var t=0;this.match("{",!1);for(var e=this.pos,i=!1;;){if(!i)if("}"==this.input[this.pos]){if(!(t>0)){var n=this.pos;return this.match("}",!1),this.input.substring(e,n)}t--}else if("{"==this.input[this.pos])t++;else if(this.pos>=this.input.length-1)throw"Unterminated value";i="\\"==this.input[this.pos]&&0==i,this.pos++}},this.value_comment=function(){for(var t="",e=0;!this.tryMatch("}",!1)||0!=e;){if(t+=this.input[this.pos],"{"==this.input[this.pos]&&e++,"}"==this.input[this.pos]&&e--,this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(start);this.pos++}return t},this.value_quotes=function(){this.match('"',!1);for(var t=this.pos,e=!1;;){if(!e){if('"'==this.input[this.pos]){var i=this.pos;return this.match('"',!1),this.input.substring(t,i)}if(this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(t)}e="\\"==this.input[this.pos]&&0==e,this.pos++}},this.single_value=function(){var t=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var e=this.key();if(e.match("^[0-9]+$"))return e;if(this.months.indexOf(e.toLowerCase())>=0)return e.toLowerCase();throw"Value expected:"+this.input.substring(t)+" for key: "+e},this.value=function(){var t=[];for(t.push(this.single_value());this.tryMatch("#");)this.match("#"),t.push(this.single_value());return t.join("")},this.key=function(t){for(var e=this.pos;;){if(this.pos>=this.input.length)throw"Runaway key";if(this.notKey.indexOf(this.input[this.pos])>=0)return t&&","!=this.input[this.pos]?(this.pos=e,null):this.input.substring(e,this.pos);this.pos++}},this.key_equals_value=function(){var t=this.key();if(this.tryMatch("=")){this.match("=");var e=this.value();return t=t.trim(),[t,e]}throw"... = value expected, equals sign missing:"+this.input.substring(this.pos)},this.key_value_list=function(){var t=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[t[0]]=t[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}"));)t=this.key_equals_value(),this.currentEntry.entryTags[t[0]]=t[1]},this.entry_body=function(t){this.currentEntry={},this.currentEntry.citationKey=this.key(!0),this.currentEntry.entryType=t.substring(1),null!=this.currentEntry.citationKey&&this.match(","),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match("@"),"@"+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType="PREAMBLE",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType="COMMENT",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(t){this.entry_body(t)},this.alernativeCitationKey=function(){this.entries.forEach(function(t){!t.citationKey&&t.entryTags&&(t.citationKey="",t.entryTags.author&&(t.citationKey+=t.entryTags.author.split(",")[0]+=", "),t.citationKey+=t.entryTags.year)})},this.bibtex=function(){for(;this.matchAt();){var t=this.directive();this.match("{"),"@STRING"==t.toUpperCase()?this.string():"@PREAMBLE"==t.toUpperCase()?this.preamble():"@COMMENT"==t.toUpperCase()?this.comment():this.entry(t),this.match("}")}this.alernativeCitationKey()}}t.toJSON=function(t){var i=new e;return i.setInput(t),i.bibtex(),i.entries},t.toBibtex=function(t){var e="";for(var i in t){if(e+="@"+t[i].entryType,e+="{",t[i].citationKey&&(e+=t[i].citationKey+", "),t[i].entry&&(e+=t[i].entry),t[i].entryTags){var n="";for(var a in t[i].entryTags)0!=n.length&&(n+=", "),n+=a+"= {"+t[i].entryTags[a]+"}";e+=n}e+="}\n\n"}return e}}(e)},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(94)),n(i(95)),n(i(32)),n(i(35)),n(i(10)),n(i(36)),n(i(136)),n(i(137)),n(i(39))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.aliases={mathfrak:"frak",mathcal:"cal",mathbb:"bb",mathbf:"bf",dfrac:"frac",ldots:"dots"}},function(t,e,i){"use strict";function n(t,e){return r(t,s.mustNotBeUndefined(s.mustBeOk(s.latexParser.parse(e)).value))}function a(t){return r({translateTo:"unicode",mode:"Any"},s.mustNotBeUndefined(s.mustBeOk(s.latexParser.parse(t)).value))}function r(t,e){var i=t.translateTo;switch(i){case"html":throw new Error("Unsupported format: '"+i+"'. Use one of: "+Object.keys(o.supportedMarkups));case"unicode":default:return l.convertLaTeXBlocksToUnicode(t,e).result}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(32),s=i(17),l=i(97);e.convertLaTeX=n,e.convertLaTeXToUnicode=a,e.convertLaTeXBlocks=r},function(t,e,i){"use strict";function n(t,e){var i=t.length,n=e.length;if(0===i)return e;if(0===n)return t;for(var a={},r=0;r<i;r++)a[t[r]]=!0;for(var o=0;o<n;o++)a[e[o]]=!0;var s=[];for(var l in a)a.hasOwnProperty(l)&&s.push(l);return s.sort(),s}function a(t,e){if(!e)return t;if(t.furthest>e.furthest)return t;var i=t.furthest===e.furthest?n(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:i}}function r(t,e,i,n){return k.Parser(function(r,o){for(var s=n,l=0,d=void 0;o<r.length;){var c=e._(r,o);if(c.status){o=$.mustBeNumber(c.index);break}var u=t._(r,o);if(y(u))return u;if(d=$.mustNotBeUndefined(a(u,d)),y(d))return d;l++;var h=$.mustNotBeUndefined(d.value);s=i(s,h),o=$.mustBeNumber(d.index)}return x(a(k.makeSuccess(o,s),d))})}function o(t,e){return r(t,e,function(t,e){return t.concat([e])},[])}function s(t){return k.Parser(function(e,i){var n=e.charAt(i);if(i>=e.length||t(n))return T.makeFailure(i,"text character");var a=[n];i++;for(var r=e.charAt(i);!t(r)&&i<e.length;)a.push(r),i++,r=e.charAt(i);return k.makeSuccess(i,a.join(""))})}function l(t){return s(c(t)).map(function(t){return S.newTeXRaw(t)})}function d(t,i){return(void 0===i?e.specialCharsDefault:i).hasOwnProperty(t)}function c(t){return function(e){return t.hasOwnProperty(e)}}function u(t,i,n){switch(void 0===i&&(i="_"),void 0===n&&(n="^"),t){case"Math":return e.latexBlockParserMathMode(i,n);default:return e.latexBlockParserTextMode}}function h(t){return t>="A"&&t<="Z"}function f(t){return t>="a"&&t<="z"}function p(t){return j.then(o(u(t,"_"),q)).map(C.newFixArg)}function _(t){return E.then(o(u(t),z)).map(C.newOptArg)}function m(t){return k.alt(p(t),_(t))}function g(t){return k.alt(k.string("{}").map(function(){return[]}),m(t).map(function(t){return t}).atLeast(0)).map(function(t){return t})}function v(t){return k.seqMap(e.commandSymbol,k.alt(e.specialChar,e.takeTill(e.endCmd)),g(t),function(t,e,i){return void 0!==i?C.newTeXComm.apply(void 0,[e].concat(i)):C.newTeXComm(e)}).map(function(t){return t})}function b(t,i,n){return k.seqMap(e.subOrSuperscriptSymbolParser(i,n),g(t),function(t,e){return C.newSubOrSuperScript(t,t===C.SubOrSuperSymbol.SUB?i:n,e)}).map(function(t){return t})}function w(t){return void 0!==t&&!0===t.status}function y(t){return void 0!==t&&!1===t.status}function x(t){if(!w(t))throw new Error("Expected parse to be success: "+JSON.stringify(t));return t}Object.defineProperty(e,"__esModule",{value:!0});var k=i(34),C=i(19),S=i(19),$=i(18),T=i(34);e.defaultParserConf={verbatimEnvironments:["verbatim"]},e.takeTill=function(t){return k.takeWhile(function(e){return!t(e)})};var M=k.regexp(/[^\n]*/),O=k.regexp(/\n?/),A=(k.regexp(/\s*/m),k.string("%")),E=k.string("["),z=k.string("]");e.notTextDefault={$:!0,"%":!0,"\\":!0,"{":!0,"]":!0,"}":!0},e.notTextMathMode={"^":!0,_:!0,$:!0,"%":!0,"\\":!0,"{":!0,"]":!0,"}":!0},e.notTextMathModeAndNotClosingBracket={"^":!0,_:!0,$:!0,"%":!0,"\\":!0,"{":!0,"}":!0},e.notTextDefaultAndNotClosingBracket={$:!0,"%":!0,"\\":!0,"{":!0,"}":!0},e.textParser=l;var R=(l(e.notTextDefault),l(e.notTextDefaultAndNotClosingBracket),k.regexp(/ */).map(S.newTeXRaw));e.comment=A.then(M).skip(O).map(C.newTeXComment),e.specialCharsDefault={"'":!0,"(":!0,")":!0,",":!0,".":!0,"-":!0,'"':!0,"!":!0,"^":!0,$:!0,"&":!0,"#":!0,"{":!0,"}":!0,"%":!0,"~":!0,"|":!0,"/":!0,":":!0,";":!0,"=":!0,"[":!0,"]":!0,"\\":!0,"`":!0," ":!0},e.isSpecialCharacter=d,e.isNotText=c,e.mathSymbol=k.string("$"),e.commandSymbol=k.string("\\"),e.latexBlockParser=u,e.latexBlockParserTextMode=k.lazy(function(){return k.alt(k.alt(l(e.notTextDefault),e.dolMath,e.comment,l(e.notTextDefaultAndNotClosingBracket),e.environment,v("Paragraph")))}),e.latexBlockParserMathMode=function(t,i){return k.lazy(function(){return k.alt(k.alt(b("Math",t,i),l(e.notTextMathMode),e.dolMath,e.comment,l(e.notTextMathModeAndNotClosingBracket),e.environment,v("Math")))})},e.latexParser=e.latexBlockParserTextMode.many();var P=k.string("{").then(e.latexBlockParserTextMode.many()).skip(k.string("}"));e.env=k.Parser(function(t,i){var n=k.string("\\begin").then(k.string("{")).then(R).then(k.regexp(/[a-zA-Z]+/)).skip(R).skip(k.string("}"))._(t,i);if(y(n))return n;i=$.mustBeNumber(n.index);var a=n.value;return o(e.latexBlockParserTextMode,k.string("\\end").then(k.string("{")).then(R).then(k.string(a)).then(R).then(k.string("}"))).map(function(t){return C.newTeXEnv(a,t)})._(t,i)}),e.environment=k.alt(P,e.env),e.specialChar=k.test(d),e.endCmd=function(t){return!f(t)&&!h(t)};var j=k.string("{"),q=k.string("}");e.fixArg=p,e.optArg=_,e.cmdArg=m,e.cmdArgs=g,e.command=v,e.subOrSuperscriptSymbolParser=function(t,e){return k.alt(k.string(t),k.string(e)).map(function(e){return e===t?C.SubOrSuperSymbol.SUB:C.SubOrSuperSymbol.SUP})},e.shiftedScript=b,e.dolMath=function(t,e,i){return void 0===t&&(t="Dollar"),void 0===e&&(e="$"),void 0===i&&(i="$"),k.string(e).then(u("Math","_").many().map(function(n){return C.newTeXMath(t,e,i,n)})).skip(k.string(i))}(),e.isOk=w,e.isNotOk=y,e.mustBeOk=x},function(t,e,i){"use strict";function n(t){return"string"==typeof t}function a(t,e){var i=t;do{t++}while(h.isTeXChar(e[t]));return{result:e.slice(i,t).map(function(t){return t.string}).join(""),blockIndex:t}}function r(t,e,i,a){var r=u(t,a);if(n(r))return{result:r,blockIndex:e+1};for(var o=[],l=[];o.length<r.argumentCount&&e<i.length-1;){e++;var d=e;if(i.length<d-1)throw new Error("Could not gobble "+r.argumentCount+" arguments for "+a.name);var c=i[d];if(h.isTeXRaw(c)){for(var f=/\s+/g,p=c.text.replace(x,""),_=-1,m=0;o.length<r.argumentCount;){var g=f.exec(p);if(!g){o.push.apply(o,y.convertToTeXCharsDefault(p));break}var v=p.substring(m,g.index);_=g.index,m=g.index+v.length,o.push.apply(o,y.convertToTeXCharsDefault(v))}_>=0&&l.push(p.substring(_))}else o.push(c)}e++;var b=o.map(function(e){return s(t,[e]).result}).map(h.newTeXRaw).map(function(t){return h.newFixArg([t])});if(b.length<r.argumentCount)throw new Error("Could not find enough arguments for command \\"+r.name+". Expected "+r.argumentCount+", but found "+b.length);var w=[r.apply(function(){},b)];return l.length>0&&w.push(l.join("")),{result:w.join(""),blockIndex:e}}function o(t){return void 0!==t&&"string"==typeof t.string&&"number"==typeof t.category}function s(t,e){var i=0;if(e.length<=0)return{result:"",blockIndex:i};for(var n=[];i<e.length;){var l=e[i];try{if(o(l)){var d=a(i,e);i=d.blockIndex,n.push(d.result)}else if(h.isTeXComm(l)){var c=r(t,i,e,l);i=c.blockIndex,n.push(c.result)}else if(h.isFixArg(l)||h.isOptArg(l)){var c=s(t,l.latex);n.push(c.result),i++}else if(h.isTextHaving(l))n.push(l.text),i++;else{if(h.isTeXMath(l))return s(t,l.latex);if(h.isTeXRaw(l))n.push(l.text),i++;else if(h.isSubOrSuperScript(l)){var u=l.arguments?l.arguments:[],c=r(t,i,e,h.newTeXComm.apply(void 0,[l.type===h.SubOrSuperSymbol.SUB?"mathsubscript":"mathsuperscript"].concat(u)));i=c.blockIndex,n.push(c.result)}else{if(!h.isArray(l))throw new Error("Can't handle LaTeX block yet: "+JSON.stringify(l)+". Leave an issue at https://github.com/digitalheir/tex-to-unicode/issues");var c=s(t,l);n.push(c.result),i++}}}catch(e){if(void 0===t.onError)throw e;var f=t.onError(e,l);if(void 0===f)throw e;n.push(f),i++}}return{result:n.join(""),blockIndex:i}}function l(t,e){if(e.arguments.length>0){var i=m.expand1argsCommand(e.name,s(t,[e.arguments[0]]).result||"");return e.arguments.length>1?i+s(t,e.arguments.slice(1)).result:i}return _.createCommandHandler(e.name,0,1,function(i,n){var a=n[0],r=n.slice(1);return m.expand1argsCommand(e.name,s(t,[a]).result)+s(t,r).result})}function d(t,e){if(e.arguments.length>1){var i=b.expand2argsCommand(e.name,s(t,[e.arguments[0]]).result||"",s(t,[e.arguments[1]]).result||"");return e.arguments.length>2?i+s(t,e.arguments.slice(1)).result:i}return _.createCommandHandler(e.name,0,2,function(i,n){var a=n[0],r=n[1],o=n.slice(2);return b.expand2argsCommand(e.name,s(t,[a]).result,s(t,[r]).result)+s(t,o).result})}function c(t,e){for(var i=void 0,n=void 0,a=0;void 0===n&&a<e.arguments.length;){var r=e.arguments[a],o=s(t,[r]).result;h.isOptArg(r)&&!i?i=o:n=o,a++}return n?v.convertSqrtToUnicode(n,i):_.createCommandHandler(e.name,1,1,function(e,i){var n=i[0],a=v.convertSqrtToUnicode(s(t,[n]).result);if(i.length>1){var r=i.slice(1);return a+s(t,r).result}return a})}function u(t,e){var i=e.name,n=p.expand0argsCommand(i);if(n)return e.arguments&&e.arguments.length>0?n+s(t,e.arguments).result:n;if(g.is1argsCommand(i))return l(t,e);if(w.is2argsCommand(i))return d(t,e);if("sqrt"===i)return c(t,e);throw f.unknownCommandError(i)}Object.defineProperty(e,"__esModule",{value:!0});var h=i(17),f=i(35),p=i(98),_=i(36),m=i(105),g=i(39),v=i(130),b=i(131),w=i(134),y=i(33),x=/^\s*/;e.isTeXChar2=o,e.convertLaTeXBlocksToUnicode=s,e.convertCommand=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(99),a=i(100),r=i(101),o=i(102),s=i(103),l=i(104);e.expand0argsCommand=function(t){for(var e=0,i=[r.barredLUnicode,n.spaceUnicode,o.slashedOUnicode,a.characterUnicode,l.specialCharacter,s.cyrillicUnicode];e<i.length;e++){var d=i[e],c=d(t);if(c)return c}}},function(t,e,i){"use strict";function n(t){return e.spaceCharactersUnicode.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.mathSpace="芇",e.spaceCharactersUnicode={",":" ",quad:" ",qquad:"  "," ":" ",space:" ",";":"　",":":"　",hfill:"\t"},e.isSpaceCharactersUnicode=n,e.spaceUnicode=function(t){return n(t)?e.spaceCharactersUnicode[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.characterUnicodeChart.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.characterUnicodeChart={leftrightsquigarrow:"↭",Longleftrightarrow:"⟺",blacktriangleright:"▶",longleftrightarrow:"⟷",blacktriangledown:"▼",blacktriangleleft:"◀",leftrightharpoons:"⇋",rightleftharpoons:"⇌",twoheadrightarrow:"↠",circlearrowright:"↻",downharpoonright:"⇂",rightharpoondown:"⇁",rightrightarrows:"⇉",twoheadleftarrow:"↞",vartriangleright:"⊳",bigtriangledown:"▽",circlearrowleft:"↺",curvearrowright:"↷",downharpoonleft:"⇃",leftharpoondown:"↽",leftrightarrows:"⇆",rightleftarrows:"⇄",rightsquigarrow:"⇝",rightthreetimes:"⋌",trianglerighteq:"⊵",vartriangleleft:"⊲",Leftrightarrow:"⇔",Longrightarrow:"⟹",curvearrowleft:"↶",dashrightarrow:"⇢",doublebarwedge:"⩞",downdownarrows:"⇊",hookrightarrow:"↪",leftleftarrows:"⇇",leftrightarrow:"↔",leftthreetimes:"⋋",longrightarrow:"⟶",looparrowright:"↬",rightarrowtail:"↣",rightharpoonup:"⇀",sphericalangle:"∢",textregistered:"®",trianglelefteq:"⊴",upharpoonright:"↾",Longleftarrow:"⟸",bigtriangleup:"△",blacktriangle:"▲",dashleftarrow:"⇠",divideontimes:"⋇",fallingdotseq:"≒",hookleftarrow:"↩",leftarrowtail:"↢",leftharpoonup:"↼",longleftarrow:"⟵",looparrowleft:"↫",measuredangle:"∡",shortparallel:"∥",smallsetminus:"∖",texttrademark:"™",triangleright:"▷",upharpoonleft:"↿",blacklozenge:"◆",risingdotseq:"≓",triangledown:"▽",triangleleft:"◁",Rrightarrow:"⇛",Updownarrow:"⇕",backepsilon:"∍",blacksquare:"■",circledcirc:"⊚",circleddash:"⊝",curlyeqprec:"⋞",curlyeqsucc:"⋟",diamondsuit:"♢",preccurlyeq:"≼",succcurlyeq:"≽",textgreater:">",thickapprox:"≈",updownarrow:"↕",vartriangle:"△",Lleftarrow:"⇚",Rightarrow:"⇒",circledast:"⊛",complement:"∁",curlywedge:"⋏",longmapsto:"⟼",registered:"®",rightarrow:"→",smallfrown:"⌢",smallsmile:"⌣",sqsubseteq:"⊑",sqsupseteq:"⊒",textlangle:"〈",textrangle:"〉",upuparrows:"⇈",varepsilon:"ε",varnothing:"∅",Downarrow:"⇓",Leftarrow:"⇐",backprime:"‵",bigotimes:"⨂",centerdot:"⋅",copyright:"©",downarrow:"↓",gtreqless:"⋛",heartsuit:"♡",leftarrow:"←",lesseqgtr:"⋚",pitchfork:"⋔",spadesuit:"♠",therefore:"∴",trademark:"™",triangleq:"≜",varpropto:"∝",approxeq:"≊",barwedge:"⊼",bigoplus:"⨁",bigsqcup:"⨆",biguplus:"⨄",bigwedge:"⋀",boxminus:"⊟",boxtimes:"⊠",circledS:"Ⓢ",clubsuit:"♣",curlyvee:"⋎",doteqdot:"≑",emptyset:"∅",intercal:"⊺",leqslant:"⩽",multimap:"⊸",parallel:"∥",setminus:"∖",sqsubset:"⊏",sqsupset:"⊐",subseteq:"⊆",supseteq:"⊇",textless:"<",thicksim:"∼",triangle:"△",varkappa:"ϰ",varsigma:"ς",vartheta:"ϑ",Diamond:"◇",Uparrow:"⇑",Upsilon:"Υ",backsim:"∽",because:"∵",between:"≬",bigodot:"⨀",bigstar:"★",boxplus:"⊞",ddagger:"‡",diamond:"⋄",digamma:"Ϝ",dotplus:"∔",epsilon:"∊",gtrless:"≷",implies:"⇒",leadsto:"↝",lessdot:"⋖",lessgtr:"≶",lesssim:"≲",lozenge:"◊",natural:"♮",nearrow:"↗",nexists:"∄",nwarrow:"↖",partial:"∂",pilcrow:"¶",precsim:"≾",searrow:"↘",section:"§",succsim:"≿",swarrow:"↙",textbar:"|",uparrow:"↑",upsilon:"υ",Bumpeq:"≎",Lambda:"Λ",Subset:"⋐",Supset:"⋑",Vvdash:"⊪",approx:"≈",bigcap:"⋂",bigcup:"⋃",bigvee:"⋁",bowtie:"⋈",boxdot:"⊡",bullet:"∙",bumpeq:"≏",circeq:"≗",coprod:"∐",dagger:"†",daleth:"ד",degree:"°",eqcirc:"≖",exists:"∃",forall:"∀",gtrdot:"⋗",gtrsim:"≳",hslash:"ℏ",lambda:"λ",lfloor:"⌊",ltimes:"⋉",mapsto:"↦",models:"⊨",ominus:"⊖",oslash:"⊘",otimes:"⊗",preceq:"⪯",propto:"∝",rfloor:"⌋",rtimes:"⋊",square:"□",subset:"⊂",succeq:"⪰",supset:"⊃",varphi:"φ",varrho:"ϱ",veebar:"⊻",Delta:"Δ",Gamma:"Γ",Omega:"Ω",Theta:"Θ",Vdash:"⊩",aleph:"ℵ",Alpha:"Α",alpha:"α",angle:"∠",asymp:"≍",cdots:"⋯",cents:"¢",dashv:"⊣",ddots:"⋱",delta:"δ",doteq:"≐",equiv:"≡",frown:"⌢",gamma:"γ",gimel:"ℷ",infty:"∞",kappa:"κ",Kappa:"Κ",lceil:"⌈",nabla:"∇",notin:"∉",omega:"ω",oplus:"⊕",pound:"£",prime:"′",qquad:"  ",rceil:"⌉",sharp:"♯",sigma:"σ",simeq:"≃",smile:"⌣",space:"␣",sqcap:"⊓",sqcup:"⊔",theta:"θ",times:"×",unlhd:"⊴",unrhd:"⊵",uplus:"⊎",vDash:"⊨",varpi:"ϖ",vdash:"⊢",vdots:"⋮",wedge:"∧",Finv:"Ⅎ",Join:"⋈",atop:"¦",beta:"β",Beta:"Β",beth:"ב",cdot:"⋅",circ:"∘",cong:"≅",dots:"…",euro:"€",flat:"♭",geqq:"≧",hbar:"ℏ",iota:"ι",leqq:"≦",odot:"⊙",oint:"∮",perp:"⊥",prec:"≺",prod:"∏",quad:" ",star:"⋆",succ:"≻",surd:"√",zeta:"ζ",Box:"□",Cap:"⋒",Cup:"⋓",Lsh:"↰",Phi:"Φ",Psi:"Ψ",Rsh:"↱",ast:"∗",bot:"⊥",cap:"∩",chi:"χ",Chi:"Χ",cup:"∪",div:"÷",ell:"ℓ",eta:"η",eth:"ð",geq:"≥",ggg:"⋙",int:"∫",leq:"≤",lhd:"⊲",lll:"⋘",mho:"℧",mid:"∣",neg:"¬",neq:"≠",phi:"ϕ",psi:"ψ",rhd:"⊳",rho:"ρ",Rho:"Ρ",sim:"∼",sum:"∑",tau:"τ",Tau:"Τ",top:"⊤",vee:"∨",Im:"ℑ",Pi:"Π",Re:"ℜ",Xi:"Ξ",ge:"≥",gg:"≫",in:"∈",le:"≤",ll:"≪",mp:"∓",mu:"μ",Mu:"Μ",ni:"∋",nu:"ν",Nu:"Ν",pi:"π",pm:"±",wp:"℘",wr:"≀",xi:"ξ",Omicron:"Ο",omicron:"ο",textdollar:"$",textquotesingle:"'",textbackslash:"\\",textasciigrave:"`",lbrace:"{",vert:"|",rbrace:"}",textasciitilde:"~",textexclamdown:"¡",textcent:"¢",textsterling:"£",textcurrency:"¤",textyen:"¥",textbrokenbar:"¦",textsection:"§",textasciidieresis:"¨",textcopyright:"©",textordfeminine:"ª",guillemotleft:"«",lnot:"¬",textasciimacron:"¯",textdegree:"°",textasciiacute:"´",textparagraph:"¶",textordmasculine:"º",guillemotright:"»",textonequarter:"¼",textonehalf:"½",textthreequarters:"¾",textquestiondown:"¿",AA:"Å",AE:"Æ",DH:"Ð",texttimes:"×",TH:"Þ",ss:"ß",aa:"å",ae:"æ",dh:"ð",th:"þ",DJ:"Đ",dj:"đ",Elzxh:"ħ",i:"ı",NG:"Ŋ",ng:"ŋ",OE:"Œ",oe:"œ",texthvlig:"ƕ",textnrleg:"ƞ",textdoublepipe:"ǂ",Elztrna:"ɐ",Elztrnsa:"ɒ",Elzopeno:"ɔ",Elzrtld:"ɖ",Elzschwa:"ə",Elzpgamma:"ɣ",Elzpbgam:"ɤ",Elztrnh:"ɥ",Elzbtdl:"ɬ",Elzrtll:"ɭ",Elztrnm:"ɯ",Elztrnmlr:"ɰ",Elzltlmr:"ɱ",Elzltln:"ɲ",Elzrtln:"ɳ",Elzclomeg:"ɷ",textphi:"ɸ",Elztrnr:"ɹ",Elztrnrl:"ɺ",Elzrttrnr:"ɻ",Elzrl:"ɼ",Elzrtlr:"ɽ",Elzfhr:"ɾ",Elzrtls:"ʂ",Elzesh:"ʃ",Elztrnt:"ʇ",Elzrtlt:"ʈ",Elzpupsil:"ʊ",Elzpscrv:"ʋ",Elzinvv:"ʌ",Elzinvw:"ʍ",Elztrny:"ʎ",Elzrtlz:"ʐ",Elzyogh:"ʒ",Elzglst:"ʔ",Elzreglst:"ʕ",Elzinglst:"ʖ",textturnk:"ʞ",Elzdyogh:"ʤ",Elztesh:"ʧ",textasciicaron:"ˇ",Elzverts:"ˈ",Elzverti:"ˌ",Elzlmrk:"ː",Elzhlmrk:"ˑ",Elzsbrhr:"˒",Elzsblhr:"˓",Elzrais:"˔",Elzlow:"˕",textasciibreve:"˘",textperiodcentered:"˙",texttildelow:"˜",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Iota:"Ι",Sigma:"Σ",texttheta:"θ",textvartheta:"ϑ",Stigma:"Ϛ",Digamma:"Ϝ",Koppa:"Ϟ",Sampi:"Ϡ",textTheta:"ϴ",textendash:"–",textemdash:"—",Vert:"‖",Elzreapos:"‛",textquotedblleft:"“",textquotedblright:"”",textdagger:"†",textdaggerdbl:"‡",textbullet:"•",ldots:"…",textperthousand:"‰",textpertenthousand:"‱",guilsinglleft:"‹",guilsinglright:"›",nolinebreak:"⁠",Elzxrat:"℞",nleftarrow:"↚",nrightarrow:"↛",arrowwaveleft:"↜",arrowwaveright:"↝",nleftrightarrow:"↮",dblarrowupdown:"⇅",nLeftarrow:"⇍",nLeftrightarrow:"⇎",nRightarrow:"⇏",DownArrowUpArrow:"⇵",rightangle:"∟",nmid:"∤",nparallel:"∦",surfintegral:"∯",volintegral:"∰",clwintegral:"∱",Colon:"∷",homothetic:"∻",lazysinv:"∾",NotEqualTilde:"≂",approxnotequal:"≆",tildetrpl:"≋",allequal:"≌",NotHumpDownHump:"≎",NotHumpEqual:"≏",estimates:"≙",starequal:"≛",lneqq:"≨",lvertneqq:"≨",gneqq:"≩",gvertneqq:"≩",NotLessLess:"≪",NotGreaterGreater:"≫",lessequivlnt:"≲",greaterequivlnt:"≳",notlessgreater:"≸",notgreaterless:"≹",precapprox:"≾",NotPrecedesTilde:"≾",succapprox:"≿",NotSucceedsTilde:"≿",subsetneq:"⊊",varsubsetneqq:"⊊",supsetneq:"⊋",varsupsetneq:"⊋",NotSquareSubset:"⊏",NotSquareSuperset:"⊐",truestate:"⊧",forcesextra:"⊨",VDash:"⊫",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",original:"⊶",image:"⊷",hermitconjmatrix:"⊹",rightanglearc:"⊾",backsimeq:"⋍",verymuchless:"⋘",verymuchgreater:"⋙",Elzsqspne:"⋥",lnsim:"⋦",gnsim:"⋧",precedesnotsimilar:"⋨",succnsim:"⋩",ntriangleleft:"⋪",ntriangleright:"⋫",ntrianglelefteq:"⋬",ntrianglerighteq:"⋭",upslopeellipsis:"⋰",downslopeellipsis:"⋱",perspcorrespond:"⌆",recorder:"⌕",ulcorner:"⌜",urcorner:"⌝",llcorner:"⌞",lrcorner:"⌟",langle:"〈",rangle:"〉",Elzdlcorn:"⎣",lmoustache:"⎰",rmoustache:"⎱",textvisiblespace:"␣",Elzdshfnc:"┆",Elzsqfnw:"┙",diagup:"╱",Elzvrecto:"▯",Elzcirfl:"◐",Elzcirfr:"◑",Elzcirfb:"◒",Elzrvbull:"◘",Elzsqfl:"◧",Elzsqfr:"◨",Elzsqfse:"◪",bigcirc:"◯",rightmoon:"☾",mercury:"☿",venus:"♀",male:"♂",jupiter:"♃",saturn:"♄",uranus:"♅",neptune:"♆",pluto:"♇",aries:"♈",taurus:"♉",gemini:"♊",cancer:"♋",leo:"♌",virgo:"♍",libra:"♎",scorpio:"♏",sagittarius:"♐",capricornus:"♑",aquarius:"♒",pisces:"♓",quarternote:"♩",eighthnote:"♪",UpArrowBar:"⤒",DownArrowBar:"⤓",Elolarr:"⥀",Elorarr:"⥁",ElzRlarr:"⥂",ElzrLarr:"⥄",Elzrarrx:"⥇",LeftRightVector:"⥎",RightUpDownVector:"⥏",DownLeftRightVector:"⥐",LeftUpDownVector:"⥑",LeftVectorBar:"⥒",RightVectorBar:"⥓",RightUpVectorBar:"⥔",RightDownVectorBar:"⥕",DownLeftVectorBar:"⥖",DownRightVectorBar:"⥗",LeftUpVectorBar:"⥘",LeftDownVectorBar:"⥙",LeftTeeVector:"⥚",RightTeeVector:"⥛",RightUpTeeVector:"⥜",RightDownTeeVector:"⥝",DownLeftTeeVector:"⥞",DownRightTeeVector:"⥟",LeftUpTeeVector:"⥠",LeftDownTeeVector:"⥡",UpEquilibrium:"⥮",ReverseUpEquilibrium:"⥯",RoundImplies:"⥰",Elztfnc:"⦀",Elroang:"⦆",Elzddfnc:"⦙",Angle:"⦜",Elzlpargt:"⦠",ElzLap:"⧊",Elzdefas:"⧋",LeftTriangleBar:"⧏",NotLeftTriangleBar:"⧏",RightTriangleBar:"⧐",NotRightTriangleBar:"⧐",RuleDelayed:"⧴",Elxuplus:"⨄",ElzThr:"⨅",Elxsqcup:"⨆",ElzInf:"⨇",ElzSup:"⨈",ElzCint:"⨍",clockoint:"⨏",sqrint:"⨖",ElzTimes:"⨯",amalg:"⨿",ElzAnd:"⩓",ElzOr:"⩔",ElOr:"⩖",Elzminhat:"⩟",Equal:"⩵",nleqslant:"⩽",geqslant:"⩾",ngeqslant:"⩾",lessapprox:"⪅",gtrapprox:"⪆",lneq:"⪇",gneq:"⪈",lnapprox:"⪉",gnapprox:"⪊",lesseqqgtr:"⪋",gtreqqless:"⪌",eqslantless:"⪕",eqslantgtr:"⪖",NestedLessLess:"⪡",NotNestedLessLess:"⪡",NestedGreaterGreater:"⪢",NotNestedGreaterGreater:"⪢",precneqq:"⪵",succneqq:"⪶",precnapprox:"⪹",succnapprox:"⪺",subseteqq:"⫅",nsubseteqq:"⫅",supseteqq:"⫆",subsetneqq:"⫋",supsetneqq:"⫌",Elztdcol:"⫶",openbracketleft:"〚",openbracketright:"〛"},e.isCharacterUnicode=n,e.characterUnicode=function(t){return n(t)?e.characterUnicodeChart[t]:void 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.barredLUnicodeChart={l:"ł",L:"Ł"},e.barredLUnicode=function(t){return e.barredLUnicodeChart[t]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.slashed_o="ø",e.slashed_O="Ø",e.slashedOUnicodeChart={o:e.slashed_o,O:e.slashed_O},e.slashedOUnicode=function(t){return e.slashedOUnicodeChart[t]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cyrillicUnicodeChart={CYRF:"Ф",CYRII:"І",CYROMEGA:"Ѡ",CYRG:"Г",cyrkvcrs:"ҝ",cyryo:"ё",CYRH:"Х",CYRZHDSC:"Җ",cyrphk:"ҧ",CYRTDSC:"Ҭ",CYRI:"И",cyryi:"ї",CYRDZHE:"Џ",cyriote:"ѥ",CYRK:"К",CYRSHHA:"Һ",CYRL:"Л",CYRM:"М",CYRCHLDSC:"Ӌ",CYRNJE:"Њ",CYRYAT:"Ѣ",CYRA:"А",CYRB:"Б",cyrchrdsc:"ҷ",cyrschwa:"ә",CYRDZE:"Ѕ",CYRIE:"Є",CYRC:"Ц",CYRZH:"Ж",CYRD:"Д",CYRABHCHDSC:"Ҿ",CYRFITA:"Ѳ",CYRE:"Е",CYRABHHA:"Ҩ",cyrya:"я",cyrdzhe:"џ",CYRIOTLYUS:"Ѩ",cyrsemisftsn:"ҍ",CYRV:"В",cyrishrt:"й",cyrdje:"ђ",cyrchldsc:"ӌ",CYRY:"Ү",cyrndsc:"ң",CYRZ:"З",CYRKHCRS:"Ҟ",CYRNG:"Ҥ",CYRCHRDSC:"Ҷ",CYRYHCRS:"Ұ",CYRSHCH:"Щ",CYRUSHRT:"Ў",cyryu:"ю",cyrksi:"ѯ",CYRN:"Н",CYRO:"О",CYRBYUS:"Ѫ",CYRP:"П",CYRZDSC:"Ҙ",CYRAE:"Ӕ",CYRR:"Р",CYRS:"С",CYRT:"Т",CYRABHCH:"Ҽ",cyruk:"ѹ",CYRU:"У",cyrii:"і",CYRSEMISFTSN:"Ҍ",cyrghcrs:"ғ",CYRISHRT:"Й",cyromegatitlo:"ѽ",cyrkbeak:"ҡ",cyrie:"є",cyrzdsc:"ҙ",CYRNDSC:"Ң",CYRGUP:"Ґ",cyrshch:"щ",CYRKHK:"Ӄ",cyrzh:"ж",CYRJE:"Ј",cyrthousands:"҂",cyrabhch:"ҽ",textnumero:"№",cyrng:"ҥ",CYRPSI:"Ѱ",CYRTETSE:"Ҵ",CYRIOTBYUS:"Ѭ",cyrnje:"њ",CYRIOTE:"Ѥ",cyrdze:"ѕ",cyrae:"ӕ",CYRHRDSN:"Ъ",CYRKOPPA:"Ҁ",CYRRTICK:"Ҏ",CYRSCHWA:"Ә",cyrtdsc:"ҭ",CYRGHK:"Ҕ",cyrabhha:"ҩ",cyrshha:"һ",CYRSH:"Ш",cyru:"у",cyrkhcrs:"ҟ",cyrt:"т",CYRERY:"Ы",cyrs:"с",cyrr:"р",CYROT:"Ѿ",cyrlyus:"ѧ",CYRNHK:"Ӈ",CYRSFTSN:"Ь",cyrghk:"ҕ",cyrp:"п",cyrabhdze:"ӡ",cyro:"о",CYRTSHE:"Ћ",cyrn:"н",CYRSDSC:"Ҫ",cyryhcrs:"ұ",cyrpsi:"ѱ",cyrz:"з",cyry:"ү",cyrje:"ј",cyrv:"в",cyrchvcrs:"ҹ",cyrkhk:"ӄ",cyre:"е",cyromega:"ѡ",cyrd:"д",cyrc:"ц",cyrb:"б",CYROTLD:"Ө",cyrgup:"ґ",CYRLJE:"Љ",cyra:"а",CYROMEGATITLO:"Ѽ",CYRGHCRS:"Ғ",CYRCHVCRS:"Ҹ",cyrm:"м",cyrl:"л",cyrsh:"ш",cyrk:"к",cyri:"и",cyrh:"х",CYRHDSC:"Ҳ",CYRIZH:"Ѵ",CYRABHDZE:"Ӡ",cyrkdsc:"қ",cyrg:"г",CYRCH:"Ч",cyrf:"ф",CYRYI:"Ї",cyrmillions:"҉",CYRKSI:"Ѯ",CYROMEGARND:"Ѻ",cyrot:"ѿ",cyrtetse:"ҵ",cyrhdsc:"ҳ",cyrushrt:"ў",cyriotlyus:"ѩ",CYRYA:"Я",cyrlje:"љ",cyrotld:"ө",CYRKDSC:"Қ",cyrhrdsn:"ъ",cyrrtick:"ҏ",cyrkoppa:"ҁ",CYRDJE:"Ђ",cyriotbyus:"ѭ",cyrhundredthousands:"҈",CYRpalochka:"Ӏ",CYRKVCRS:"Ҝ",cyromegarnd:"ѻ",cyrsftsn:"ь",cyrabhchdsc:"ҿ",cyrzhdsc:"җ",cyrerev:"э",CYRLYUS:"Ѧ",CYRKBEAK:"Ҡ",cyrery:"ы",CYREREV:"Э",cyrnhk:"ӈ",cyrsdsc:"ҫ",cyrch:"ч",cyrtshe:"ћ",CYRPHK:"Ҧ",CYRYO:"Ё",CYRYU:"Ю",CYRUK:"Ѹ"},e.cyrillicUnicode=function(t){return e.cyrillicUnicodeChart[t]}},function(t,e,i){"use strict";function n(t){return e.specialCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.specialCharacters={i:"ı",j:"ȷ",oe:"œ",OE:"Œ",ae:"æ",AE:"Æ",aa:"å",AA:"Å",o:"ø",O:"Ø",ss:"ß",l:"ł",L:"Ł"},e.isSpecialCharacter=n,e.specialCharacter=function(t){return n(t)?e.specialCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t,e){switch(t){case"cyrchar":var i=o.translateCharToCyrillic(e);if(i)return i;break;default:for(var n=0,s=[a.diacriticUnicode,r.formattingUnicode];n<s.length;n++){var l=s[n],d=l(t,e);if(d)return d}}throw new Error("No implementation found to expand \\"+t+" with argument {"+e+"}")}Object.defineProperty(e,"__esModule",{value:!0});var a=i(106),r=i(118),o=i(127);e.expand1argsCommand=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(107),a=i(108),r=i(109),o=i(110),s=i(111),l=i(112),d=i(113),c=i(114),u=i(10),h=i(115),f=i(116),p=i(117);e.barUnderLetter=u.simpleSuffix("̱"),e.dotUnderLetter=u.simpleSuffix("̣"),e.breve=u.simpleSuffix("̆"),e.macrron=u.simpleSuffix("̄"),e.dotOverLetter=u.simpleSuffix("̇"),e.longHungarianUmlaut=u.simpleSuffix("̋"),e.modifiersTextModeUnicodeChart={"`":r.graveAccent,"'":a.acuteAccent,"^":o.circumflex,"~":s.tilde,"=":e.macrron,".":e.dotOverLetter,'"':l.dieresis,H:e.longHungarianUmlaut,c:d.cedilla,k:h.ogonek,b:e.barUnderLetter,d:e.dotUnderLetter,r:n.ringOverLetter,u:e.breve,v:c.caron,t:f.tieLetters},e.modifiersMathModeUnicodeChart={check:c.caron,acute:a.acuteAccent,grave:a.acuteAccent,breve:e.breve,vec:p.vectorArrow,mathring:n.ringOverLetter},e.diacriticUnicode=function(t,i){var n=e.modifiersTextModeUnicodeChart[t];return n||(n=e.modifiersMathModeUnicodeChart[t]),n&&n(i)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.ringOverLetter=n.lookupOrAppend({a:"å",A:"Å",y:"ẙ"},"̊")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.acuteAccent=n.lookupOrAppend({e:"é",y:"ý",u:"ú",i:"í",o:"ó",a:"á",E:"É",Y:"Ý",U:"Ú",I:"Í",O:"Ó",A:"Á",cyrk:"ќ",cyrg:"ѓ",CYRK:"Ќ",CYRG:"Ѓ"},"́")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.graveAccent=n.lookupOrAppend({e:"è",u:"ù",i:"ì",o:"ò",a:"à",E:"È",U:"Ù",I:"Ì",O:"Ò",A:"À"},"̀")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.circumflex=n.lookupOrAppend({e:"ê",u:"û",i:"î",o:"ô",a:"â",E:"Ê",U:"Û",I:"Î",O:"Ô",A:"Â"},"̂")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.tilde=n.lookupOrAppend({o:"õ",a:"ã",n:"ñ",O:"Õ",A:"Ã",N:"Ñ"},"̃")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.dieresis=n.lookupOrAppend({e:"ë",y:"ÿ",u:"ü",i:"ï",o:"ö",a:"ä",E:"Ë",Y:"Ÿ",U:"Ü",I:"Ï",O:"Ö",A:"Ä"},"̈")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.cedilla=n.lookupOrAppend({c:"ç"},"̧")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.caron=n.lookupOrAppend({s:"š"},"̌")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(10);e.ogonek=n.simpleSuffix("̨")},function(t,e,i){"use strict";function n(t){return a(t.charAt(0),t.substring(1))}function a(t,e){return t+"͡"+e}function r(t){return"t"===t}Object.defineProperty(e,"__esModule",{value:!0}),e.tieLetters=n,e.tie2Letters=a,e.isTieLetters=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.vectorArrow=n.lookupOrAppend({},"⃗")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(119),a=i(120),r=i(121),o=i(122),s=i(123),l=i(124),d=i(37),c=i(125),u=i(38),h=i(126);e.formattingUnicode=function(t,e){var i=void 0;if(d.isBbCmd(t)?i=n.translateCharToBlackboard:d.isBfCmd(t)?i=a.translateCharToBold:d.isFrakCmd(t)?i=r.translateCharToFraktur:d.isItCmd(t)?i=o.translateCharToItalic:d.isTtCmd(t)?i=s.translateCharToMonospace:d.isCalCmd(t)?i=l.translateCharToCalligraphic:d.isSubCmd(t)?i=c.translateCharToSubscript:d.isSupCmd(t)?i=u.translateCharToSuperscript:d.isMonoCmd(t)&&(i=h.translateCharToMono),i){var f=i;return e.split("").map(function(t){return f(t)||t}).join("")}}},function(t,e,i){"use strict";function n(t){return e.blackboardCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.blackboardCharacters={A:"𝔸",B:"𝔹",C:"ℂ",D:"𝔻",E:"𝔼",F:"𝔽",G:"𝔾",H:"ℍ",I:"𝕀",J:"𝕁",K:"𝕂",L:"𝕃",M:"𝕄",N:"ℕ",O:"𝕆",P:"ℙ",Q:"ℚ",R:"ℝ",S:"𝕊",T:"𝕋",U:"𝕌",V:"𝕍",W:"𝕎",X:"𝕏",Y:"𝕐",Z:"ℤ",a:"𝕒",b:"𝕓",c:"𝕔",d:"𝕕",e:"𝕖",f:"𝕗",g:"𝕘",h:"𝕙",i:"𝕚",j:"𝕛",k:"𝕜",l:"𝕝",m:"𝕞",n:"𝕟",o:"𝕠",p:"𝕡",q:"𝕢",r:"𝕣",s:"𝕤",t:"𝕥",u:"𝕦",v:"𝕧",w:"𝕨",x:"𝕩",y:"𝕪",z:"𝕫",0:"𝟘",1:"𝟙",2:"𝟚",3:"𝟛",4:"𝟜",5:"𝟝",6:"𝟞",7:"𝟟",8:"𝟠",9:"𝟡"},e.isBlackboardCharacter=n,e.translateCharToBlackboard=function(t){return n(t)?e.blackboardCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.boldCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.boldCharacters={A:"𝐀",B:"𝐁",C:"𝐂",D:"𝐃",E:"𝐄",F:"𝐅",G:"𝐆",H:"𝐇",I:"𝐈",J:"𝐉",K:"𝐊",L:"𝐋",M:"𝐌",N:"𝐍",O:"𝐎",P:"𝐏",Q:"𝐐",R:"𝐑",S:"𝐒",T:"𝐓",U:"𝐔",V:"𝐕",W:"𝐖",X:"𝐗",Y:"𝐘",Z:"𝐙",a:"𝐚",b:"𝐛",c:"𝐜",d:"𝐝",e:"𝐞",f:"𝐟",g:"𝐠",h:"𝐡",i:"𝐢",j:"𝐣",k:"𝐤",l:"𝐥",m:"𝐦",n:"𝐧",o:"𝐨",p:"𝐩",q:"𝐪",r:"𝐫",s:"𝐬",t:"𝐭",u:"𝐮",v:"𝐯",w:"𝐰",x:"𝐱",y:"𝐲",z:"𝐳","Α":"𝚨","Β":"𝚩","Γ":"𝚪","Δ":"𝚫","Ε":"𝚬","Ζ":"𝚭","Η":"𝚮","Θ":"𝚯","Ι":"𝚰","Κ":"𝚱","Λ":"𝚲","Μ":"𝚳","Ν":"𝚴","Ξ":"𝚵","Ο":"𝚶","Π":"𝚷","Ρ":"𝚸","ϴ":"𝚹","Σ":"𝚺","Τ":"𝚻","Υ":"𝚼","Φ":"𝚽","Χ":"𝚾","Ψ":"𝚿","Ω":"𝛀","∇":"𝛁","α":"𝛂","β":"𝛃","γ":"𝛄","δ":"𝛅","ε":"𝛆","ζ":"𝛇","η":"𝛈","θ":"𝛉","ι":"𝛊","κ":"𝛋","λ":"𝛌","μ":"𝛍","ν":"𝛎","ξ":"𝛏","ο":"𝛐","π":"𝛑","ρ":"𝛒","ς":"𝛓","σ":"𝛔","τ":"𝛕","υ":"𝛖","φ":"𝛗","χ":"𝛘","ψ":"𝛙","ω":"𝛚","∂":"𝛛","ϵ":"𝛜","ϑ":"𝛝","ϰ":"𝛞","ϕ":"𝛟","ϱ":"𝛠","ϖ":"𝛡",0:"𝟎",1:"𝟏",2:"𝟐",3:"𝟑",4:"𝟒",5:"𝟓",6:"𝟔",7:"𝟕",8:"𝟖",9:"𝟗"},e.isBlackboardCharacter=n,e.translateCharToBold=function(t){return n(t)?e.boldCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.frakturCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.frakturCharacters={A:"𝔄",B:"𝔅",C:"ℭ",D:"𝔇",E:"𝔈",F:"𝔉",G:"𝔊",H:"ℌ",I:"ℑ",J:"𝔍",K:"𝔎",L:"𝔏",M:"𝔐",N:"𝔑",O:"𝔒",P:"𝔓",Q:"𝔔",R:"ℜ",S:"𝔖",T:"𝔗",U:"𝔘",V:"𝔙",W:"𝔚",X:"𝔛",Y:"𝔜",Z:"ℨ",a:"𝔞",b:"𝔟",c:"𝔠",d:"𝔡",e:"𝔢",f:"𝔣",g:"𝔤",h:"𝔥",i:"𝔦",j:"𝔧",k:"𝔨",l:"𝔩",m:"𝔪",n:"𝔫",o:"𝔬",p:"𝔭",q:"𝔮",r:"𝔯",s:"𝔰",t:"𝔱",u:"𝔲",v:"𝔳",w:"𝔴",x:"𝔵",y:"𝔶",z:"𝔷"},e.isFrakturCharacter=n,e.translateCharToFraktur=function(t){return n(t)?e.frakturCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.italicCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.italicCharacters={A:"𝐴",B:"𝐵",C:"𝐶",D:"𝐷",E:"𝐸",F:"𝐹",G:"𝐺",H:"𝐻",I:"𝐼",J:"𝐽",K:"𝐾",L:"𝐿",M:"𝑀",N:"𝑁",O:"𝑂",P:"𝑃",Q:"𝑄",R:"𝑅",S:"𝑆",T:"𝑇",U:"𝑈",V:"𝑉",W:"𝑊",X:"𝑋",Y:"𝑌",Z:"𝑍",a:"𝑎",b:"𝑏",c:"𝑐",d:"𝑑",e:"𝑒",f:"𝑓",g:"𝑔",h:"ℎ",i:"𝑖",j:"𝑗",k:"𝑘",l:"𝑙",m:"𝑚",n:"𝑛",o:"𝑜",p:"𝑝",q:"𝑞",r:"𝑟",s:"𝑠",t:"𝑡",u:"𝑢",v:"𝑣",w:"𝑤",x:"𝑥",y:"𝑦",z:"𝑧","Α":"𝛢","Β":"𝛣","Γ":"𝛤","Δ":"𝛥","Ε":"𝛦","Ζ":"𝛧","Η":"𝛨","Θ":"𝛩","Ι":"𝛪","Κ":"𝛫","Λ":"𝛬","Μ":"𝛭","Ν":"𝛮","Ξ":"𝛯","Ο":"𝛰","Π":"𝛱","Ρ":"𝛲","ϴ":"𝛳","Σ":"𝛴","Τ":"𝛵","Υ":"𝛶","Φ":"𝛷","Χ":"𝛸","Ψ":"𝛹","Ω":"𝛺","∇":"𝛻","α":"𝛼","β":"𝛽","γ":"𝛾","δ":"𝛿","ε":"𝜀","ζ":"𝜁","η":"𝜂","θ":"𝜃","ι":"𝜄","κ":"𝜅","λ":"𝜆","μ":"𝜇","ν":"𝜈","ξ":"𝜉","ο":"𝜊","π":"𝜋","ρ":"𝜌","ς":"𝜍","σ":"𝜎","τ":"𝜏","υ":"𝜐","φ":"𝜑","χ":"𝜒","ψ":"𝜓","ω":"𝜔","∂":"𝜕","ϵ":"𝜖","ϑ":"𝜗","ϰ":"𝜘","ϕ":"𝜙","ϱ":"𝜚","ϖ":"𝜛"},e.isItalicCharacter=n,e.translateCharToItalic=function(t){return n(t)?e.italicCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.monospaceCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.monospaceCharacters={A:"𝙰",B:"𝙱",C:"𝙲",D:"𝙳",E:"𝙴",F:"𝙵",G:"𝙶",H:"𝙷",I:"𝙸",J:"𝙹",K:"𝙺",L:"𝙻",M:"𝙼",N:"𝙽",O:"𝙾",P:"𝙿",Q:"𝚀",R:"𝚁",S:"𝚂",T:"𝚃",U:"𝚄",V:"𝚅",W:"𝚆",X:"𝚇",Y:"𝚈",Z:"𝚉",a:"𝚊",b:"𝚋",c:"𝚌",d:"𝚍",e:"𝚎",f:"𝚏",g:"𝚐",h:"𝚑",i:"𝚒",j:"𝚓",k:"𝚔",l:"𝚕",m:"𝚖",n:"𝚗",o:"𝚘",p:"𝚙",q:"𝚚",r:"𝚛",s:"𝚜",t:"𝚝",u:"𝚞",v:"𝚟",w:"𝚠",x:"𝚡",y:"𝚢",z:"𝚣",0:"𝟶",1:"𝟷",2:"𝟸",3:"𝟹",4:"𝟺",5:"𝟻",6:"𝟼",7:"𝟽",8:"𝟾",9:"𝟿"},e.isMonospaceCharacter=n,e.translateCharToMonospace=function(t){return n(t)?e.monospaceCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.calligraphicLetters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.calligraphicLetters={A:"𝓐",B:"𝓑",C:"𝓒",D:"𝓓",E:"𝓔",F:"𝓕",G:"𝓖",H:"𝓗",I:"𝓘",J:"𝓙",K:"𝓚",L:"𝓛",M:"𝓜",N:"𝓝",O:"𝓞",P:"𝓟",Q:"𝓠",R:"𝓡",S:"𝓢",T:"𝓣",U:"𝓤",V:"𝓥",W:"𝓦",X:"𝓧",Y:"𝓨",Z:"𝓩",a:"𝓪",b:"𝓫",c:"𝓬",d:"𝓭",e:"𝓮",f:"𝓯",g:"𝓰",h:"𝓱",i:"𝓲",j:"𝓳",k:"𝓴",l:"𝓵",m:"𝓶",n:"𝓷",o:"𝓸",p:"𝓹",q:"𝓺",r:"𝓻",s:"𝓼",t:"𝓽",u:"𝓾",v:"𝓿",w:"𝔀",x:"𝔁",y:"𝔂",z:"𝔃"},e.isCalligraphicLetter=n,e.translateCharToCalligraphic=function(t){return n(t)?e.calligraphicLetters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.subscriptCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.subscriptCharacters={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉","+":"₊","-":"₋","=":"₌","(":"₍",")":"₎",a:"ₐ",e:"ₑ",h:"ₕ",i:"ᵢ",j:"ⱼ",k:"ₖ",l:"ₗ",m:"ₘ",n:"ₙ",o:"ₒ",p:"ₚ",r:"ᵣ",s:"ₛ",t:"ₜ",u:"ᵤ",v:"ᵥ",x:"ₓ","β":"ᵦ","γ":"ᵧ","ρ":"ᵨ","φ":"ᵩ","χ":"ᵪ"},e.isSubscriptCharacter=n,e.translateCharToSubscript=function(t){return n(t)?e.subscriptCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.monoCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.monoCharacters={A:"𝙰",B:"𝙱",C:"𝙲",D:"𝙳",E:"𝙴",F:"𝙵",G:"𝙶",H:"𝙷",I:"𝙸",J:"𝙹",K:"𝙺",L:"𝙻",M:"𝙼",N:"𝙽",O:"𝙾",P:"𝙿",Q:"𝚀",R:"𝚁",S:"𝚂",T:"𝚃",U:"𝚄",V:"𝚅",W:"𝚆",X:"𝚇",Y:"𝚈",Z:"𝚉",a:"𝚊",b:"𝚋",c:"𝚌",d:"𝚍",e:"𝚎",f:"𝚏",g:"𝚐",h:"𝚑",i:"𝚒",j:"𝚓",k:"𝚔",l:"𝚕",m:"𝚖",n:"𝚗",o:"𝚘",p:"𝚙",q:"𝚚",r:"𝚛",s:"𝚜",t:"𝚝",u:"𝚞",v:"𝚟",w:"𝚠",x:"𝚡",y:"𝚢",z:"𝚣",0:"𝟶",1:"𝟷",2:"𝟸",3:"𝟹",4:"𝟺",5:"𝟻",6:"𝟼",7:"𝟽",8:"𝟾",9:"𝟿"},e.isMonoCharacter=n,e.translateCharToMono=function(t){return n(t)?e.monoCharacters[t]:void 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cyrillicCharacters={"Ф":"Ф","І":"І","Ѡ":"Ѡ","Г":"Г","ҝ":"ҝ","ё":"ё","Х":"Х","Җ":"Җ","ҧ":"ҧ","Ҭ":"Ҭ","И":"И","ї":"ї","Џ":"Џ","ѥ":"ѥ","К":"К","Һ":"Һ","Л":"Л","М":"М","Ӌ":"Ӌ","Њ":"Њ","Ѣ":"Ѣ","А":"А","Б":"Б","ҷ":"ҷ","ә":"ә","Ѕ":"Ѕ","Є":"Є","Ц":"Ц","Ж":"Ж","Д":"Д","Ҿ":"Ҿ","Ѳ":"Ѳ","Е":"Е","Ҩ":"Ҩ","я":"я","џ":"џ","Ѩ":"Ѩ","ҍ":"ҍ","В":"В","й":"й","ђ":"ђ","ӌ":"ӌ","Ү":"Ү","ң":"ң","З":"З","Ҟ":"Ҟ","Ҥ":"Ҥ","Ҷ":"Ҷ","Ұ":"Ұ","Щ":"Щ","Ў":"Ў","ю":"ю","ѯ":"ѯ","Н":"Н","О":"О","Ѫ":"Ѫ","П":"П","Ҙ":"Ҙ","Ӕ":"Ӕ","Р":"Р","С":"С","Т":"Т","Ҽ":"Ҽ","ѹ":"ѹ","У":"У","і":"і","Ҍ":"Ҍ","ғ":"ғ","Й":"Й","ѽ":"ѽ","ҡ":"ҡ","є":"є","ҙ":"ҙ","Ң":"Ң","Ґ":"Ґ","щ":"щ","Ӄ":"Ӄ","ж":"ж","Ј":"Ј","҂":"҂","ҽ":"ҽ","№":"№","ҥ":"ҥ","Ѱ":"Ѱ","Ҵ":"Ҵ","Ѭ":"Ѭ","њ":"њ","Ѥ":"Ѥ","ѕ":"ѕ","ӕ":"ӕ","Ъ":"Ъ","Ҁ":"Ҁ","Ҏ":"Ҏ","Ә":"Ә","ҭ":"ҭ","Ҕ":"Ҕ","ҩ":"ҩ","һ":"һ","Ш":"Ш","у":"у","ҟ":"ҟ","т":"т","Ы":"Ы","с":"с","р":"р","Ѿ":"Ѿ","ѧ":"ѧ","Ӈ":"Ӈ","Ь":"Ь","ҕ":"ҕ","п":"п","ӡ":"ӡ","о":"о","Ћ":"Ћ","н":"н","Ҫ":"Ҫ","ұ":"ұ","ѱ":"ѱ","з":"з","ү":"ү","̏":"̏","ј":"ј","в":"в","ҹ":"ҹ","ӄ":"ӄ","е":"е","ѡ":"ѡ","д":"д","ц":"ц","б":"б","Ө":"Ө","ґ":"ґ","Љ":"Љ","а":"а","Ѽ":"Ѽ","Ғ":"Ғ","Ҹ":"Ҹ","м":"м","л":"л","ш":"ш","к":"к","и":"и","х":"х","Ҳ":"Ҳ","Ѵ":"Ѵ","Ӡ":"Ӡ","қ":"қ","г":"г","Ч":"Ч","ф":"ф","Ї":"Ї","҉":"҉","Ѯ":"Ѯ","Ѻ":"Ѻ","ѿ":"ѿ","ҵ":"ҵ","ҳ":"ҳ","ў":"ў","ѩ":"ѩ","Я":"Я","љ":"љ","ө":"ө","Қ":"Қ","ъ":"ъ","ҏ":"ҏ","ҁ":"ҁ","Ђ":"Ђ","ѭ":"ѭ","҈":"҈","Ӏ":"Ӏ","Ҝ":"Ҝ","ѻ":"ѻ","ь":"ь","ҿ":"ҿ","җ":"җ","э":"э","Ѧ":"Ѧ","Ҡ":"Ҡ","ы":"ы","Э":"Э","ӈ":"ӈ","ҫ":"ҫ","ч":"ч","ћ":"ћ","Ҧ":"Ҧ","Ё":"Ё","Ю":"Ю","Ѹ":"Ѹ","ќ":"ќ","ѓ":"ѓ","Ќ":"Ќ","Ѓ":"Ѓ"},e.isCyrillicCharacter=function(t){return e.cyrillicCharacters.hasOwnProperty(t)},e.translateCharToCyrillic=function(t){return e.isCyrillicCharacter(t)?e.cyrillicCharacters[t]:void 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.spaceCmds1arg={kern:!0,hskip:!0,hspace:!0,hphantom:!0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.diacriticsTextMode={"`":!0,"'":!0,"^":!0,"~":!0,"=":!0,".":!0,'"':!0,H:!0,c:!0,k:!0,b:!0,d:!0,r:!0,u:!0,v:!0},e.diacriticsMathMode={hat:!0,widehat:!0,check:!0,tilde:!0,widetilde:!0,acute:!0,grave:!0,dot:!0,ddot:!0,breve:!0,bar:!0,vec:!0,mathring:!0}},function(t,e,i){"use strict";function n(t){var e=t?t.trim():void 0;if(!e)return"√";switch(e){case"2":return"√";case"3":return"∛";case"4":return"∜";default:for(var i=[],n=0;n<e.length;n++){var a=r.translateCharToSuperscript(e.charAt(n));if(!a)throw new Error('Could not translate "'+a+'" to superscript');i.push(a)}return i.join("")+"√"}}function a(t,e){var i=n(e),a=t.trim();return""===a?i:i+"("+a+")"}Object.defineProperty(e,"__esModule",{value:!0});var r=i(38);e.convertSqrtToUnicode=a},function(t,e,i){"use strict";function n(t,e,i){switch(t){case"frac":case"nfrac":case"cfrac":case"xfrac":case"sfrac":return a.convertFracToUnicode(e,i);case"binom":return r.convertBinom(e,i)}throw new Error("No implementation found to expand \\"+t+" with arguments {"+e+", "+i)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(132),r=i(133);e.expand2argsCommand=n},function(t,e,i){"use strict";function n(t,e){return"1"===t&&"2"===e?"½":"1"===t&&"3"===e?"⅓":"1"===t&&"4"===e?"¼":"1"===t&&"5"===e?"⅕":"1"===t&&"6"===e?"⅙":"1"===t&&"8"===e?"⅛":"2"===t&&"3"===e?"⅔":"2"===t&&"5"===e?"⅖":"3"===t&&"4"===e?"¾":"3"===t&&"5"===e?"⅗":"3"===t&&"8"===e?"⅜":"4"===t&&"5"===e?"⅘":"5"===t&&"6"===e?"⅚":"5"===t&&"8"===e?"⅝":"7"===t&&"8"===e?"⅞":o.test(t)&&o.test(e)?r+t+"⁄"+e+r:(t=a.isSingleTerm.test(t)?t:a.addParenthesis(t),e=a.isSingleTerm.test(e)?e:a.addParenthesis(e),"("+t+" / "+e+")")}Object.defineProperty(e,"__esModule",{value:!0});var a=i(10),r="‌",o=/^[0-9]*$/;e.convertFracToUnicode=n},function(t,e,i){"use strict";function n(t,e){return t=r.test(t)?t:a.addParenthesis(t),e=r.test(e)?e:a.addParenthesis(e),"("+t+" ¦ "+e+")"}Object.defineProperty(e,"__esModule",{value:!0});var a=i(10),r=/^.$|^[0-9]+$/;e.convertBinom=n},function(t,e,i){"use strict";function n(t){return e.twoArgsCommands.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(135);e.twoArgsCommands=Object.assign({},a.fracCmds,{binom:!0}),e.is2argsCommand=n},function(t,e,i){"use strict";function n(t){return e.fracCmds.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.fracCmds={frac:!0,nfrac:!0,cfrac:!0,xfrac:!0,sfrac:!0},e.isFracCmd=n},function(t,e,i){"use strict";function n(t){return{name:t,optionalArguments:0,argumentCount:0}}Object.defineProperty(e,"__esModule",{value:!0}),e.createKnownCommand=n},function(t,e,i){"use strict";function n(t){return{name:t,optionalArguments:0,argumentCount:1}}Object.defineProperty(e,"__esModule",{value:!0}),e.createKnownCommandWith1Arg=n},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolForm"},[i("div",{staticClass:"toolFormTitle"},[t._v("\n        Citations\n        "),t.viewRender?i("button",{staticClass:"btn btn-xs",attrs:{type:"button",title:"Show all in BibTeX format."},on:{click:t.toggleViewRender}},[i("i",{staticClass:"fa fa-pencil-square-o"}),t._v("\n            Show BibTeX\n        ")]):i("button",{staticClass:"btn btn-xs",attrs:{type:"button",title:"Return to formatted citation list."},on:{click:t.toggleViewRender}},[i("i",{staticClass:"fa fa-times"}),t._v("\n            Hide BibTeX\n        ")])]),t._v(" "),i("div",{staticClass:"citations-bibtex toolFormBody citation-padding"},["histories"===t.source?i("div",{staticClass:"infomessage"},[t._v("\n            When writing up your analysis, remember to include all references that should be cited in order\n            to completely describe your work. Also, please remember to "),i("a",{attrs:{href:"https://galaxyproject.org/citing-galaxy"}},[t._v("cite Galaxy")]),t._v(".\n        ")]):t._e(),t._v(" "),t.viewRender?i("span",{staticClass:"citations-formatted"},[i("p",{domProps:{innerHTML:t._s(t.formattedReferences)}})]):i("textarea",{staticClass:"citations-bibtex-text"},[t._v("            "+t._s(t.content)+"\n        ")])])])},a=[],r={render:n,staticRenderFns:a};e.a=r},,function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),s=i(14),l=a(s),d=i(15),c=a(d),u=i(141),h=(a(u),{hidden:!1,show:function(){this.set("hidden",!1)},hide:function(){this.set("hidden",!0)},toggle:function(){this.set("hidden",!this.get("hidden"))},is_visible:function(){return!this.attributes.hidden}}),f=t.Model.extend({defaults:{name:null,label:null,type:null,value:null,html:null,num_samples:5},initialize:function(t){this.attributes.html=unescape(this.attributes.html)},copy:function(){return new f(this.toJSON())},set_value:function(t){this.set("value",t||"")}}),p=t.Collection.extend({model:f}),_=f.extend({}),m=f.extend({set_value:function(t){this.set("value",parseInt(t,10))},get_samples:function(){return d3.scale.linear().domain([this.get("min"),this.get("max")]).ticks(this.get("num_samples"))}}),g=m.extend({set_value:function(t){this.set("value",parseFloat(t))}}),v=f.extend({get_samples:function(){return o.map(this.get("options"),function(t){return t[0]})}});f.subModelTypes={integer:m,float:g,data:_,select:v};var b=t.Model.extend({defaults:{id:null,name:null,description:null,target:null,inputs:[],outputs:[]},urlRoot:Galaxy.root+"api/tools",initialize:function(t){this.set("inputs",new p(o.map(t.inputs,function(t){return new(f.subModelTypes[t.type]||f)(t)})))},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e.inputs=this.get("inputs").map(function(t){return t.toJSON()}),e},remove_inputs:function(t){var e=this,i=e.get("inputs").filter(function(e){return-1!==t.indexOf(e.get("type"))});e.get("inputs").remove(i)},copy:function(e){var i=new b(this.toJSON());if(e){var n=new t.Collection;i.get("inputs").each(function(t){t.get_samples()&&n.push(t)}),i.set("inputs",n)}return i},apply_search_results:function(t){return-1!==o.indexOf(t,this.attributes.id)?this.show():this.hide(),this.is_visible()},set_input_value:function(t,e){this.get("inputs").find(function(e){return e.get("name")===t}).set("value",e)},set_input_values:function(t){var e=this;o.each(o.keys(t),function(i){e.set_input_value(i,t[i])})},run:function(){return this._run()},rerun:function(t,e){return this._run({action:"rerun",target_dataset_id:t.id,regions:e})},get_inputs_dict:function(){var t={};return this.get("inputs").each(function(e){t[e.get("name")]=e.get("value")}),t},_run:function(t){var e=o.extend({tool_id:this.id,inputs:this.get_inputs_dict()},t),i=n.Deferred(),a=new l.default.ServerStateDeferred({ajax_settings:{url:this.urlRoot,data:JSON.stringify(e),dataType:"json",contentType:"application/json",type:"POST"},interval:2e3,success_fn:function(t){return"pending"!==t}});return n.when(a.go()).then(function(t){i.resolve(new c.default.DatasetCollection(t))}),i}});o.extend(b.prototype,h);var w=(t.View.extend({}),t.Collection.extend({model:b})),y=t.Model.extend(h),x=t.Model.extend({defaults:{elems:[],open:!1},clear_search_results:function(){o.each(this.attributes.elems,function(t){t.show()}),this.show(),this.set("open",!1)},apply_search_results:function(t){var e,i=!0;o.each(this.attributes.elems,function(n){n instanceof y?(e=n,e.hide()):n instanceof b&&n.apply_search_results(t)&&(i=!1,e&&e.show())}),i?this.hide():(this.show(),this.set("open",!0))}});o.extend(x.prototype,h);var k=t.Model.extend({defaults:{search_hint_string:"search tools",min_chars_for_search:3,clear_btn_url:"",visible:!0,query:"",results:null,clear_key:27},urlRoot:Galaxy.root+"api/tools",initialize:function(){this.on("change:query",this.do_search)},do_search:function(){var t=this.attributes.query;if(t.length<this.attributes.min_chars_for_search)return void this.set("results",null);var e=t;this.timer&&clearTimeout(this.timer),n("#search-clear-btn").hide(),n("#search-spinner").show();var i=this;this.timer=setTimeout(function(){"undefined"!=typeof ga&&ga("send","pageview",Galaxy.root+"?q="+e),n.get(i.urlRoot,{q:e},function(t){i.set("results",t),n("#search-spinner").hide(),n("#search-clear-btn").show()},"json")},400)},clear_search:function(){this.set("query",""),this.set("results",null)}});o.extend(k.prototype,h);var C=t.Model.extend({initialize:function(e){this.attributes.tool_search=e.tool_search,this.attributes.tool_search.on("change:results",this.apply_search_results,this),this.attributes.tools=e.tools,this.attributes.layout=new t.Collection(this.parse(e.layout))},parse:function(t){var e=this,i=function t(i){var n=i.model_class;if(n.indexOf("Tool")===n.length-4)return e.attributes.tools.get(i.id);if("ToolSection"===n){var a=o.map(i.elems,t);return i.elems=a,new x(i)}return"ToolSectionLabel"===n?new y(i):void 0};return o.map(t,i)},clear_search_results:function(){this.get("layout").each(function(t){t instanceof x?t.clear_search_results():t.show()})},apply_search_results:function(){var t=this.get("tool_search").get("results");if(null===t)return void this.clear_search_results();var e=null;this.get("layout").each(function(i){i instanceof y?(e=i,e.hide()):i instanceof b?i.apply_search_results(t)&&e&&e.show():(e=null,i.apply_search_results(t))})}}),S=t.View.extend({initialize:function(){this.model.on("change:hidden",this.update_visible,this),this.update_visible()},update_visible:function(){this.model.attributes.hidden?this.$el.hide():this.$el.show()}}),$=S.extend({tagName:"div",render:function(){var t=n("<div/>");t.append(z.tool_link(this.model.toJSON()));var e=this.model.get("form_style",null);if("upload1"===this.model.id)t.find("a").on("click",function(t){t.preventDefault(),Galaxy.upload.show()});else if("regular"===e){var i=this;t.find("a").on("click",function(t){t.preventDefault(),Galaxy.router.push("/",{tool_id:i.model.id,version:i.model.get("version")})})}return this.$el.append(t),this}}),T=S.extend({tagName:"div",className:"toolPanelLabel",render:function(){return this.$el.append(n("<span/>").text(this.model.attributes.text)),this}}),M=S.extend({tagName:"div",className:"toolSectionWrapper",initialize:function(){S.prototype.initialize.call(this),this.model.on("change:open",this.update_open,this)},render:function(){this.$el.append(z.panel_section(this.model.toJSON()));var t=this.$el.find(".toolSectionBody");return o.each(this.model.attributes.elems,function(e){if(e instanceof b){var i=new $({model:e,className:"toolTitle"});i.render(),t.append(i.$el)}else if(e instanceof y){var n=new T({model:e});n.render(),t.append(n.$el)}}),this},events:{"click .toolSectionTitle > a":"toggle"},toggle:function(){this.model.set("open",!this.model.attributes.open)},update_open:function(){this.model.attributes.open?this.$el.children(".toolSectionBody").slideDown("fast"):this.$el.children(".toolSectionBody").slideUp("fast")}}),O=t.View.extend({tagName:"div",id:"tool-search",className:"bar",events:{click:"focus_and_select","keyup :input":"query_changed","change :input":"query_changed","click #search-clear-btn":"clear"},render:function(){return this.$el.append(z.tool_search(this.model.toJSON())),this.model.is_visible()||this.$el.hide(),n("#messagebox").is(":visible")&&this.$el.css("top","95px"),this.$el.find("[title]").tooltip(),this},focus_and_select:function(){this.$el.find(":input").focus().select()},clear:function(){return this.model.clear_search(),this.$el.find(":input").val(""),this.focus_and_select(),!1},query_changed:function(t){if(this.model.attributes.clear_key&&this.model.attributes.clear_key===t.which)return this.clear(),!1;this.model.set("query",this.$el.find(":input").val())}}),A=t.View.extend({tagName:"div",className:"toolMenu",initialize:function(){this.model.get("tool_search").on("change:results",this.handle_search_results,this)},render:function(){var t=this,e=new O({model:this.model.get("tool_search")});return e.render(),t.$el.append(e.$el),this.model.get("layout").each(function(e){if(e instanceof x){var i=new M({model:e});i.render(),t.$el.append(i.$el)}else if(e instanceof b){var n=new $({model:e,className:"toolTitleNoSection"});n.render(),t.$el.append(n.$el)}else if(e instanceof y){var a=new T({model:e});a.render(),t.$el.append(a.$el)}}),t.$el.find("a.tool-link").click(function(e){var i=n(this).attr("class").split(/\s+/)[0],a=t.model.get("tools").get(i);t.trigger("tool_link_click",e,a)}),this},handle_search_results:function(){var t=this.model.get("tool_search").get("results");t&&0===t.length?n("#search-no-results").show():n("#search-no-results").hide()}}),E=t.View.extend({className:"toolForm",render:function(){this.$el.children().remove(),this.$el.append(z.tool_form(this.model.toJSON()))}}),z=(t.View.extend({className:"toolMenuAndView",initialize:function(){this.tool_panel_view=new A({collection:this.collection}),this.tool_form_view=new E},render:function(){this.tool_panel_view.render(),this.tool_panel_view.$el.css("float","left"),this.$el.append(this.tool_panel_view.$el),this.tool_form_view.$el.hide(),this.$el.append(this.tool_form_view.$el);var t=this;this.tool_panel_view.on("tool_link_click",function(e,i){e.preventDefault(),t.show_tool(i)})},show_tool:function(t){var e=this;t.fetch().done(function(){e.tool_form_view.model=t,e.tool_form_view.render(),e.tool_form_view.$el.show(),n("#left").width("650px")})}}),{tool_search:o.template(['<input id="tool-search-query" class="search-query parent-width" name="query" ','placeholder="<%- search_hint_string %>" autocomplete="off" type="text" />','<a id="search-clear-btn" title="clear search (esc)"> </a>','<span id="search-spinner" class="search-spinner fa fa-spinner fa-spin"></span>'].join("")),panel_section:o.template(['<div class="toolSectionTitle" id="title_<%- id %>">','<a href="javascript:void(0)"><span><%- name %></span></a>',"</div>",'<div id="<%- id %>" class="toolSectionBody" style="display: none;">','<div class="toolSectionBg"></div>',"<div>"].join("")),tool_link:o.template(['<a class="<%- id %> tool-link" href="<%= link %>" target="<%- target %>" minsizehint="<%- min_width %>">','<span class="labels">',"<% _.each( labels, function( label ){ %>",'<span class="label label-default label-<%- label %>">',"<%- label %>","</span>","<% }); %>","</span>",'<span class="tool-old-link">',"<%- name %>","</span>"," <%- description %>","</a>"].join("")),tool_form:o.template(['<div class="toolFormTitle"><%- tool.name %> (version <%- tool.version %>)</div>','<div class="toolFormBody">',"<% _.each( tool.inputs, function( input ){ %>",'<div class="form-row">','<label for="<%- input.name %>"><%- input.label %>:</label>','<div class="form-row-input">',"<%= input.html %>","</div>",'<div class="toolParamHelp" style="clear: both;">',"<%- input.help %>","</div>",'<div style="clear: both;"></div>',"</div>","<% }); %>","</div>",'<div class="form-row form-actions">','<input type="submit" class="btn btn-primary" name="runtool_btn" value="Execute" />',"</div>",'<div class="toolHelp">','<div class="toolHelpBody"><% tool.help %></div>',"</div>"].join(""),{variable:"tool"})});e.default={ToolParameter:f,IntegerToolParameter:m,SelectToolParameter:v,Tool:b,ToolCollection:w,ToolSearch:k,ToolPanel:C,ToolPanelView:A,ToolFormView:E}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=r(o),l=i(4),d=r(l),c=i(9),u=r(c),h=i(60),f=r(h),p=i(40),_=r(p),m=t.View.extend({initialize:function(t){var e=this;this.modal=parent.Galaxy.modal||new u.default.View,this.form=new f.default(s.default.merge({listen_to_history:!0,always_refresh:!1,buildmodel:function(t,i){var a=i.model.attributes,r="",o={},l=a.job_id;l?r=Galaxy.root+"api/jobs/"+l+"/build_for_rerun":(r=Galaxy.root+"api/tools/"+a.id+"/build",o=n.extend({},Galaxy.params),o.tool_id&&delete o.tool_id),a.version&&(o.tool_version=a.version),s.default.get({url:r,data:o,success:function(n){if(!n.display)return void(window.location=Galaxy.root);i.model.set(n),e._customize(i),Galaxy.emit.debug("tool-form-base::_buildModel()","Initial tool model ready.",n),t.resolve()},error:function(e,r){var o=e&&e.err_msg||"Uncaught error.";401==r?window.location=Galaxy.root+"user/login?"+n.param({redirect:Galaxy.root+"?tool_id="+a.id}):i.$el.is(":empty")?i.$el.prepend(new d.default.Message({message:o,status:"danger",persistent:!0,large:!0}).$el):Galaxy.modal&&Galaxy.modal.show({title:"Tool request failed",body:o,buttons:{Close:function(){Galaxy.modal.hide()}}}),Galaxy.emit.debug("tool-form-base::_buildModel()","Initial tool model request failed.",e),t.reject()}})},postchange:function(t,e){var i={tool_id:e.model.get("id"),tool_version:e.model.get("version"),inputs:n.extend(!0,{},e.data.create())};e.wait(!0),Galaxy.emit.debug("tool-form::postchange()","Sending current state.",i),s.default.request({type:"POST",url:Galaxy.root+"api/tools/"+e.model.get("id")+"/build",data:i,success:function(i){e.update(i),e.wait(!1),Galaxy.emit.debug("tool-form::postchange()","Received new model.",i),t.resolve()},error:function(e){Galaxy.emit.debug("tool-form::postchange()","Refresh request failed.",e),t.reject()}})}},t)),this.deferred=this.form.deferred,this.setElement("<div/>"),this.$el.append(this.form.$el)},_customize:function(t){var e=this,i=t.model.attributes,n=new d.default.Button({icon:"fa-check",tooltip:"Execute: "+i.name+" ("+i.version+")",title:"Execute",cls:"btn btn-primary ui-clear-float",wait_cls:"btn btn-info ui-clear-float",onclick:function(){n.wait(),t.portlet.disable(),e.submit(i,function(){n.unwait(),t.portlet.enable()})}});i.buttons={execute:n},i.job_id&&i.job_remap&&i.inputs.push({label:"Resume dependencies from this job",name:"rerun_remap_job_id",type:"select",display:"radio",ignore:"__ignore__",value:"__ignore__",options:[["Yes",i.job_id],["No","__ignore__"]],help:"The previous run of this tool failed and other tools were waiting for it to finish successfully. Use this option to resume those tools using the new output(s) of this tool run."})},submit:function(t,e){var i=this,r={tool_id:t.id,tool_version:t.version,inputs:this.form.data.create()};if(this.form.trigger("reset"),!i.validate(r))return Galaxy.emit.debug("tool-form::submit()","Submission canceled. Validation failed."),void(e&&e());if(t.action!==Galaxy.root+"tool_runner/index"){var o=n("<form/>").attr({action:t.action,method:t.method,enctype:t.enctype});return a.each(r.inputs,function(t,e){o.append(n("<input/>").attr({name:e,value:t}))}),o.hide().appendTo("body").submit().remove(),void(e&&e())}Galaxy.emit.debug("tool-form::submit()","Validation complete.",r),s.default.request({type:"POST",url:Galaxy.root+"api/tools",data:r,success:function(t){if(e&&e(),i.$el.children().hide(),i.$el.append(i._templateSuccess(t)),t.jobs&&t.jobs.length>0){i.$el.append(n("<div/>",{id:"webhook-view"}));new _.default.WebhookView({urlRoot:Galaxy.root+"api/webhooks/tool",toolId:r.tool_id})}parent.Galaxy&&parent.Galaxy.currHistoryPanel&&parent.Galaxy.currHistoryPanel.refreshContents()},error:function(t){e&&e(),Galaxy.emit.debug("tool-form::submit","Submission failed.",t);var n=!1;if(t&&t.err_data){var a=i.form.data.matchResponse(t.err_data);for(var o in a){i.form.highlight(o,a[o]),n=!0;break}}n||i.modal.show({title:"Job submission failed",body:i._templateError(r,t&&t.err_msg),buttons:{Close:function(){i.modal.hide()}}})}})},validate:function(t){var e=t.inputs,i=-1,n=null;for(var a in e){var r=e[a],o=this.form.data.match(a),s=this.form.field_list[o],l=this.form.input_list[o];if(o&&l&&s){if(!l.optional&&null==r)return this.form.highlight(o),!1;if(r&&r.batch){var d=r.values.length,c=d>0&&r.values[0]&&r.values[0].src;if(c)if(null===n)n=c;else if(n!==c)return this.form.highlight(o,"Please select either dataset or dataset list fields for all batch mode fields."),!1;if(-1===i)i=d;else if(i!==d)return this.form.highlight(o,"Please make sure that you select the same number of inputs for all batch mode fields. This field contains <b>"+d+"</b> selection(s) while a previous field contains <b>"+i+"</b>."),!1}}else Galaxy.emit.debug("tool-form::validate()","Retrieving input objects failed.")}return!0},_templateSuccess:function(t){if(t.jobs&&t.jobs.length>0){var e=t.jobs.length,i=1==e?"1 job has":e+" jobs have",r=n("<div/>").addClass("donemessagelarge").append(n("<p/>").text(i+" been successfully added to the queue - resulting in the following datasets:"));return a.each(t.outputs,function(t){r.append(n("<p/>").addClass("messagerow").append(n("<b/>").text(t.hid+": "+t.name)))}),r.append(n("<p/>").append("<b/>").text("You can check the status of queued jobs and view the resulting data by refreshing the History pane. When the job has been run the status will change from 'running' to 'finished' if completed successfully or 'error' if problems were encountered.")),r}return this._templateError(t,"Invalid success response. No jobs found.")},_templateError:function(t,e){return n("<div/>").addClass("errormessagelarge").append(n("<p/>").text("The server could not complete the request. Please contact the Galaxy Team if this error persists. "+(e||""))).append(n("<pre/>").text(JSON.stringify(t,null,4)))}});e.default={View:m}}).call(e,i(1),i(0),i(2))},,function(t,e,i){"use strict";(function(t,i,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.Model.extend({defaults:{url_base:"",async:!1,async_ops:[],categorical_filters:[],filters:{},sort_key:null,show_item_checkboxes:!1,advanced_search:!1,cur_page:1,num_pages:1,operation:void 0,item_ids:void 0},can_async_op:function(t){return-1!==i.indexOf(this.attributes.async_ops,t)},add_filter:function(t,e,i){if(i){var n,a=this.attributes.filters[t];if(null===a||void 0===a)n=e;else if("string"==typeof a)if("All"==a||a==e)n=e;else{var r=[];r[0]=a,r[1]=e,n=r}else n=a,-1===n.indexOf(e)&&n.push(e);this.attributes.filters[t]=n}else this.attributes.filters[t]=e},remove_filter:function(t,e){var n=this.attributes.filters[t];if(null===n||void 0===n)return!1;if("string"==typeof n)this.attributes.filters[t]="";else{var a=i.indexOf(n,e);-1!==a&&(n[a]="")}},get_url_data:function(){var t={async:this.attributes.async,sort:this.attributes.sort_key,page:this.attributes.cur_page,show_item_checkboxes:this.attributes.show_item_checkboxes,advanced_search:this.attributes.advanced_search};this.attributes.operation&&(t.operation=this.attributes.operation),this.attributes.item_ids&&(t.id=this.attributes.item_ids);var e=this;return i.each(i.pairs(e.attributes.filters),function(e){t["f-"+e[0]]=e[1]}),t},get_url:function(t){return this.get("url_base")+"?"+n.param(this.get_url_data())+"&"+n.param(t)}})}).call(e,i(1),i(2),i(0))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),r=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default={grid:function(t){var e="";return e=t.embedded?this.grid_header(t)+this.grid_table(t):'<div class="loading-elt-overlay"></div><table><tr><td width="75%">'+this.grid_header(t)+'</td><td></td><td></td></tr><tr><td width="100%" id="grid-message" valign="top"></td><td></td><td></td></tr></table>'+this.grid_table(t),t.info_text&&(e+='<br><div class="toolParamHelp" style="clear: both;">'+t.info_text+"</div>"),e},grid_table:function(t){return'<form method="post" onsubmit="return false;"><table id="grid-table" class="grid"><thead id="grid-table-header"></thead><tbody id="grid-table-body"></tbody><tfoot id="grid-table-footer"></tfoot></table></form>'},grid_header:function(t){var e='<div class="grid-header">';if(t.embedded||(e+="<h2>"+t.title+"</h2>"),t.global_actions){e+='<ul class="manage-table-actions">';var i=t.global_actions.length>=3;i&&(e+='<li><a class="action-button" id="popup-global-actions" class="menubutton">Actions</a></li><div popupmenu="popup-global-actions">');for(var n in t.global_actions){var a=t.global_actions[n];e+='<li><a class="action-button use-target" target="'+a.target+'" href="'+a.url_args+'" onclick="return false;" >'+a.label+"</a></li>"}i&&(e+="</div>"),e+="</ul>"}return t.insert&&(e+=t.insert),e+=this.grid_filters(t),e+="</div>"},header:function(t){var e="<tr>";t.show_item_checkboxes&&(e+="<th>",t.items.length>0&&(e+='<input type="checkbox" id="check_all" name=select_all_checkbox value="true"><input type="hidden" name=select_all_checkbox value="true">'),e+="</th>");for(var i in t.columns){var n=t.columns[i];n.visible&&(e+='<th id="'+n.key+'-header">',n.href?e+='<a href="'+n.href+'" class="sort-link" sort_key="'+n.key+'">'+n.label+"</a>":e+=n.label,e+='<span class="sort-arrow">'+n.extra+"</span></th>")}return e+="</tr>"},body:function(e){var i="",n=0;0==e.items.length&&(i+='<tr><td colspan="100"><em>No Items</em></td></tr>',n=1);for(var a in e.items){var r=e.items[a],o=r.encode_id;i+="<tr ",e.current_item_id==r.id&&(i+='class="current"'),i+=">",e.show_item_checkboxes&&(i+='<td style="width: 1.5em;"><input type="checkbox" name="id" value="'+o+'" id="'+o+'" class="grid-row-select-checkbox" /></td>');for(var s in e.columns){var l=e.columns[s];if(l.visible){var d="";l.nowrap&&(d='style="white-space:nowrap;"');var c=r.column_config[l.label],u=c.link,h=c.value,f=c.target;"string"===t.type(h)&&(h=h.replace(/\/\//g,"/"));var p="",_="";l.attach_popup&&(p="grid-"+a+"-popup",_="menubutton",""!=u&&(_+=" split"),_+=" popup"),i+="<td "+d+">",u?(0!=e.operations.length&&(i+='<div id="'+p+'" class="'+_+'" style="float: left;">'),i+='<a class="menubutton-label use-target" target="'+f+'" href="'+u+'" onclick="return false;">'+h+"</a>",0!=e.operations.length&&(i+="</div>")):i+='<div id="'+p+'" class="'+_+'"><label id="'+l.label_id_prefix+o+'" for="'+o+'">'+(h||"")+"</label></div>",i+="</td>"}}i+="</tr>",n++}return i},footer:function(t){var e="";if(t.use_paging&&t.num_pages>1){var i=t.num_page_links,n=t.cur_page_num,a=t.num_pages,r=i/2,o=n-r,s=0;o<=0&&(o=1,s=r-(n-o));var l,d=r+s,c=n+d;c<=a?l=0:(c=a,l=d-(c+1-n)),0!=l&&(o-=l)<1&&(o=1),e+='<tr id="page-links-row">',t.show_item_checkboxes&&(e+="<td></td>"),e+='<td colspan="100"><span id="page-link-container">Page:',o>1&&(e+='<span class="page-link" id="page-link-1"><a href="javascript:void(0);" page_num="1" onclick="return false;">1</a></span> ...');for(var u=o;u<c+1;u++)u==t.cur_page_num?e+='<span class="page-link inactive-link" id="page-link-'+u+'">'+u+"</span>":e+='<span class="page-link" id="page-link-'+u+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+u+'">'+u+"</a></span>";c<a&&(e+='...<span class="page-link" id="page-link-'+a+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+a+'">'+a+"</a></span>"),e+="</span>",e+='<span class="page-link" id="show-all-link-span"> | <a href="javascript:void(0);" onclick="return false;" page_num="all">Show All</a></span></td></tr>'}if(t.show_item_checkboxes){e+='<tr><input type="hidden" id="operation" name="operation" value=""><td></td><td colspan="100">For <span class="grid-selected-count"></span> selected items: ';for(var h in t.operations){var f=t.operations[h];f.allow_multiple&&(e+='<input type="button" value="'+f.label+'" class="operation-button action-button">&nbsp;')}e+="</td></tr>"}var p=!1;for(h in t.operations)if(t.operations[h].global_operation){p=!0;break}if(p){e+='<tr><td colspan="100">';for(h in t.operations){var f=t.operations[h];f.global_operation&&(e+='<a class="action-button" href="'+f.global_operation+'">'+f.label+"</a>")}e+="</td></tr>"}return t.legend&&(e+='<tr><td colspan="100">'+t.legend+"</td></tr>"),e},message:function(t){var e=t.status;return-1!=["success","ok"].indexOf(e)&&(e="done"),'<p><div class="'+e+'message transient-message">'+n.escape(t.message)+'</div><div style="clear: both"></div></p>'},grid_filters:function(t){var e=t.default_filter_dict,i=t.filters,n="none";t.advanced_search&&(n="block");var a=!1;for(var r in t.columns){var o=t.columns[r];if("advanced"==o.filterable){var s=o.key,l=i[s],d=e[s];l&&d&&l!=d&&(n="block"),a=!0}}var c="block";"block"==n&&(c="none");var u='<div id="standard-search" style="display: '+c+';"><table><tr><td style="padding: 0;"><table>';for(var r in t.columns){var o=t.columns[r];"standard"==o.filterable&&(u+=this.grid_column_filter(t,o))}u+="</table></td></tr><tr><td>",a&&(u+='<a href="" class="advanced-search-toggle">Advanced Search</a>'),u+="</td></tr></table></div>",u+='<div id="advanced-search" style="display: '+n+'; margin-top: 5px; border: 1px solid #ccc;"><table><tr><td style="text-align: left" colspan="100"><a href="" class="advanced-search-toggle">Close Advanced Search</a></td></tr>';for(var r in t.columns){var o=t.columns[r];"advanced"==o.filterable&&(u+=this.grid_column_filter(t,o))}return u+="</table></div>"},grid_column_filter:function(e,i){var n=(e.default_filter_dict,e.filters),a=i.label,r=i.key;"advanced"==i.filterable&&(a=a.toLowerCase());var o="<tr>";if("advanced"==i.filterable&&(o+='<td align="left" style="padding-left: 10px">'+a+":</td>"),o+='<td style="padding-bottom: 1px;">',i.is_text){o+='<form class="text-filter-form" column_key="'+r+'" action="'+e.url+'" method="get" >';for(u in e.columns){var s=e.columns[u],l=n[s.key];l&&"All"!=l&&(s.is_text&&(l=JSON.stringify(l)),o+='<input type="hidden" id="'+s.key+'" name="f-'+s.key+'" value="'+l+'"/>')}o+='<span id="'+r+'-filtering-criteria">';var d=n[r];if(d){var c=t.type(d);if("string"==c&&"All"!=d&&(o+=this.filter_element(r,d)),"array"==c)for(var u in d){var h=d[u],f=d;f=f.slice(u),o+=this.filter_element(r,h)}}o+="</span>";var p="";if("standard"==i.filterable){p=i.label.toLowerCase();var _=p.length;_<20&&(_=20),_+=4}o+='<span class="search-box"><input class="search-box-input" id="input-'+r+'-filter" name="f-'+r+'" type="text" placeholder="'+p+'" size="'+_+'"/><button type="submit" style="background: transparent; border: none; padding: 4px; margin: 0px;"><i class="fa fa-search"></i></button></span></form>'}else{o+='<span id="'+r+'-filtering-criteria">';var m=!1;for(var g in e.categorical_filters[r]){var v=e.categorical_filters[r][g],b="",w="";for(var y in v)b=y,w=v[y];m&&(o+=" | "),m=!0;var h=n[r];h&&v[r]&&h==w?o+='<span class="categorical-filter '+r+'-filter current-filter">'+g+"</span>":o+='<span class="categorical-filter '+r+'-filter"><a href="javascript:void(0);" filter_key="'+b+'" filter_val="'+w+'">'+g+"</a></span>"}o+="</span>"}return o+="</td></tr>"},filter_element:function(t,e){return'<span class="text-filter-val">'+(e=r.default.sanitize(e))+'<a href="javascript:void(0);" filter_key="'+t+'" filter_val="'+e+'"><i class="fa fa-times" style="padding-left: 5px; padding-bottom: 6px;"/></a></span>'}}}).call(e,i(0),i(2))},function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),s=i(146),l=a(s),d=i(13),c=a(d),u=i(41),h=a(u),f=i(58),p=a(f),_=i(26),m=a(_),g=i(3),v=a(g);i(170),i(169),i(171),i(157),i(174),i(159),i(172),i(173),i(25);var b=null,w=null,y=function(){this.initialize&&this.initialize.apply(this,arguments)};y.extend=t.Model.extend;var x=y.extend({initialize:function(t){v.default.cssLoadFile("static/style/jquery.rating.css"),v.default.cssLoadFile("static/style/autocomplete_tagging.css"),v.default.cssLoadFile("static/style/jquery-ui/smoothness/jquery-ui.css"),v.default.cssLoadFile("static/style/library.css"),v.default.cssLoadFile("static/style/trackster.css"),this.baseURL=t},save_viz:function(){Galaxy.modal.show({title:"Saving...",body:"progress"});var t=[];n(".bookmark").each(function(){t.push({position:n(this).children(".position").text(),annotation:n(this).children(".annotation").text()})});var e=w.overview_drawable?w.overview_drawable.config.get_value("name"):null,i={view:w.to_dict(),viewport:{chrom:w.chrom,start:w.low,end:w.high,overview:e},bookmarks:t};return n.ajax({url:Galaxy.root+"visualization/save",type:"POST",dataType:"json",data:{id:w.vis_id,title:w.config.get_value("name"),dbkey:w.dbkey,type:"trackster",vis_json:JSON.stringify(i)}}).success(function(t){Galaxy.modal.hide(),w.vis_id=t.vis_id,w.has_changes=!1,window.history.pushState({},"",t.url+window.location.hash)}).error(function(){Galaxy.modal.show({title:"Could Not Save",body:"Could not save visualization. Please try again later.",buttons:{Cancel:function(){Galaxy.modal.hide()}}})})},createButtonMenu:function(){var t=this,e=h.default.create_icon_buttons_menu([{icon_class:"plus-button",title:"Add tracks",on_click:function(){c.default.select_datasets({dbkey:w.dbkey},function(t){o.each(t,function(t){w.add_drawable(l.default.object_from_template(t,w,w))})})}},{icon_class:"block--plus",title:"Add group",on_click:function(){w.add_drawable(new l.default.DrawableGroup(w,w,{name:"New Group"}))}},{icon_class:"bookmarks",title:"Bookmarks",on_click:function(){force_right_panel("0px"==n("div#right").css("right")?"hide":"show")}},{icon_class:"globe",title:"Circster",on_click:function(){window.location=t.baseURL+"visualization/circster?id="+w.vis_id}},{icon_class:"disk--arrow",title:"Save",on_click:function(){t.save_viz()}},{icon_class:"cross-circle",title:"Close",on_click:function(){t.handle_unsaved_changes(w)}}],{tooltip_config:{placement:"bottom"}});return this.buttonMenu=e,e},add_bookmark:function(t,e,i){var a=n("#right .unified-panel-body"),r=n("<div/>").addClass("bookmark").appendTo(a),o=n("<div/>").addClass("position").appendTo(r),s=(n("<a href=''/>").text(t).appendTo(o).click(function(){return w.go_to(t),!1}),n("<div/>").text(e).appendTo(r));if(i){var l=n("<div/>").addClass("delete-icon-container").prependTo(r).click(function(){return r.slideUp("fast"),r.remove(),w.has_changes=!0,!1});n("<a href=''/>").addClass("icon-button delete").appendTo(l);s.make_text_editable({num_rows:3,use_textarea:!0,help_text:"Edit bookmark note"}).addClass("annotation")}return w.has_changes=!0,r},create_visualization:function(t,e,i,a,r){var s=this,d=new l.default.TracksterView(o.extend(t,{header:!1}));return d.editor=!0,n.when(d.load_chroms_deferred).then(function(t){if(e){var n=e.chrom,o=e.start,c=e.end,u=e.overview;n&&void 0!==o&&c?d.change_chrom(n,o,c):d.change_chrom(t[0].chrom)}else d.change_chrom(t[0].chrom);if(i)for(var h=0;h<i.length;h++)d.add_drawable(l.default.object_from_template(i[h],d,d));for(var h=0;h<d.drawables.length;h++)if(d.drawables[h].config.get_value("name")===u){d.set_overview(d.drawables[h]);break}if(a)for(var f,h=0;h<a.length;h++)f=a[h],s.add_bookmark(f.position,f.annotation,r);d.has_changes=!1}),this.set_up_router({view:d}),d},set_up_router:function(e){new c.default.TrackBrowserRouter(e),t.history.start()},init_keyboard_nav:function(t){n(document).keyup(function(e){if(!n(e.srcElement).is(":input"))switch(e.which){case 37:t.move_fraction(.25);break;case 38:Math.round(t.viewport_container.height()/15);t.viewport_container.scrollTop(t.viewport_container.scrollTop()-20);break;case 39:t.move_fraction(-.25);break;case 40:Math.round(t.viewport_container.height()/15);t.viewport_container.scrollTop(t.viewport_container.scrollTop()+20)}})},handle_unsaved_changes:function(t){if(t.has_changes){var e=this;Galaxy.modal.show({title:"Close visualization",body:"There are unsaved changes to your visualization which will be lost if you do not save them.",buttons:{Cancel:function(){Galaxy.modal.hide()},"Leave without Saving":function(){n(window).off("beforeunload"),window.location=Galaxy.root+"visualization"},Save:function(){n.when(e.save_viz()).then(function(){window.location=Galaxy.root+"visualization"})}}})}else window.location=Galaxy.root+"visualization"}}),k=t.View.extend({initialize:function(){b=new x(Galaxy.root),b.createButtonMenu(),b.buttonMenu.$el.attr("style","float: right"),n("#center .unified-panel-header-inner").append(b.buttonMenu.$el),n("#right .unified-panel-title").append("Bookmarks"),n("#right .unified-panel-icons").append("<a id='add-bookmark-button' class='icon-button menu-button plus-button' href='javascript:void(0);' title='Add bookmark'></a>"),n("#right-border").click(function(){w.resize_window()}),force_right_panel("hide"),galaxy_config.app.id?this.view_existing():p.default.get("dataset_id")?this.choose_existing_or_new():this.view_new()},choose_existing_or_new:function(){var t=this,e=p.default.get("dbkey"),i={},n={dbkey:e,dataset_id:p.default.get("dataset_id"),hda_ldda:p.default.get("hda_ldda"),gene_region:p.default.get("gene_region")};e&&(i["f-dbkey"]=e),Galaxy.modal.show({title:"View Data in a New or Saved Visualization?",body:"<p><ul style='list-style: disc inside none'>You can add this dataset as:<li>a new track to one of your existing, saved Trackster sessions if they share the genome build: <b>"+(e||"Not available.")+"</b></li><li>or create a new session with this dataset as the only track</li></ul></p>",buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},"View in saved visualization":function(){t.view_in_saved(n)},"View in new visualization":function(){t.view_new()}}})},view_in_saved:function(t){var e=new m.default({url_base:Galaxy.root+"visualization/list_tracks",dict_format:!0,embedded:!0});Galaxy.modal.show({title:"Add Data to Saved Visualization",body:e.$el,buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},"Add to visualization":function(){n(parent.document).find("input[name=id]:checked").each(function(){t.id=n(this).val(),window.location=Galaxy.root+"visualization/trackster?"+n.param(t)})}}})},view_existing:function(){var t=galaxy_config.app.viz_config;w=b.create_visualization({container:n("#center .unified-panel-body"),name:t.title,vis_id:t.vis_id,dbkey:t.dbkey},t.viewport,t.tracks,t.bookmarks,!0),this.init_editor()},view_new:function(){var t=this;n.ajax({url:Galaxy.root+"api/genomes?chrom_info=True",data:{},error:function(){alert("Couldn't create new browser.")},success:function(e){Galaxy.modal.show({title:"New Visualization",body:t.template_view_new(e),buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},Create:function(){t.create_browser(n("#new-title").val(),n("#new-dbkey").val()),Galaxy.modal.hide()}}});var i=e.map(function(t){return t[1]});galaxy_config.app.default_dbkey&&o.contains(i,galaxy_config.app.default_dbkey)&&n("#new-dbkey").val(galaxy_config.app.default_dbkey),n("#new-title").focus(),n("select[name='dbkey']").select2(),n("#overlay").css("overflow","auto")}})},template_view_new:function(t){for(var e='<form id="new-browser-form" action="javascript:void(0);" method="post" onsubmit="return false;"><div class="form-row"><label for="new-title">Browser name:</label><div class="form-row-input"><input type="text" name="title" id="new-title" value="Unnamed"></input></div><div style="clear: both;"></div></div><div class="form-row"><label for="new-dbkey">Reference genome build (dbkey): </label><div class="form-row-input"><select name="dbkey" id="new-dbkey">',i=0;i<t.length;i++)e+='<option value="'+t[i][1]+'">'+t[i][0]+"</option>";return e+='</select></div><div style="clear: both;"></div></div><div class="form-row">Is the build not listed here? <a href="'+Galaxy.root+'user/dbkeys?use_panels=True">Add a Custom Build</a></div></form>'},create_browser:function(t,e){n(document).trigger("convert_to_values"),w=b.create_visualization({container:n("#center .unified-panel-body"),name:t,dbkey:e},galaxy_config.app.gene_region),this.init_editor(),w.editor=!0},init_editor:function(){n("#center .unified-panel-title").text(w.config.get_value("name")+" ("+w.dbkey+")"),galaxy_config.app.add_dataset&&n.ajax({url:Galaxy.root+"api/datasets/"+galaxy_config.app.add_dataset,data:{hda_ldda:"hda",data_type:"track_config"},dataType:"json",success:function(t){w.add_drawable(l.default.object_from_template(t,w,w))}}),n("#add-bookmark-button").click(function(){var t=w.chrom+":"+w.low+"-"+w.high;return b.add_bookmark(t,"Bookmark description",!0)}),b.init_keyboard_nav(w),n(window).on("beforeunload",function(){if(w.has_changes)return"There are unsaved changes to your visualization that will be lost if you leave this page."})}});e.default={TracksterUI:x,GalaxyApp:k}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){e||(e=0);var i=Math.pow(10,e);return Math.round(t*i)/i}function o(e){var i=t.Deferred();return t.ajax({type:"HEAD",url:e,beforeSend:function(t){t.setRequestHeader("Range","bytes=0-10")},success:function(t,e,n){i.resolve(206===n.status)}}),i}Object.defineProperty(e,"__esModule",{value:!0});var s=i(2),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(s),d=i(13),c=a(d),u=i(147),h=a(u),f=i(14),p=a(f),_=i(148),m=a(_),g=i(149),v=a(g),b=i(150),w=a(b),y=i(15),x=a(y),k=i(140),C=a(k),S=i(21),$=a(S),T=i(151),M=a(T);i(25);var O=l.extend,A={},E=function(t,e){A[t.attr("id")]=e},z=function(e,i,n,a){n=".group",A[e.attr("id")]=a,e.bind("drag",{handle:"."+i,relative:!0},function(e,i){var a,r,o,s,l,d=(t(this),t(this).parent()),c=d.children(".track,.group"),u=A[t(this).attr("id")];if(r=t(this).parents(n),0!==r.length){o=r.position().top,s=o+r.outerHeight();var h=A[r.attr("id")];if(i.offsetY<o)return t(this).insertBefore(r),h.remove_drawable(u),void h.container.add_drawable_before(u,h);if(i.offsetY>s)return t(this).insertAfter(r),h.remove_drawable(u),void h.container.add_drawable(u)}for(r=null,l=0;l<c.length;l++)if(a=t(c.get(l)),o=a.position().top,s=o+a.outerHeight(),a.is(n)&&this!==a.get(0)&&i.offsetY>=o&&i.offsetY<=s)return i.offsetY-o<s-i.offsetY?a.find(".content-div").prepend(this):a.find(".content-div").append(this),u.container&&u.container.remove_drawable(u),void A[a.attr("id")].add_drawable(u);for(l=0;l<c.length&&(a=t(c.get(l)),!(i.offsetY<a.position().top)||a.hasClass("reference-track")||a.hasClass("intro"));l++);l===c.length?this!==c.get(l-1)&&(d.append(this),A[d.attr("id")].move_drawable(u,l)):this!==c.get(l)&&(t(this).insertBefore(c.get(l)),A[d.attr("id")].move_drawable(u,i.deltaY>0?l-1:l))}).bind("dragstart",function(){t(this).addClass("dragging")}).bind("dragend",function(){t(this).removeClass("dragging")})},R="A converter for this dataset is not installed. Please check your datatypes_conf.xml file.",P=["Histogram","Line","Filled","Intensity"],j=function t(e,i,n){if(t.id_counter||(t.id_counter=0),this.id=t.id_counter++,this.view=e,this.container=i,this.drag_handle_class=n.drag_handle_class,this.is_overview=!1,this.action_icons={},this.config=$.default.ConfigSettingCollection.from_models_and_saved_values(this.config_params,n.prefs),this.config.get_value("name")||this.config.set_value("name",n.name),this.config_onchange&&this.config.on("change",this.config_onchange,this),this.container_div=this.build_container_div(),this.header_div=null,!1!==n.header){var a=new h.default.TrackHeaderView({model:this,id:this.id});this.header_div=a.$el,this.container_div.append(this.header_div);var r=a.icons_div;this.action_icons=a.action_icons,this.container_div.hover(function(){r.show()},function(){r.hide()})}};j.prototype.action_icons_def=[{name:"toggle_icon",title:"Hide/show content",css_class:"toggle",on_click_fn:function(t){t.config.get_value("content_visible")?(t.action_icons.toggle_icon.addClass("toggle-expand").removeClass("toggle"),t.hide_contents(),t.config.set_value("content_visible",!1)):(t.action_icons.toggle_icon.addClass("toggle").removeClass("toggle-expand"),t.config.set_value("content_visible",!0),t.show_contents())}},{name:"settings_icon",title:"Edit settings",css_class:"gear",on_click_fn:function(t){new $.default.ConfigSettingCollectionView({collection:t.config}).render_in_modal("Configure Track")}},{name:"remove_icon",title:"Remove",css_class:"remove-icon",on_click_fn:function(e){t(".tooltip").remove(),e.remove()}}],O(j.prototype,{config_params:[{key:"name",label:"Name",type:"text",default_value:""},{key:"content_visible",type:"bool",default_value:!0,hidden:!0}],config_onchange:function(){},init:function(){},changed:function(){this.view.changed()},can_draw:function(){return!(!this.enabled||!this.config.get_value("content_visible"))},request_draw:function(){},_draw:function(t){},to_dict:function(){},set_name:function(t){this.old_name=this.config.get_value("name"),this.config.set_value("name",t)},revert_name:function(){this.old_name&&this.config.set_value("name",this.old_name)},remove:function(){this.changed(),this.container.remove_drawable(this);var e=this.view;this.container_div.hide(0,function(){t(this).remove(),e.update_intro_div()})},build_container_div:function(){},update_icons:function(){},hide_contents:function(){},show_contents:function(){},get_drawables:function(){}});var q=function(t,e,i){j.call(this,t,e,i),this.obj_type=i.obj_type,this.drawables=[]};O(q.prototype,j.prototype,{unpack_drawables:function(t){this.drawables=[];for(var e,i=0;i<t.length;i++)e=nt(t[i],this.view,this),this.add_drawable(e)},init:function(){for(var t=0;t<this.drawables.length;t++)this.drawables[t].init()},_draw:function(t){for(var e=0;e<this.drawables.length;e++)this.drawables[e]._draw(t)},to_dict:function(){for(var t=[],e=0;e<this.drawables.length;e++)t.push(this.drawables[e].to_dict());return{prefs:this.config.to_key_value_dict(),obj_type:this.obj_type,drawables:t}},add_drawable:function(t){this.drawables.push(t),t.container=this,this.changed()},add_drawable_before:function(t,e){this.changed();var i=this.drawables.indexOf(e);return-1!==i&&(this.drawables.splice(i,0,t),!0)},replace_drawable:function(t,e,i){var n=this.drawables.indexOf(t);return-1!==n&&(this.drawables[n]=e,i&&t.container_div.replaceWith(e.container_div),this.changed()),n},remove_drawable:function(t){var e=this.drawables.indexOf(t);return-1!==e&&(this.drawables.splice(e,1),t.container=null,this.changed(),!0)},move_drawable:function(t,e){var i=this.drawables.indexOf(t);return-1!==i&&(this.drawables.splice(i,1),this.drawables.splice(e,0,t),this.changed(),!0)},get_drawables:function(){return this.drawables},get_tracks:function(t){for(var e,i=this.drawables.slice(0),n=[];0!==i.length;)e=i.shift(),e instanceof t?n.push(e):e.drawables&&(i=i.concat(e.drawables));return n}});var D=function(e,i,n){if(O(n,{obj_type:"DrawableGroup",drag_handle_class:"group-handle"}),q.call(this,e,i,n),this.content_div=t("<div/>").addClass("content-div").attr("id","group_"+this.id+"_content_div").appendTo(this.container_div),E(this.container_div,this),E(this.content_div,this),z(this.container_div,this.drag_handle_class,".group",this),this.filters_manager=new w.default.FiltersManager(this),this.header_div.after(this.filters_manager.parent_div),this.filters_manager.parent_div.after(t("<div style='clear: both'/>")),this.saved_filters_managers=[],"drawables"in n&&this.unpack_drawables(n.drawables),"filters"in n){var a=this.filters_manager;this.filters_manager=new w.default.FiltersManager(this,n.filters),a.parent_div.replaceWith(this.filters_manager.parent_div),n.filters.visible&&this.setup_multitrack_filtering()}};O(D.prototype,j.prototype,q.prototype,{action_icons_def:[j.prototype.action_icons_def[0],j.prototype.action_icons_def[1],{name:"composite_icon",title:"Show composite track",css_class:"layers-stack",on_click_fn:function(e){t(".tooltip").remove(),e.show_composite_track()}},{name:"filters_icon",title:"Filters",css_class:"ui-slider-050",on_click_fn:function(t){t.filters_manager.visible()?(t.filters_manager.clear_filters(),t._restore_filter_managers()):(t.setup_multitrack_filtering(),t.request_draw({clear_tile_cache:!0})),t.filters_manager.toggle()}},j.prototype.action_icons_def[2]],build_container_div:function(){var e=t("<div/>").addClass("group").attr("id","group_"+this.id);return this.container&&this.container.content_div.append(e),e},hide_contents:function(){this.tiles_div.hide()},show_contents:function(){this.tiles_div.show(),this.request_draw()},update_icons:function(){var e=this.drawables.length;if(0===e)this.action_icons.composite_icon.hide(),this.action_icons.filters_icon.hide();else if(1===e)this.action_icons.composite_icon.toggle(this.drawables[0]instanceof J),this.action_icons.filters_icon.hide();else{var i,n,a,r=this.drawables[0].get_type(),o=0;for(i=0;i<e;i++){if(a=this.drawables[i],a.get_type()!==r){can_composite=!1;break}a instanceof Q&&o++}if(this.drawables[0]instanceof K?this.action_icons.composite_icon.show():(this.action_icons.composite_icon.hide(),t(".tooltip").remove()),o>1&&o===this.drawables.length){var s,l={};for(a=this.drawables[0],n=0;n<a.filters_manager.filters.length;n++)s=a.filters_manager.filters[n],l[s.name]=[s];for(i=1;i<this.drawables.length;i++)for(a=this.drawables[i],n=0;n<a.filters_manager.filters.length;n++)s=a.filters_manager.filters[n],s.name in l&&l[s.name].push(s);this.filters_manager.remove_all();var d,c;for(var u in l)d=l[u],d.length===o&&(c=new w.default.NumberFilter({name:d[0].name,index:d[0].index}),this.filters_manager.add_filter(c));this.action_icons.filters_icon.toggle(this.filters_manager.filters.length>0)}else this.action_icons.filters_icon.hide()}},_restore_filter_managers:function(){for(var t=0;t<this.drawables.length;t++)this.drawables[t].filters_manager=this.saved_filters_managers[t];this.saved_filters_managers=[]},setup_multitrack_filtering:function(){if(this.filters_manager.filters.length>0){this.saved_filters_managers=[];for(var t=0;t<this.drawables.length;t++){var e=this.drawables[t];this.saved_filters_managers.push(e.filters_manager),e.filters_manager=this.filters_manager}}this.filters_manager.init_filters()},show_composite_track:function(){var t=new J(this.view,this.view,{name:this.config.get_value("name"),drawables:this.drawables});this.container.replace_drawable(this,t,!0);t.request_draw()},add_drawable:function(t){q.prototype.add_drawable.call(this,t),this.update_icons()},remove_drawable:function(t){q.prototype.remove_drawable.call(this,t),this.update_icons()},to_dict:function(){this.filters_manager.visible()&&this._restore_filter_managers();var t=O(q.prototype.to_dict.call(this),{filters:this.filters_manager.to_dict()});return this.filters_manager.visible()&&this.setup_multitrack_filtering(),t},request_draw:function(t){l.each(this.drawables,function(e){e.request_draw(t)})}});var I=n.View.extend({initialize:function(t){O(t,{obj_type:"View"}),q.call(this,"View",t.container,t),this.chrom=null,this.vis_id=t.vis_id,this.dbkey=t.dbkey,this.stand_alone=void 0===t.stand_alone||t.stand_alone,this.label_tracks=[],this.tracks_to_be_redrawn=[],this.max_low=0,this.max_high=0,this.zoom_factor=3,this.min_separation=30,this.has_changes=!1,this.load_chroms_deferred=null,this.render(),this.canvas_manager=new c.default.CanvasManager(this.container.get(0).ownerDocument),this.reset(),this.config=$.default.ConfigSettingCollection.from_models_and_saved_values([{key:"name",label:"Name",type:"text",default_value:""},{key:"a_color",label:"A Color",type:"color",default_value:"#FF0000"},{key:"c_color",label:"C Color",type:"color",default_value:"#00FF00"},{key:"g_color",label:"G Color",type:"color",default_value:"#0000FF"},{key:"t_color",label:"T Color",type:"color",default_value:"#FF00FF"},{key:"n_color",label:"N Color",type:"color",default_value:"#AAAAAA"}],{name:t.name})},render:function(){this.requested_redraw=!1;var e=this.container,i=this;this.top_container=t("<div/>").addClass("top-container").appendTo(e),this.browser_content_div=t("<div/>").addClass("content").appendTo(e),this.bottom_container=t("<div/>").addClass("bottom-container").appendTo(e),this.top_labeltrack=t("<div/>").addClass("top-labeltrack").appendTo(this.top_container),this.viewport_container=t("<div/>").addClass("viewport-container").attr("id","viewport-container").appendTo(this.browser_content_div),this.content_div=this.viewport_container,E(this.viewport_container,i),this.intro_div=t("<div/>").addClass("intro").appendTo(this.viewport_container);t("<div/>").text("Add Datasets to Visualization").addClass("action-button").appendTo(this.intro_div).click(function(){c.default.select_datasets({dbkey:i.dbkey},function(t){l.each(t,function(t){i.add_drawable(nt(t,i,i))})})});this.nav_container=t("<div/>").addClass("trackster-nav-container").prependTo(this.top_container),this.nav=t("<div/>").addClass("trackster-nav").appendTo(this.nav_container),this.stand_alone&&(this.nav_container.addClass("stand-alone"),this.nav.addClass("stand-alone")),this.overview=t("<div/>").addClass("overview").appendTo(this.bottom_container),this.overview_viewport=t("<div/>").addClass("overview-viewport").appendTo(this.overview),this.overview_close=t("<a/>").attr("title","Close overview").addClass("icon-button overview-close tooltip").hide().appendTo(this.overview_viewport),this.overview_highlight=t("<div/>").addClass("overview-highlight").hide().appendTo(this.overview_viewport),this.overview_box_background=t("<div/>").addClass("overview-boxback").appendTo(this.overview_viewport),this.overview_box=t("<div/>").addClass("overview-box").appendTo(this.overview_viewport),this.default_overview_height=this.overview_box.height(),this.nav_controls=t("<div/>").addClass("nav-controls").appendTo(this.nav),this.chrom_select=t("<select/>").attr({name:"chrom"}).addClass("chrom-nav").append("<option value=''>Loading</option>").appendTo(this.nav_controls);var n=function(e){"focusout"!==e.type&&13!==(e.keyCode||e.which)&&27!==(e.keyCode||e.which)||(27!==(e.keyCode||e.which)&&i.go_to(t(this).val()),t(this).hide(),t(this).val(""),i.location_span.show(),i.chrom_select.show()),e.stopPropagation()};this.nav_input=t("<input/>").addClass("nav-input").hide().bind("keyup focusout",n).appendTo(this.nav_controls),this.location_span=t("<span/>").addClass("location").attr("title","Click to change location").tooltip({placement:"bottom"}).appendTo(this.nav_controls),this.location_span.click(function(){i.location_span.hide(),i.chrom_select.hide(),i.nav_input.val(i.chrom+":"+i.low+"-"+i.high),i.nav_input.css("display","inline-block"),i.nav_input.select(),i.nav_input.focus(),i.nav_input.autocomplete({source:function(e,n){var a=[],r=t.map(i.get_tracks(Q),function(t){return t.data_manager.search_features(e.term).success(function(t){a=a.concat(t)})});t.when.apply(t,r).done(function(){n(t.map(a,function(t){return{label:t[0],value:t[1]}}))})},minLength:2})}),void 0!==this.vis_id&&(this.hidden_input=t("<input/>").attr("type","hidden").val(this.vis_id).appendTo(this.nav_controls)),this.zo_link=t("<a/>").attr("id","zoom-out").attr("title","Zoom out").tooltip({placement:"bottom"}).click(function(){i.zoom_out()}).appendTo(this.nav_controls),this.zi_link=t("<a/>").attr("id","zoom-in").attr("title","Zoom in").tooltip({placement:"bottom"}).click(function(){i.zoom_in()}).appendTo(this.nav_controls),this.load_chroms_deferred=this.load_chroms({low:0}),this.chrom_select.bind("change",function(){i.change_chrom(i.chrom_select.val())}),this.browser_content_div.click(function(e){t(this).find("input").trigger("blur")}),this.browser_content_div.bind("dblclick",function(t){i.zoom_in(t.pageX,this.viewport_container)}),this.overview_box.bind("dragstart",function(t,e){this.current_x=e.offsetX}).bind("drag",function(t,e){var n=e.offsetX-this.current_x;this.current_x=e.offsetX;var a=Math.round(n/i.viewport_container.width()*(i.max_high-i.max_low));i.move_delta(-a)}),this.overview_close.click(function(){i.reset_overview()}),this.viewport_container.bind("draginit",function(t,e){if(t.clientX>i.viewport_container.width()-16)return!1}).bind("dragstart",function(t,e){e.original_low=i.low,e.current_height=t.clientY,e.current_x=e.offsetX}).bind("drag",function(e,n){var a=t(this),r=n.offsetX-n.current_x,o=a.scrollTop()-(e.clientY-n.current_height);a.scrollTop(o),n.current_height=e.clientY,n.current_x=n.offsetX;var s=Math.round(r/i.viewport_container.width()*(i.high-i.low));i.move_delta(s)}),this.top_labeltrack.bind("dragstart",function(e,n){return t("<div/>").addClass("zoom-area").css("height",i.browser_content_div.height()+i.top_labeltrack.height()+1).appendTo(t(this))}).bind("drag",function(e,n){t(n.proxy).css({left:Math.min(e.pageX,n.startX)-i.container.offset().left,width:Math.abs(e.pageX-n.startX)});var a=Math.min(e.pageX,n.startX)-i.container.offset().left,r=Math.max(e.pageX,n.startX)-i.container.offset().left,o=i.high-i.low,s=i.viewport_container.width();i.update_location(Math.round(a/s*o)+i.low,Math.round(r/s*o)+i.low)}).bind("dragend",function(e,n){var a=Math.min(e.pageX,n.startX),r=Math.max(e.pageX,n.startX),o=i.high-i.low,s=i.viewport_container.width(),l=i.low;i.low=Math.round(a/s*o)+l,i.high=Math.round(r/s*o)+l,t(n.proxy).remove(),i.request_redraw()}),this.add_label_track(new X(this,{content_div:this.top_labeltrack})),t(window).bind("resize",function(){this.resize_timer&&clearTimeout(this.resize_timer),this.resize_timer=setTimeout(function(){i.resize_window()},500)}),t(document).bind("redraw",function(){i.redraw()}),this.reset(),t(window).trigger("resize")},get_base_color:function(t){return this.config.get_value(t.toLowerCase()+"_color")||this.config.get_value("n_color")}});O(I.prototype,q.prototype,{changed:function(){this.has_changes=!0},update_intro_div:function(){this.intro_div.toggle(0===this.drawables.length)},trigger_navigate:function(t,e,i,n){if(this.timer&&clearTimeout(this.timer),n){var a=this;this.timer=setTimeout(function(){a.trigger("navigate",t+":"+e+"-"+i)},500)}else view.trigger("navigate",t+":"+e+"-"+i)},update_location:function(t,e){this.location_span.text(p.default.commatize(t)+" - "+p.default.commatize(e)),this.nav_input.val(this.chrom+":"+p.default.commatize(t)+"-"+p.default.commatize(e));var i=this.chrom_select.val();""!==i&&this.trigger_navigate(i,this.low,this.high,!0)},load_chroms:function(e){e.num=100;var i=this,n=t.Deferred();return t.ajax({url:Galaxy.root+"api/genomes/"+this.dbkey,data:e,dataType:"json",success:function(e){if(0!==e.chrom_info.length){if(e.reference){var a=new W(i);i.add_label_track(a),i.reference_track=a}i.chrom_data=e.chrom_info,i.chrom_select.html(""),i.chrom_select.append(t('<option value="">Select Chrom/Contig</option>'));for(var r=0,o=i.chrom_data.length;r<o;r++){var s=i.chrom_data[r].chrom,l=t("<option>");l.text(s),l.val(s),i.chrom_select.append(l)}e.prev_chroms&&i.chrom_select.append(t('<option value="previous">Previous 100</option>')),e.next_chroms&&i.chrom_select.append(t('<option value="next">Next 100</option>')),i.chrom_start_index=e.start_index,n.resolve(e.chrom_info)}},error:function(){alert("Could not load chroms for this dbkey: "+i.dbkey)}}),n},change_chrom:function(e,i,n){var a=this;if(!a.chrom_data)return void a.load_chroms_deferred.then(function(){a.change_chrom(e,i,n)});if(e&&"None"!==e){if("previous"===e)return void a.load_chroms({low:this.chrom_start_index-100});if("next"===e)return void a.load_chroms({low:this.chrom_start_index+100});var r=t.grep(a.chrom_data,function(t,i){return t.chrom===e})[0];if(void 0===r)return void a.load_chroms({chrom:e},function(){a.change_chrom(e,i,n)});if(e!==a.chrom){a.chrom=e,a.chrom_select.val(a.chrom),a.max_high=r.len-1,a.reset();for(var o=0,s=a.drawables.length;o<s;o++){var l=a.drawables[o];l.init&&l.init()}a.reference_track&&a.reference_track.init()}void 0===i&&void 0===n?(a.low=0,a.high=a.max_high):(a.low=void 0!==i?Math.max(i,0):0,void 0===n?(a.low=Math.max(a.low-15,0),a.high=a.low+30):a.high=Math.min(n,a.max_high)),a.request_redraw()}},go_to:function(t){t=t.replace(/,/g,""),t=t.replace(/:|\-/g," ");var e=t.split(/\s+/),i=e[0],n=e[1]?parseInt(e[1],10):void 0,a=e[2]?parseInt(e[2],10):void 0;this.change_chrom(i,n,a)},move_fraction:function(t){var e=this,i=e.high-e.low;this.move_delta(t*i)},move_delta:function(t){var e=this,i=e.high-e.low;e.low-t<e.max_low?(e.low=e.max_low,e.high=e.max_low+i):e.high-t>e.max_high?(e.high=e.max_high,e.low=e.max_high-i):(e.high-=t,e.low-=t),e.request_redraw({data_fetch:!1}),this.redraw_on_move_fn&&clearTimeout(this.redraw_on_move_fn),this.redraw_on_move_fn=setTimeout(function(){e.request_redraw()},200);var n=e.chrom_select.val();this.trigger_navigate(n,e.low,e.high,!0)},add_drawable:function(t){q.prototype.add_drawable.call(this,t),t.init(),this.changed(),this.update_intro_div();var e=this;t.config.on("change",function(){e.changed()})},add_label_track:function(t){t.view=this,t.init(),this.label_tracks.push(t)},remove_drawable:function(e,i){if(q.prototype.remove_drawable.call(this,e),i){var n=this;e.container_div.hide(0,function(){t(this).remove(),n.update_intro_div()})}},reset:function(){this.low=this.max_low,this.high=this.max_high,this.viewport_container.find(".yaxislabel").remove()},request_redraw:function(t,e){var i=this,n=e?[e]:i.drawables;l.each(n,function(e){var n=l.find(i.tracks_to_be_redrawn,function(t){return t[0]===e});n?n[1]=t:i.tracks_to_be_redrawn.push([e,t])}),this.requested_redraw||(requestAnimationFrame(function(){i._redraw()}),this.requested_redraw=!0)},_redraw:function(){this.requested_redraw=!1;var t=this.low,e=this.high;t<this.max_low&&(t=this.max_low),e>this.max_high&&(e=this.max_high);var i=this.high-this.low;0!==this.high&&i<this.min_separation&&(e=t+this.min_separation),this.low=Math.floor(t),this.high=Math.ceil(e),this.update_location(this.low,this.high),this.resolution_px_b=this.viewport_container.width()/(this.high-this.low);var n=this.low/(this.max_high-this.max_low)*this.overview_viewport.width()||0,a=(this.high-this.low)/(this.max_high-this.max_low)*this.overview_viewport.width()||0;this.overview_box.css({left:n,width:Math.max(13,a)}).show(),a<13&&this.overview_box.css("left",n-(13-a)/2),this.overview_highlight&&this.overview_highlight.css({left:n,width:a}),l.each(this.tracks_to_be_redrawn,function(t){var e=t[0],i=t[1];e&&e._draw(i)}),this.tracks_to_be_redrawn=[],l.each(this.label_tracks,function(t){t._draw()})},zoom_in:function(t,e){if(!(0===this.max_high||this.high-this.low<=this.min_separation)){var i=this.high-this.low,n=i/2+this.low,a=i/this.zoom_factor/2;t&&(n=t/this.viewport_container.width()*(this.high-this.low)+this.low),this.low=Math.round(n-a),this.high=Math.round(n+a),this.changed(),this.request_redraw()}},zoom_out:function(){if(0!==this.max_high){var t=this.high-this.low,e=t/2+this.low,i=t*this.zoom_factor/2;this.low=Math.round(e-i),this.high=Math.round(e+i),this.changed(),this.request_redraw()}},resize_viewport:function(){this.viewport_container.height(this.container.height()-this.top_container.height()-this.bottom_container.height())},resize_window:function(){this.resize_viewport(),this.request_redraw()},set_overview:function(t){if(this.overview_drawable){if(this.overview_drawable.dataset.id===t.dataset.id)return;this.overview_viewport.find(".track").remove()}var e=t.copy({content_div:this.overview_viewport}),i=this;e.header_div.hide(),e.is_overview=!0,i.overview_drawable=e,this.overview_drawable.postdraw_actions=function(){i.overview_highlight.show().height(i.overview_drawable.content_div.height()),i.overview_viewport.height(i.overview_drawable.content_div.height()+i.overview_box.outerHeight()),i.overview_close.show(),i.resize_window()},i.overview_drawable.request_draw(),this.changed()},reset_overview:function(){t(".tooltip").remove(),this.overview_viewport.find(".track-tile").remove(),this.overview_viewport.height(this.default_overview_height),this.overview_box.height(this.default_overview_height),this.overview_close.hide(),this.overview_highlight.hide(),view.resize_window(),view.overview_drawable=null}});var L=C.default.Tool.extend({defaults:{track:null},initialize:function(t){C.default.Tool.prototype.initialize.call(this,t);var e=!0;void 0!==t.tool_state&&void 0!==t.tool_state.hidden&&(e=t.tool_state.hidden),this.set("hidden",e),this.remove_inputs(["data","hidden_data","conditional"])},state_dict:function(t){return l.extend(this.get_inputs_dict(),{hidden:!this.is_visible()})}}),N=n.View.extend({events:{"change :input":"update_value"},render:function(){var e=this.$el.addClass("param-row"),i=this.model;t("<div>").addClass("param-label").text(i.get("label")).appendTo(e);t("<div/>").addClass("param-input").html(i.get("html")).appendTo(e).find(":input").val(i.get("value")),t("<div style='clear: both;'/>").appendTo(e)},update_value:function(e){this.model.set_value(t(e.target).val())}}),B=n.View.extend({initialize:function(t){this.model.on("change:hidden",this.set_visible,this)},render:function(){var e=this,i=this.model,n=this.$el.addClass("dynamic-tool").hide();n.bind("drag",function(t){t.stopPropagation()}).click(function(t){t.stopPropagation()}).bind("dblclick",function(t){t.stopPropagation()}).keydown(function(t){t.stopPropagation()});t("<div class='tool-name'>").appendTo(n).text(i.get("name"));i.get("inputs").each(function(t){var e=new N({model:t});e.render(),n.append(e.$el)}),n.find("input").click(function(){t(this).select()});var a=t("<div>").addClass("param-row").appendTo(n),r=t("<input type='submit'>").attr("value","Run on complete dataset").appendTo(a);t("<input type='submit'>").attr("value","Run on visible region").appendTo(a).click(function(){e.run_on_region()}),r.click(function(){e.run_on_dataset()}),i.is_visible()&&this.$el.show()},set_visible:function(){this.$el.toggle(this.model.is_visible())},update_params:function(){for(var t=0;t<this.params.length;t++)this.params[t].update_value()},run_on_dataset:function(){var t=this.model;this.run({target_dataset_id:this.model.get("track").dataset.id,action:"rerun",tool_id:t.id},null,function(e){Galaxy.modal.show({title:t.get("name")+" is Running",body:t.get("name")+" is running on the complete dataset. Tool outputs are in dataset's history.",buttons:{Close:function(){Galaxy.modal.hide()}}})})},run_on_region:function(){var t,e=this.model.get("track"),i=this.model,n=new c.default.GenomeRegion({chrom:e.view.chrom,start:e.view.low,end:e.view.high}),a={target_dataset_id:e.dataset.id,action:"rerun",tool_id:i.id,regions:[n.toJSON()]},r=e,o=i.get("name")+r.tool_region_and_parameters_str(n);if(r.container===view){var s=new D(view,view,{name:e.config.get_value("name")}),l=r.container.replace_drawable(r,s,!1);s.container_div.insertBefore(r.view.content_div.children()[l]),s.add_drawable(r),r.container_div.appendTo(s.content_div),t=s}else t=r.container;var d=new r.constructor(view,t,{name:o,hda_ldda:"hda"});d.init_for_tool_data(),d.change_mode(r.mode),d.set_filters_manager(r.filters_manager.copy(d)),d.update_icons(),t.add_drawable(d),d.tiles_div.text("Starting job."),this.run(a,d,function(t){d.set_dataset(new x.default.Dataset(t)),d.tiles_div.text("Running job."),d.init()})},run:function(e,i,n){e.inputs=this.model.get_inputs_dict();var a=new p.default.ServerStateDeferred({ajax_settings:{url:Galaxy.root+"api/tools",data:JSON.stringify(e),dataType:"json",contentType:"application/json",type:"POST"},interval:2e3,success_fn:function(t){return"pending"!==t}});t.when(a.go()).then(function(t){"no converter"===t?(i.container_div.addClass("error"),i.content_div.text(R)):t.error?(i.container_div.addClass("error"),i.content_div.text("Tool cannot be rerun: "+t.message)):n(t)})}}),V=function(t,e){v.default.Scaler.call(this,e),this.filter=t};V.prototype.gen_val=function(t){return this.filter.high===Number.MAX_VALUE||this.filter.low===-Number.MAX_VALUE||this.filter.low===this.filter.high?this.default_val:(parseFloat(t[this.filter.index])-this.filter.low)/(this.filter.high-this.filter.low)};var G=function(e,i,n,a,r){this.track=e,this.region=i,this.low=i.get("start"),this.high=i.get("end"),this.w_scale=n,this.canvas=a,this.html_elt=t("<div class='track-tile'/>").append(a),this.data=r,this.stale=!1};G.prototype.predisplay_actions=function(){};var U=function(t,e,i,n,a){G.call(this,t,e,i,n,a)};U.prototype.predisplay_actions=function(){};var F=function(t,e,i,n,a,r,o,s,l,d,c){G.call(this,t,e,i,n,a),this.mode=r,this.all_slotted=s,this.feature_mapper=l,this.has_icons=!1,this.incomplete_features=d,this.other_tiles_features_drawn={},this.seq_data=c};O(F.prototype,G.prototype),F.prototype.predisplay_actions=function(){};var H=function(e,i,a){O(a,{drag_handle_class:"draghandle"}),j.call(this,e,i,a),this.dataset=null,a.dataset&&(this.dataset=a.dataset instanceof n.Model?a.dataset:new x.default.Dataset(a.dataset)),this.dataset_check_type="converted_datasets_state",this.data_url_extra_params={},this.data_query_wait="data_query_wait"in a?a.data_query_wait:5e3,this.data_manager="data_manager"in a?a.data_manager:new c.default.GenomeDataManager({dataset:this.dataset,genome:new c.default.Genome({key:e.dbkey,chroms_info:{chrom_info:e.chrom_data}}),data_mode_compatible:this.data_and_mode_compatible,can_subset:this.can_subset}),this.min_height_px=16,this.max_height_px=800,this.visible_height_px=this.config.get_value("height"),this.content_div=t("<div class='track-content'>").appendTo(this.container_div),this.container&&(this.container.content_div.append(this.container_div),"resize"in a&&!a.resize||this.add_resize_handle())};O(H.prototype,j.prototype,{action_icons_def:[{name:"mode_icon",title:"Set display mode",css_class:"chevron-expand",on_click_fn:function(){}},j.prototype.action_icons_def[0],{name:"overview_icon",title:"Set as overview",css_class:"application-dock-270",on_click_fn:function(t){t.view.set_overview(t)}},j.prototype.action_icons_def[1],{name:"filters_icon",title:"Filters",css_class:"ui-slider-050",on_click_fn:function(t){t.filters_manager.visible()?t.filters_manager.clear_filters():t.filters_manager.init_filters(),t.filters_manager.toggle()}},{name:"tools_icon",title:"Tool",css_class:"hammer",on_click_fn:function(e){e.tool.toggle(),e.tool.is_visible()?e.set_name(e.config.get_value("name")+e.tool_region_and_parameters_str()):e.revert_name(),t(".tooltip").remove()}},{name:"param_space_viz_icon",title:"Tool parameter space visualization",css_class:"arrow-split",on_click_fn:function(e){var i="<strong>Tool</strong>:"+e.tool.get("name")+"<br/><strong>Dataset</strong>:"+e.config.get_value("name")+'<br/><strong>Region(s)</strong>: <select name="regions"><option value="cur">current viewing area</option><option value="bookmarks">bookmarks</option><option value="both">current viewing area and bookmarks</option></select>',a=function(){Galaxy.modal.hide(),t(window).unbind("keypress.check_enter_esc")},r=function(){var i,a=t('select[name="regions"] option:selected').val(),r=new c.default.GenomeRegion({chrom:view.chrom,start:view.low,end:view.high}),o=l.map(t(".bookmark"),function(e){return new c.default.GenomeRegion({from_str:t(e).children(".position").text()})});i="cur"===a?[r]:"bookmarks"===a?o:[r].concat(o),Galaxy.modal.hide(),window.location.href=Galaxy.root+"visualization/sweepster?"+t.param({dataset_id:e.dataset.id,hda_ldda:e.dataset.get("hda_ldda"),regions:JSON.stringify(new n.Collection(i).toJSON())})};Galaxy.modal.show({title:"Visualize tool parameter space and output from different parameter settings?",body:i,buttons:{No:a,Yes:r}})}},j.prototype.action_icons_def[2]],can_draw:function(){return this.dataset&&j.prototype.can_draw.call(this)},build_container_div:function(){return t("<div/>").addClass("track").attr("id","track_"+this.id)},set_dataset:function(t){this.dataset=t,this.data_manager.set("dataset",t)},on_resize:function(){this.request_draw({clear_tile_cache:!0})},add_resize_handle:function(){var e=this,i=!1,n=!1,a=t("<div class='track-resize'>");t(e.container_div).hover(function(){e.config.get_value("content_visible")&&(i=!0,a.show())},function(){i=!1,n||a.hide()}),a.hide().bind("dragstart",function(i,a){n=!0,a.original_height=t(e.content_div).height()}).bind("drag",function(i,n){var a=Math.min(Math.max(n.original_height+n.deltaY,e.min_height_px),e.max_height_px);t(e.tiles_div).css("height",a),e.visible_height_px=e.max_height_px===a?0:a,e.on_resize()}).bind("dragend",function(t,r){e.tile_cache.clear(),n=!1,i||a.hide(),e.config.set_value("height",e.visible_height_px),e.changed()}).appendTo(e.container_div)},hide_contents:function(){this.tiles_div.hide(),this.container_div.find(".yaxislabel, .track-resize").hide()},show_contents:function(){this.tiles_div.show(),this.container_div.find(".yaxislabel, .track-resize").show(),this.request_draw()},get_type:function(){return this instanceof X?"LabelTrack":this instanceof W?"ReferenceTrack":this instanceof K?"LineTrack":this instanceof et?"ReadTrack":this instanceof tt?"VariantTrack":this instanceof J?"CompositeTrack":this instanceof Q?"FeatureTrack":""},show_message:function(e){return this.tiles_div.remove(),t("<span/>").addClass("message").html(e).appendTo(this.content_div)},init:function(e){var i=this;if(i.enabled=!1,i.tile_cache.clear(),i.data_manager.clear(),i.content_div.children().remove(),i.container_div.removeClass("nodata error pending"),i.tiles_div=t("<div/>").addClass("tiles").appendTo(i.content_div),i.dataset.id){var n=t.Deferred(),a={hda_ldda:i.dataset.get("hda_ldda"),data_type:this.dataset_check_type,chrom:i.view.chrom,retry:e};return t.getJSON(this.dataset.url(),a,function(e){if(e&&"error"!==e&&"error"!==e.kind)"no converter"===e?(i.container_div.addClass("error"),i.show_message(R)):"no data"===e||void 0!==e.data&&(null===e.data||0===e.data.length)?(i.container_div.addClass("nodata"),i.show_message("No data for this chrom/contig.")):"pending"===e?(i.container_div.addClass("pending"),i.show_message("Preparing data. This can take a while for a large dataset. If the visualization is saved and closed, preparation will continue in the background."),setTimeout(function(){i.init()},i.data_query_wait)):"data"!==e&&"data"!==e.status||(e.valid_chroms&&(i.valid_chroms=e.valid_chroms,i.update_icons()),i.tiles_div.text("Ready for display"),i.view.chrom?(i.tiles_div.text(""),i.tiles_div.css("height",i.visible_height_px+"px"),i.enabled=!0,t.when.apply(t,i.predraw_init()).done(function(){n.resolve(),i.container_div.removeClass("nodata error pending"),i.request_draw()})):n.resolve());else{i.container_div.addClass("error");var a=i.show_message("Cannot display dataset due to an error. ");e.message&&(a.append(t("<a href='javascript:void(0);'></a>").text("View error").click(function(){Galaxy.modal.show({title:"Trackster Error",body:"<pre>"+e.message+"</pre>",buttons:{Close:function(){Galaxy.modal.hide()}}})})),a.append(t("<span/>").text(" ")),a.append(t("<a href='javascript:void(0);'></a>").text("Try again").click(function(){i.init(!0)})))}}),this.update_icons(),n}},predraw_init:function(){var e=this;return t.getJSON(e.dataset.url(),{data_type:"data",stats:!0,chrom:e.view.chrom,low:0,high:e.view.max_high,hda_ldda:e.dataset.get("hda_ldda")},function(t){var i=t.data;if(i&&void 0!==i.min&&void 0!==i.max){var n=i.min,a=i.max;n=Math.floor(Math.min(0,Math.max(n,i.mean-2*i.sd))),a=Math.ceil(Math.max(0,Math.min(a,i.mean+2*i.sd))),e.config.set_default_value("min_value",n),e.config.set_default_value("max_value",a),e.config.set_value("min_value",n),e.config.set_value("max_value",a)}})},get_drawables:function(){return this}});var Y=function(e,i,n){H.call(this,e,i,n);var a=this;if(z(a.container_div,a.drag_handle_class,".group",a),this.filters_manager=new w.default.FiltersManager(this,"filters"in n?n.filters:null),this.data_manager.set("filters_manager",this.filters_manager),this.filters_available=!1,this.tool=n.tool?new L(l.extend(n.tool,{track:this,tool_state:n.tool_state})):null,this.tile_cache=new c.default.Cache(10),this.left_offset=0,this.header_div&&(this.set_filters_manager(this.filters_manager),this.tool)){var r=new B({model:this.tool});r.render(),this.dynamic_tool_div=r.$el,this.header_div.after(this.dynamic_tool_div)}this.tiles_div=t("<div/>").addClass("tiles").appendTo(this.content_div),this.config.get_value("content_visible")||this.tiles_div.hide(),this.overlay_div=t("<div/>").addClass("overlay").appendTo(this.content_div),n.mode&&this.change_mode(n.mode)};O(Y.prototype,j.prototype,H.prototype,{action_icons_def:H.prototype.action_icons_def.concat([{name:"show_more_rows_icon",title:"To minimize track height, not all feature rows are displayed. Click to display more rows.",css_class:"exclamation",on_click_fn:function(e){t(".tooltip").remove(),e.slotters[e.view.resolution_px_b].max_rows*=2,e.request_draw({clear_tile_cache:!0})},hide:!0}]),copy:function(t){var e=this.to_dict();O(e,{data_manager:this.data_manager});var i=new this.constructor(this.view,t,e);return i.change_mode(this.mode),i.enabled=this.enabled,i},set_filters_manager:function(t){this.filters_manager=t,this.header_div.after(this.filters_manager.parent_div)},to_dict:function(){return{track_type:this.get_type(),dataset:{id:this.dataset.id,hda_ldda:this.dataset.get("hda_ldda")},prefs:this.config.to_key_value_dict(),mode:this.mode,filters:this.filters_manager.to_dict(),tool_state:this.tool?this.tool.state_dict():{}}},set_min_max:function(){var e=this;return t.getJSON(e.dataset.url(),{data_type:"data",stats:!0,chrom:e.view.chrom,low:0,high:e.view.max_high,hda_ldda:e.dataset.get("hda_ldda")},function(t){var i=t.data;if(isNaN(parseFloat(e.config.get_value("min_value")))||isNaN(parseFloat(e.config.get_value("max_value")))){var n=i.min,a=i.max;n=Math.floor(Math.min(0,Math.max(n,i.mean-2*i.sd))),a=Math.ceil(Math.max(0,Math.min(a,i.mean+2*i.sd))),e.config.set_value("min_value",n),e.config.set_value("max_value",a)}})},change_mode:function(t){var e=this;return e.mode=t,e.config.set_value("mode",t),"Auto"===t&&this.data_manager.clear(),e.request_draw({clear_tile_cache:!0}),this.action_icons.mode_icon.attr("title","Set display mode (now: "+e.mode+")"),e},update_icons:function(){var t=this;t.action_icons.filters_icon.toggle(t.filters_available),t.action_icons.tools_icon.toggle(null!==t.tool),t.action_icons.param_space_viz_icon.toggle(null!==t.tool)},_gen_tile_cache_key:function(t,e){return t+"_"+e},request_draw:function(t){t&&t.clear_tile_cache&&this.tile_cache.clear(),this.view.request_redraw(t,this)},before_draw:function(){this.max_height_px=0},_draw:function(e){if(this.can_draw()){var i=e&&e.clear_after,n=this.view.low,a=this.view.high,r=this.view.container.width(),o=this.view.resolution_px_b,s=1/o;this.is_overview&&(n=this.view.max_low,a=this.view.max_high,o=r/(view.max_high-view.max_low),s=1/o),this.before_draw(),this.tiles_div.children().addClass("remove");for(var d,u,h=Math.floor(400*s),f=Math.floor(n/h),p=[],_=[];f*h<a;)d=new c.default.GenomeRegion({chrom:this.view.chrom,start:f*h,end:Math.min((f+1)*h,this.view.max_high)}),u=this.draw_helper(d,o,e),p.push(u),t.when(u).then(function(t){_.push(t)}),f+=1;i||this.tiles_div.children(".remove").removeClass("remove").remove();var m=this;t.when.apply(t,p).then(function(){m.tiles_div.children(".remove").remove(),_=l.filter(_,function(t){return null!==t}),0!==_.length&&m.postdraw_actions(_,r,o,i)})}},_add_yaxis_label:function(e,i){var n=this,a="max"===e?"top":"bottom",o="max"===e?"max":"min",s="max"===e?"max_value":"min_value",l=this.container_div.find(".yaxislabel."+a),d=r(n.config.get_value(s),1);i=i||function(){n.request_draw({clear_tile_cache:!0})},0!==l.length?l.text(d):(l=t("<div/>").text(d).make_text_editable({num_cols:12,on_finish:function(e){t(".tooltip").remove(),n.config.set_value(s,r(e,1)),i()},help_text:"Set "+o+" value"}).addClass("yaxislabel "+a).css("color",this.config.get_value("label_color")),this.container_div.prepend(l))},postdraw_actions:function(t,e,i,n){if(l.filter(t,function(t){return t instanceof U}).length>0){this.max_height_px=0;var a=this;l.each(t,function(t){t instanceof U||(t.html_elt.remove(),a.draw_helper(t.region,i,{force:!0,mode:"Coverage"}))}),a._add_yaxis_label("max")}else this.container_div.find(".yaxislabel").remove(),l.find(t,function(t){return t.has_icons})&&l.each(t,function(t){t.has_icons||t.html_elt.css("padding-top",20)})},get_mode:function(t){return this.mode},update_auto_mode:function(t){},_get_drawables:function(){return[this]},draw_helper:function(e,i,n){n||(n={});var a=n.force,r=n.mode||this.mode,o=1/i,s=this,d=this._get_drawables(),c=this._gen_tile_cache_key(i,e),u=a?void 0:s.tile_cache.get_elt(c);if(u)return function(t){return t&&"track"in t}(u)&&s.show_tile(u,i),u;if(!1===n.data_fetch)return null;var h=function(){var t=l.find(P,function(t){return t===r})?"Coverage":r,i=l.map(d,function(i){return i.data_manager.get_data(e,t,o,s.data_url_extra_params)});return view.reference_track&&i.push(view.reference_track.data_manager.get_data(e,r,o,view.reference_track.data_url_extra_params)),i},f=t.Deferred();return s.tile_cache.set_elt(c,f),t.when.apply(t,h()).then(function(){var a,r=h(),o=r;if(l.find(r,function(t){return p.default.is_deferred(t)}))return s.tile_cache.set_elt(c,void 0),void t.when(s.draw_helper(e,i,n)).then(function(t){f.resolve(t)});view.reference_track&&(a=view.reference_track.data_manager.subset_entry(r.pop(),e));var u=[],_=[];l.each(d,function(t,e){var n=t.mode,a=o[e];"Auto"===n&&(n=t.get_mode(a),t.update_auto_mode(n)),u.push(n),_.push(t.get_canvas_height(a,n,i,w))});var m,g=s.view.canvas_manager.new_canvas(),v=e.get("start"),b=e.get("end"),w=Math.ceil((b-v)*i)+s.left_offset,y=l.max(_);g.width=w,g.height=n.height||y;var x=g.getContext("2d");x.translate(s.left_offset,0),d.length>1&&(x.globalAlpha=.5,x.globalCompositeOperation="source-over"),l.each(d,function(t,n){m=t.draw_tile(o[n],x,u[n],e,i,a)}),void 0!==m&&(s.tile_cache.set_elt(c,m),s.show_tile(m,i)),f.resolve(m)}),f},get_canvas_height:function(t,e,i,n){return this.visible_height_px},_draw_line_track_tile:function(t,e,i,n,a){-1!==[void 0,null].indexOf(this.config.get_value("min_value"))&&this.config.set_value("min_value",0),-1!==[void 0,null,0].indexOf(this.config.get_value("max_value"))&&this.config.set_value("max_value",l.max(l.map(t.data,function(t){return t[1]}))||0);var r=e.canvas;return new v.default.LinePainter(t.data,n.get("start"),n.get("end"),this.config.to_key_value_dict(),i).draw(e,r.width,r.height,a),new U(this,n,a,r,t.data)},draw_tile:function(t,e,i,n,a,r){},show_tile:function(t,e){var i=t.html_elt;t.predisplay_actions();var n=Math.round((t.low-(this.is_overview?this.view.max_low:this.view.low))*e);this.left_offset&&(n-=this.left_offset),i.css("left",n),i.hasClass("remove")?i.removeClass("remove"):this.tiles_div.append(i),i.css("height","auto"),this.max_height_px=Math.max(this.max_height_px,i.height()-2),i.parent().children().css("height",this.max_height_px+"px");var a=this.max_height_px;0!==this.visible_height_px&&(a=Math.min(this.max_height_px,this.visible_height_px)),this.tiles_div.css("height",a+"px")},tool_region_and_parameters_str:function(t){var e=this;return" - region=["+(void 0!==t?t.toString():"all")+"], parameters=["+l.values(e.tool.get_inputs_dict()).join(", ")+"]"},data_and_mode_compatible:function(t,e){return"Auto"===e||("Coverage"===e?"bigwig"===t.dataset_type:"bigwig"!==t.dataset_type&&"no_detail"!==t.extra_info)},can_subset:function(t){return!t.message&&"no_detail"!==t.extra_info&&("bigwig"!==t.dataset_type||t.data[1][0]-t.data[0][0]==1)},init_for_tool_data:function(){this.data_manager.set("data_type","raw_data"),this.data_query_wait=1e3,this.dataset_check_type="state"}});var X=function(t,e){H.call(this,t,e,{resize:!1,header:!1}),this.container_div.addClass("label-track")};O(X.prototype,H.prototype,{init:function(){this.enabled=!0},predraw_init:function(){},_draw:function(e){for(var i=this.view,n=i.high-i.low,a=Math.floor(Math.pow(10,Math.floor(Math.log(n)/Math.log(10)))),r=Math.floor(i.low/a)*a,o=this.view.container.width(),s=t("<div/>").addClass("label-container");r<i.high;){var l=Math.floor((r-i.low)/n*o);s.append(t("<div/>").addClass("pos-label").text(p.default.commatize(r)).css({left:l})),r+=a}this.content_div.children(":first").remove(),this.content_div.append(s)}});var J=function(t,e,i){if(Y.call(this,t,e,i),this.drawables=[],"drawables"in i){for(var n,a=0;a<i.drawables.length;a++)n=i.drawables[a],this.drawables[a]=nt(n,t,null),n.left_offset>this.left_offset&&(this.left_offset=n.left_offset);this.enabled=!0}l.each(this.drawables,function(t){(t instanceof Q||t instanceof et)&&t.change_mode("Coverage")}),this.update_icons(),this.obj_type="CompositeTrack"};O(J.prototype,Y.prototype,{display_modes:P,build_config_params:function(){return l.union(j.prototype.config_params,[{key:"min_value",label:"Min Value",type:"float",default_value:void 0},{key:"max_value",label:"Max Value",type:"float",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:30,hidden:!0}])},action_icons_def:[{name:"composite_icon",title:"Show individual tracks",css_class:"layers-stack",on_click_fn:function(e){t(".tooltip").remove(),e.show_group()}}].concat(Y.prototype.action_icons_def),to_dict:q.prototype.to_dict,add_drawable:q.prototype.add_drawable,unpack_drawables:q.prototype.unpack_drawables,config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},on_resize:function(){var t=this.visible_height_px;l.each(this.drawables,function(e){e.visible_height_px=t}),H.prototype.on_resize.call(this)},change_mode:function(t){Y.prototype.change_mode.call(this,t);for(var e=0;e<this.drawables.length;e++)this.drawables[e].change_mode(t)},init:function(){for(var e=[],i=0;i<this.drawables.length;i++)e.push(this.drawables[i].init());var n=this;t.when.apply(t,e).then(function(){n.enabled=!0,n.request_draw()})},update_icons:function(){this.action_icons.filters_icon.hide(),this.action_icons.tools_icon.hide(),this.action_icons.param_space_viz_icon.hide()},can_draw:j.prototype.can_draw,_get_drawables:function(){return this.drawables},show_group:function(){for(var t,e=new D(this.view,this.container,{name:this.config.get_value("name")}),i=0;i<this.drawables.length;i++)t=this.drawables[i],t.update_icons(),e.add_drawable(t),t.container=e,e.content_div.append(t.container_div);this.container.replace_drawable(this,e,!0);e.request_draw({clear_tile_cache:!0})},before_draw:function(){var t=l.min(l.map(this.drawables,function(t){return t.config.get_value("min_value")})),e=l.max(l.map(this.drawables,function(t){return t.config.get_value("max_value")}));this.config.set_value("min_value",t),this.config.set_value("max_value",e),l.each(this.drawables,function(i){i.config.set_value("min_value",t),i.config.set_value("max_value",e)})},update_all_min_max:function(){var t=this.config.get_value("min_value"),e=this.config.get_value("max_value");l.each(this.drawables,function(i){i.config.set_value("min_value",t),i.config.set_value("max_value",e)}),this.request_draw({clear_tile_cache:!0})},postdraw_actions:function(t,e,i,n){var a,r=-1;for(a=0;a<t.length;a++){var o=t[a].html_elt.find("canvas").height();o>r&&(r=o)}for(a=0;a<t.length;a++){var s=t[a];s.html_elt.find("canvas").height()!==r&&(this.draw_helper(s.region,i,{force:!0,height:r}),s.html_elt.remove())}var l=this,d=function(){l.update_all_min_max()};this._add_yaxis_label("min",d),this._add_yaxis_label("max",d)}});var W=function(t){Y.call(this,t,{content_div:t.top_labeltrack},{resize:!1,header:!1}),this.left_offset=t.canvas_manager.char_width_px,this.container_div.addClass("reference-track"),this.data_url=Galaxy.root+"api/genomes/"+this.view.dbkey,this.data_url_extra_params={reference:!0},this.data_manager=new c.default.GenomeReferenceDataManager({data_url:this.data_url,can_subset:this.can_subset}),this.hide_contents()};O(W.prototype,j.prototype,Y.prototype,{build_config_params:function(){return l.union(j.prototype.config_params,[{key:"height",type:"int",default_value:13,hidden:!0}])},init:function(){this.data_manager.clear(),this.enabled=!0},predraw_init:function(){},can_draw:j.prototype.can_draw,draw_helper:function(t,e,i){var n,a=this.tiles_div.is(":visible"),r=null;return e>this.view.canvas_manager.char_width_px?(this.tiles_div.show(),n=!0,r=Y.prototype.draw_helper.call(this,t,e,i)):(n=!1,this.tiles_div.hide()),a!==n&&this.view.resize_viewport(),r},can_subset:function(t){return!0},draw_tile:function(t,e,i,n,a){var r=this.data_manager.subset_entry(t,n),o=r.data,s=e.canvas;e.font=e.canvas.manager.default_font,e.textAlign="center";for(var l=0,d=o.length;l<d;l++)e.fillStyle=this.view.get_base_color(o[l]),e.fillText(o[l],Math.floor(l*a),10);return new G(this,n,a,s,r)}});var K=function(e,i,n){this.mode="Histogram",Y.call(this,e,i,n),this.left_offset=30;var a=this;t.when(o(Galaxy.root+"datasets/"+this.dataset.id+"/display")).then(function(t){t&&(a.data_manager=new M.default.BBIDataManager({dataset:a.dataset}))})};O(K.prototype,j.prototype,Y.prototype,{display_modes:P,build_config_params:function(){return l.union(j.prototype.config_params,[{key:"color",label:"Color",type:"color"},{key:"min_value",label:"Min Value",type:"float",default_value:void 0},{key:"max_value",label:"Max Value",type:"float",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:30,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},before_draw:function(){},draw_tile:function(t,e,i,n,a){return this._draw_line_track_tile(t,e,i,n,a)},can_subset:function(t){return t.data[1][0]-t.data[0][0]==1},postdraw_actions:function(t,e,i,n){this._add_yaxis_label("max"),this._add_yaxis_label("min")}});var Z=function(t,e,i){this.mode="Heatmap",Y.call(this,t,e,i)};O(Z.prototype,j.prototype,Y.prototype,{display_modes:["Heatmap"],build_config_params:function(){return l.union(j.prototype.config_params,[{key:"pos_color",label:"Positive Color",type:"color",default_value:"#FF8C00"},{key:"neg_color",label:"Negative Color",type:"color",default_value:"#4169E1"},{key:"min_value",label:"Min Value",type:"int",default_value:void 0},{key:"max_value",label:"Max Value",type:"int",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:500,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},predraw_init:function(){var e=this;return t.getJSON(e.dataset.url(),{data_type:"data",stats:!0,chrom:e.view.chrom,low:0,high:e.view.max_high,hda_ldda:e.dataset.get("hda_ldda")},function(t){t.data})},draw_tile:function(t,e,i,n,a){var r=e.canvas;return new v.default.DiagonalHeatmapPainter(t.data,n.get("start"),n.get("end"),this.config.to_key_value_dict(),i).draw(e,r.width,r.height,a),new G(this,n,a,r,t.data)}});var Q=function(t,e,i){Y.call(this,t,e,i),this.container_div.addClass("feature-track"),this.summary_draw_height=30,this.slotters={},this.start_end_dct={},this.left_offset=200,this.set_painter_from_config()};O(Q.prototype,j.prototype,Y.prototype,{display_modes:["Auto","Coverage","Dense","Squish","Pack"],build_config_params:function(){return l.union(j.prototype.config_params,[{key:"block_color",label:"Block color",type:"color"},{key:"reverse_strand_color",label:"Antisense strand color",type:"color"},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0,help:"Show the number of items in each bin when drawing summary histogram"},{key:"min_value",label:"Histogram minimum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"max_value",label:"Histogram maximum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"connector_style",label:"Connector style",type:"select",default_value:"fishbones",options:[{label:"Line with arrows",value:"fishbone"},{label:"Arcs",value:"arcs"}]},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:0,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.set_painter_from_config(),this.request_draw({clear_tile_cache:!0})},set_painter_from_config:function(){"arcs"===this.config.get_value("connector_style")?this.painter=v.default.ArcLinkedFeaturePainter:this.painter=v.default.LinkedFeaturePainter},postdraw_actions:function(e,i,n,a){Y.prototype.postdraw_actions.call(this,e,i,n,a);var r,o=this;if(0===l.filter(e,function(t){return t instanceof U}).length){var s={};l.each(l.pluck(e,"incomplete_features"),function(t){l.each(t,function(t){s[t[0]]=t})});var d=this;l.each(e,function(e){var i=l.omit(s,l.map(e.incomplete_features,function(t){return t[0]}));if(i=l.omit(i,l.keys(e.other_tiles_features_drawn)),0!==l.size(i)){var n={data:l.values(i)},a=d.view.canvas_manager.new_canvas(),r=a.getContext("2d");a.height=Math.max(e.canvas.height,d.get_canvas_height(n,e.mode,e.w_scale,100)),a.width=e.canvas.width,r.drawImage(e.canvas,0,0),r.translate(o.left_offset,0);var c=d.draw_tile(n,r,e.mode,e.region,e.w_scale,e.seq_data);t(e.canvas).replaceWith(t(c.canvas)),e.canvas=a,l.extend(e.other_tiles_features_drawn,s)}})}if(o.filters_manager){var c,u=o.filters_manager.filters;for(c=0;c<u.length;c++)u[c].update_ui_elt();var h,f,p=!1;for(r=0;r<e.length;r++)if(e[r].data.length)for(h=e[r].data[0],c=0;c<u.length;c++)if(f=u[c],f.applies_to(h)&&f.min!==f.max){p=!0;break}o.filters_available!==p&&(o.filters_available=p,o.filters_available||o.filters_manager.hide(),o.update_icons())}if(e[0]instanceof F){var _=!0;for(r=0;r<e.length;r++)if(!e[r].all_slotted){_=!1;break}this.action_icons.show_more_rows_icon.toggle(!_)}else this.action_icons.show_more_rows_icon.hide()},update_auto_mode:function(t){"Auto"===this.mode&&("no_detail"===t&&(t="feature spans"),this.action_icons.mode_icon.attr("title","Set display mode (now: Auto/"+t+")"))},incremental_slots:function(t,e,i){var n=this.view.canvas_manager.dummy_context,a=this.slotters[t];return a&&a.mode===i||(a=new m.default.FeatureSlotter(t,i,100,function(t){return n.measureText(t)}),this.slotters[t]=a),a.slot_features(e)},get_mode:function(t){return"no_detail"===t.extra_info||this.is_overview?"no_detail":this.view.high-this.view.low>12e3?"Squish":"Pack"},get_canvas_height:function(t,e,i,n){if("Coverage"===e||"bigwig"===t.dataset_type)return this.summary_draw_height;var a=this.incremental_slots(i,t.data,e),r=new this.painter(null,null,null,this.config.to_key_value_dict(),e);return Math.max(this.min_height_px,r.get_required_height(a,n))},draw_tile:function(t,e,i,n,a,r,o){var s=this,l=e.canvas,d=n.get("start"),c=n.get("end"),u=this.left_offset;if("bigwig"===t.dataset_type)return this._draw_line_track_tile(t,e,i,n,a);var h=[],f=this.slotters[a].slots,p=!0;if(t.data)for(var _=this.filters_manager.filters,m=0,g=t.data.length;m<g;m++){for(var v,b=t.data[m],w=!1,y=0,x=_.length;y<x;y++)if(v=_[y],v.update_attrs(b),!v.keep(b)){w=!0;break}w||(h.push(b),b[0]in f||(p=!1))}var k=this.filters_manager.alpha_filter?new V(this.filters_manager.alpha_filter):null,C=this.filters_manager.height_filter?new V(this.filters_manager.height_filter):null,S=new this.painter(h,d,c,this.config.to_key_value_dict(),i,k,C,r,function(t){return s.view.get_base_color(t)}),$=null;if(e.fillStyle=this.config.get_value("block_color"),e.font=e.canvas.manager.default_font,e.textAlign="right",t.data){var T=S.draw(e,l.width,l.height,a,f);$=T.feature_mapper,incomplete_features=T.incomplete_features,$.translation=-u}return o?void 0:new F(s,n,a,l,t.data,i,t.message,p,$,incomplete_features,r)}});var tt=function(t,e,i){Y.call(this,t,e,i),this.painter=v.default.VariantPainter,this.summary_draw_height=30,this.left_offset=30};O(tt.prototype,j.prototype,Y.prototype,{display_modes:["Auto","Coverage","Dense","Squish","Pack"],build_config_params:function(){return l.union(j.prototype.config_params,[{key:"color",label:"Histogram color",type:"color"},{key:"show_sample_data",label:"Show sample data",type:"bool",default_value:!0},{key:"show_labels",label:"Show summary and sample labels",type:"bool",default_value:!0},{key:"summary_height",label:"Locus summary height",type:"float",default_value:20},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:0,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},draw_tile:function(t,e,i,n,a){if("bigwig"===t.dataset_type)return this._draw_line_track_tile(t,e,"Histogram",n,a);var r=this.view;return new this.painter(t.data,n.get("start"),n.get("end"),this.config.to_key_value_dict(),i,function(t){return r.get_base_color(t)}).draw(e,e.canvas.width,e.canvas.height,a),new G(this,n,a,e.canvas,t.data)},get_canvas_height:function(t,e,i,n){if("bigwig"===t.dataset_type)return this.summary_draw_height;var a=this.dataset.get_metadata("sample_names")?this.dataset.get_metadata("sample_names").length:0;return 0===a&&0!==t.data.length&&(a=t.data[0][7].match(/,/g),a=null===a?1:a.length+1),new this.painter(null,null,null,this.config.to_key_value_dict(),e).get_required_height(a)},predraw_init:function(){var t=[H.prototype.predraw_init.call(this)];return this.dataset.get_metadata("sample_names")||t.push(this.dataset.fetch()),t},postdraw_actions:function(e,i,n,a){Y.prototype.postdraw_actions.call(this,e,i,n,a);var r=l.filter(e,function(t){return t instanceof U}),o=this.dataset.get_metadata("sample_names");if(0===r.length&&this.config.get_value("show_labels")&&o&&o.length>1){var s;if(0===this.container_div.find(".yaxislabel.variant").length&&(s=this.config.get_value("summary_height")/2,this.tiles_div.prepend(t("<div/>").text("Summary").addClass("yaxislabel variant top").css({"font-size":s+"px",top:(this.config.get_value("summary_height")-s)/2+"px"})),this.config.get_value("show_sample_data"))){var d=o.join("<br/>");this.tiles_div.prepend(t("<div/>").html(d).addClass("yaxislabel variant top sample").css({top:this.config.get_value("summary_height")}))}s=("Squish"===this.mode?5:10)+"px",t(this.tiles_div).find(".sample").css({"font-size":s,"line-height":s}),t(this.tiles_div).find(".yaxislabel").css("color",this.config.get_value("label_color"))}else this.container_div.find(".yaxislabel.variant").remove()}});var et=function(t,e,i){Q.call(this,t,e,i),this.painter=v.default.ReadPainter,this.update_icons()};O(et.prototype,j.prototype,Y.prototype,Q.prototype,{build_config_params:function(){return l.union(j.prototype.config_params,[{key:"block_color",label:"Histogram color",type:"color"},{key:"detail_block_color",label:"Sense strand block color",type:"color",default_value:"#AAAAAA"},{key:"reverse_strand_color",label:"Antisense strand block color",type:"color",default_value:"#DDDDDD"},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_insertions",label:"Show insertions",type:"bool",default_value:!1},{key:"show_differences",label:"Show differences only",type:"bool",default_value:!0},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"min_value",label:"Histogram minimum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"max_value",label:"Histogram maximum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"height",type:"int",default_value:0,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})}});var it={CompositeTrack:J,DrawableGroup:D,DiagonalHeatmapTrack:Z,FeatureTrack:Q,LineTrack:K,ReadTrack:et,VariantTrack:tt,VcfTrack:tt},nt=function(t,e,i){if("copy"in t)return t.copy(i);var n=t.obj_type;return n||(n=t.track_type),new it[n](e,i,t)};e.default={TracksterView:I,DrawableGroup:D,LineTrack:K,FeatureTrack:Q,DiagonalHeatmapTrack:Z,ReadTrack:et,VariantTrack:tt,CompositeTrack:J,object_from_template:nt}}).call(e,i(0),i(1))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(2),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),o=t.View.extend({className:"track-header",initialize:function(){this.model.config.get("name").on("change:value",this.update_name,this),this.render()},render:function(){this.$el.append(n("<div/>").addClass(this.model.drag_handle_class)),this.$el.append(n("<div/>").addClass("track-name").text(this.model.config.get_value("name"))),this.action_icons={},this.render_action_icons(),this.$el.dblclick(function(t){t.stopPropagation()}),this.$el.append(n("<div style='clear: both'/>"))},update_name:function(){this.$el.find(".track-name").text(this.model.config.get_value("name"))},render_action_icons:function(){var t=this;this.icons_div=n("<div/>").addClass("track-icons").hide().appendTo(this.$el),r.each(this.model.action_icons_def,function(e){t.add_action_icon(e.name,e.title,e.css_class,e.on_click_fn,e.prepend,e.hide)}),this.set_display_modes(this.model.display_modes)},add_action_icon:function(t,e,i,a,r,o){var s=this;this.action_icons[t]=n("<a/>").attr("title",e).addClass("icon-button").addClass(i).tooltip().click(function(){a(s.model)}).appendTo(this.icons_div),o&&this.action_icons[t].hide()},set_display_modes:function(t,e){if(t){this.model.display_modes=t,this.model.mode=e||this.model.config.get_value("mode")||this.model.display_modes[0],this.action_icons.mode_icon.attr("title","Set display mode (now: "+this.mode+")");for(var i=this.model,n={},a=0,r=i.display_modes.length;a<r;a++){var o=i.display_modes[a];n[o]=function(t){return function(){i.change_mode(t)}}(o)}make_popupmenu(this.action_icons.mode_icon,n)}}});e.default={TrackHeaderView:o}}).call(e,i(1),i(0))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(n),r=a.extend,o=function(t,e){this.slot=t,this.feature=e},s=function(t,e,i,n){this.slots={},this.start_end_dct={},this.w_scale=t,this.mode=e,this.include_label="Pack"===e,this.max_rows=i,this.measureText=n};r(s.prototype,{_get_draw_coords:function(t){var e=Math.floor(t[1]*this.w_scale),i=Math.ceil(t[2]*this.w_scale),n=t[3];if(void 0!==n&&this.include_label){var a=this.measureText(n).width+7;e-a>=0?(e-=a,"left"):(i+=a,"right")}return[e,i]},_find_slot:function(t){for(var e=t[0],i=t[1],n=0;n<=this.max_rows;n++){var a=!1,r=this.start_end_dct[n];if(void 0!==r)for(var o=0,s=r.length;o<s;o++){var l=r[o];if(i>l[0]&&e<l[1]){a=!0;break}}if(!a)return n}return-1},slot_features:function(t){for(var e,i,n=this.start_end_dct,a=[],r=0,s=0,l=t.length;s<l;s++){e=t[s],i=e[0];var d=this.slots[i];if(d){if(e[1]<d.feature[1]||d.feature[2]<e[2])for(var c=this._get_draw_coords(d.feature),u=this._get_draw_coords(e),h=this.start_end_dct[d.slot],f=0;f<h.length;f++){var p=h[f];p[0]===c[0]&&p[1]===c[1]&&(h[f]=u)}r=Math.max(r,this.slots[i].slot)}else a.push(s)}for(var s=0,l=a.length;s<l;s++){e=t[a[s]],i=e[0];var _=this._get_draw_coords(e),m=this._find_slot(_);m>=0&&(void 0===n[m]&&(n[m]=[]),n[m].push(_),this.slots[i]=new o(m,e),r=Math.max(r,m))}return r+1}}),e.default={FeatureSlotter:s}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(n),r=function(t,e){var i=t[0],n=t[1],a=e[0],r=e[1];return i<a?n<=a?1001:n<=r?1003:1002:i>r?1006:n<=r?1005:1004},o=function(t,e){var i=r(t,e);return 1001!==i&&1006!==i},s=function(t,e,i,n,a,r){void 0===r&&(r=4);var o,s=n-e,l=a-i,d=Math.floor(Math.sqrt(s*s+l*l)/r),c=s/d,u=l/d;for(o=0;o<d;o++,e+=c,i+=u)o%2==0&&t.fillRect(e,i,r,1)},l=function(t,e,i,n){var a=e-n/2,r=e+n/2,o=i-Math.sqrt(3*n/2);t.beginPath(),t.moveTo(a,o),t.lineTo(r,o),t.lineTo(e,i),t.lineTo(a,o),t.strokeStyle=this.fillStyle,t.fill(),t.stroke(),t.closePath()},d=function(t){this.default_val=t||1};d.prototype.gen_val=function(t){return this.default_val};var c=function(t){this.incomplete_features=t.incomplete_features,this.feature_mapper=t.feature_mapper},u=function(t,e,i,n,r){this.data=t,this.view_start=e,this.view_end=i,this.prefs=a.extend({},this.default_prefs,n),this.mode=r};u.prototype.default_prefs={},u.prototype.draw=function(t,e,i,n){},u.prototype.get_start_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,-.5)},u.prototype.get_end_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,.5)},u.prototype.get_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,0)},u.prototype._chrom_pos_to_draw_pos=function(t,e,i){return Math.floor(e*(Math.max(0,t-this.view_start)+i))};var h=function(t,e,i,n,a){u.call(this,t,e,i,n,a)};h.prototype.default_prefs={min_value:void 0,max_value:void 0,mode:"Histogram",color:"#000",overflow_color:"#F66"},h.prototype.draw=function(t,e,i,n){var r=!1,o=this.prefs.min_value,s=this.prefs.max_value,l=s-o,d=i,c=this.view_start,u=this.mode,h=this.data;t.save();var f=Math.round(i+o/l*i);"Intensity"!==u&&(t.fillStyle="#aaa",t.fillRect(0,f,e,1)),t.beginPath();var p,_,m;m=h.length>1?a.map(h.slice(0,-1),function(t,e){return Math.ceil((h[e+1][0]-h[e][0])*n)}):[10];for(var g,v=this.prefs.block_color||this.prefs.color,b=parseInt(v.slice(1),16),w=(16711680&b)>>16,y=(65280&b)>>8,x=255&b,k=!1,C=!1,S=0,$=h.length;S<$;S++)if(t.fillStyle=t.strokeStyle=v,k=C=!1,g=m[S],p=Math.floor((h[S][0]-c-.5)*n),null!==(_=h[S][1])){if(_<o?(C=!0,_=o):_>s&&(k=!0,_=s),"Histogram"===u)_=Math.round(_/l*d),t.fillRect(p,f,g,-_);else if("Intensity"===u){var T=(_-o)/l,M=Math.round(w+(255-w)*(1-T)),O=Math.round(y+(255-y)*(1-T)),A=Math.round(x+(255-x)*(1-T));t.fillStyle="rgb("+M+","+O+","+A+")",t.fillRect(p,0,g,d)}else _=Math.round(d-(_-o)/l*d),r?t.lineTo(p,_):(r=!0,"Filled"===u?(t.moveTo(p,d),t.lineTo(p,_)):t.moveTo(p,_));if(t.fillStyle=this.prefs.overflow_color,k||C){var E;"Histogram"===u||"Intensity"===u?E=g:(p-=2,E=4),k&&t.fillRect(p,0,E,3),C&&t.fillRect(p,d-3,E,3)}t.fillStyle=v}else r&&"Filled"===u&&t.lineTo(p,d),r=!1;"Filled"===u?(r&&(t.lineTo(p,f),t.lineTo(0,f)),t.fill()):t.stroke(),t.restore()};var f=function(t){this.feature_positions={},this.slot_height=t,this.translation=0,this.y_translation=0};f.prototype.map_feature_data=function(t,e,i,n){this.feature_positions[e]||(this.feature_positions[e]=[]),this.feature_positions[e].push({data:t,x_start:i,x_end:n})},f.prototype.get_feature_data=function(t,e){var i,n=Math.floor((e-this.y_translation)/this.slot_height);if(!this.feature_positions[n])return null;t+=this.translation;for(var a=0;a<this.feature_positions[n].length;a++)if(i=this.feature_positions[n][a],t>=i.x_start&&t<=i.x_end)return i.data};var p=function(t,e,i,n,a,r,o){u.call(this,t,e,i,n,a),this.alpha_scaler=r||new d,this.height_scaler=o||new d,this.max_label_length=200};p.prototype.default_prefs={block_color:"#FFF",connector_color:"#FFF"},a.extend(p.prototype,{get_required_height:function(t,e){var i=this.get_row_height(),n=i,a=this.mode;return"no_detail"!==a&&"Squish"!==a&&"Pack"!==a||(i=t*n),i+this.get_top_padding(e)},get_top_padding:function(t){return 0},draw:function(t,e,i,n,a){var r=this.data,o=this.view_start,s=this.view_end;t.save(),t.fillStyle=this.prefs.block_color,t.textAlign="right";for(var l,d=this.get_row_height(),u=new f(d),h=[],p=0,_=r.length;p<_;p++){var m=r[p],g=m[0],v=m[1],b=m[2],w=a&&void 0!==a[g]?a[g].slot:null;("Dense"===this.mode||null!==w)&&v<s&&b>o&&(l=this.draw_element(t,this.mode,m,w,o,s,n,d,e),u.map_feature_data(m,w,l[0],l[1]),(v<o||b>s)&&h.push(m))}return t.restore(),u.y_translation=this.get_top_padding(e),new c({incomplete_features:h,feature_mapper:u})},draw_element:function(t,e,i,n,a,r,o,s,l){return[0,0]}});var _=function(t,e,i,n,a,r,o){p.call(this,t,e,i,n,a,r,o),this.draw_background_connector=!0,this.draw_individual_connectors=!1};a.extend(_.prototype,p.prototype,{get_row_height:function(){var t=this.mode;return"Dense"===t?10:"no_detail"===t?3:"Squish"===t?5:10},draw_element:function(t,e,i,n,a,r,o,s,l){var d,c=(i[0],i[1]),u=i[2],h=i[3],f=i[4],p=Math.floor(Math.max(0,(c-a-.5)*o)),_=Math.ceil(Math.min(l,Math.max(0,(u-a-.5)*o))),m=p,g=_,d=("Dense"===e?0:0+n)*s+this.get_top_padding(l),v=null,b=null,w=f&&"+"!==f&&"."!==f?this.prefs.reverse_strand_color:this.prefs.block_color,y=this.prefs.label_color;if(t.globalAlpha=this.alpha_scaler.gen_val(i),"Dense"===e&&(n=1),"no_detail"===e)t.fillStyle=w,t.fillRect(p,d+5,_-p,1);else{var x=i[5],k=i[6],C=i[7],S=!0;x&&k&&(v=Math.floor(Math.max(0,(x-a)*o)),b=Math.ceil(Math.min(l,Math.max(0,(k-a)*o))));var $,T;if("Squish"===e?($=1,T=3,S=!1):($=5,T=9),C){var M,O;"Squish"===e||"Dense"===e?(M=d+Math.floor(1.5)+1,O=1):f?(M=d,O=T):(M+=2.5,O=1),this.draw_background_connector&&("Squish"===e||"Dense"===e?t.fillStyle="#ccc":f?"+"===f?t.fillStyle=t.canvas.manager.get_pattern("right_strand"):"-"===f&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand")):t.fillStyle="#ccc",t.fillRect(p,M,_-p,O));for(var A=0,E=C.length;A<E;A++){var z,R,P=C[A],j=Math.floor(Math.max(0,(P[0]-a-.5)*o)),q=Math.ceil(Math.min(l,Math.max((P[1]-a-.5)*o)));if(!(j>q)){if(t.fillStyle=w,t.fillRect(j,d+(T-$)/2+1,q-j,$),void 0!==v&&k>x&&!(j>b||q<v)){var D=Math.max(j,v),I=Math.min(q,b);t.fillRect(D,d+1,I-D,T),1===C.length&&"Pack"===e&&("+"===f?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===f&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),D+14<I&&(D+=2,I-=2),t.fillRect(D,d+1,I-D,T))}this.draw_individual_connectors&&z&&this.draw_connector(t,z,R,j,q,d),z=j,R=q}}if("Pack"===e){t.globalAlpha=1,t.fillStyle="white";var L=this.height_scaler.gen_val(i),N=Math.ceil(T*L),B=Math.round((T-N)/2);1!==L&&(t.fillRect(p,M+1,_-p,B),t.fillRect(p,M+T-B+1,_-p,B))}}else t.fillStyle=w,t.fillRect(p,d+1,_-p,T),f&&S&&("+"===f?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===f&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),t.fillRect(p,d+1,_-p,T));t.globalAlpha=1,h&&"Pack"===e&&c>a&&(t.fillStyle=y,0===a&&p-t.measureText(h).width<0?(t.textAlign="left",t.fillText(h,_+2,d+8,this.max_label_length),g+=t.measureText(h).width+2):(t.textAlign="right",t.fillText(h,p-2,d+8,this.max_label_length),m-=t.measureText(h).width+2))}return t.globalAlpha=1,[m,g]}});var m=function(t,e,i,n,a,r,o,s,l){p.call(this,t,e,i,n,a,r,o),this.ref_seq=s?s.data:null,this.base_color_fn=l};a.extend(m.prototype,p.prototype,{get_row_height:function(){var t,e=this.mode;return"Dense"===e?t=10:"Squish"===e?t=5:(t=10,this.prefs.show_insertions&&(t*=2)),t},_parse_cigar:function(t){var e="MIDNSHP=X",i=[[0,0]],n=i[0],r=0,o=a.map(t.match(/[0-9]+[MIDNSHP=X]/g),function(t){var a=parseInt(t.slice(0,-1),10),o=t.slice(-1);return"N"===o?0!==n[1]&&(n=[r+a,r+a],i.push(n)):-1==="ISHP".indexOf(o)&&(n[1]+=a,r+=a),[e.indexOf(o),a]});return{blocks:i,cigar:o}},draw_read:function(t,e,i,n,a,s,d,c,u,h){var f=function(t){return Math.floor(Math.max(0,(t-a-.5)*i))};t.textAlign="center";var p,_,m=[a,s],g=0,v=0,b=Math.round(i/2),w=t.canvas.manager.char_width_px,y="+"===u?this.prefs.detail_block_color:this.prefs.reverse_strand_color,k="Pack"===e,C=k?9:3,S=n+1,$=new x(t,C,i,e),T=[],M=[],O=this._parse_cigar(c);c=O.cigar,T=O.blocks;for(var A=0;A<T.length;A++){var E=T[A];o([d+E[0],d+E[1]],m)&&(p=f(d+E[0]),_=f(d+E[1]),p===_&&(_+=1),t.fillStyle=y,t.fillRect(p,S,_-p,C))}for(var z=0,R=c.length;z<R;z++){var P=c[z],j="MIDNSHP=X"[P[0]],q=P[1],D=d+g;if(p=f(D),_=f(D+q),o([D,D+q],m))switch(p===_&&(_+=1),j){case"H":case"S":case"P":break;case"M":g+=q;break;case"=":case"X":var I="";"X"===j?I=h.slice(v,v+q):this.ref_seq&&(I=this.ref_seq.slice(Math.max(0,D-a),Math.min(D-a+q,s-a)));for(var L=Math.max(D,a),N=0;N<I.length;N++)if(I&&!this.prefs.show_differences||"X"===j){var B=Math.floor(Math.max(0,(L+N-a)*i));t.fillStyle=this.base_color_fn(I[N]),k&&i>w?t.fillText(I[N],B,n+9):i>.05&&t.fillRect(B-b,S,Math.max(1,Math.round(i)),C)}"X"===j&&(v+=q),g+=q;break;case"N":t.fillStyle="#ccc",t.fillRect(p,S+(C-1)/2,_-p,1),g+=q;break;case"D":$.draw_deletion(p,S,q),g+=q;break;case"I":var V=p-b;if(o([D,D+q],m)){var G=h.slice(v,v+q);if(this.prefs.show_insertions){var U=p-(_-p)/2;if(("Pack"===e||"Auto"===this.mode)&&void 0!==h&&i>w){switch(t.fillStyle="yellow",t.fillRect(U-b,n-9,_-p,9),M[M.length]={type:"triangle",data:[V,n+4,5]},t.fillStyle="#ccc",r([D,D+q],m)){case 1003:G=G.slice(a-D);break;case 1004:G=G.slice(0,D-s);break;case 1005:break;case 1002:G=G.slice(a-D,D-s)}for(var N=0,F=G.length;N<F;N++){var B=Math.floor(Math.max(0,(D+N-a)*i));t.fillText(G[N],B-(_-p)/2,n)}}else t.fillStyle="yellow",t.fillRect(U,n+("Dense"!==this.mode?2:5),_-p,"Dense"!==e?3:9)}else("Pack"===e||"Auto"===this.mode)&&void 0!==h&&i>w&&M.push({type:"text",data:[G.length,V,n+9]})}v+=q}else g=function(t,e,i){return-1!=="M=NXD".indexOf(e)&&(t+=i),t}(g,j,q),v=function(t,e,i){return-1!=="IX".indexOf(e)&&(t+=i),t}(v,j,q)}t.fillStyle="yellow";for(var H,Y,X,A=0;A<M.length;A++)H=M[A],Y=H.type,X=H.data,"text"===Y?(t.save(),t.font="bold "+t.font,t.fillText(X[0],X[1],X[2]),t.restore()):"triangle"===Y&&l(t,X[0],X[1],X[2])},draw_element:function(t,e,i,n,a,r,o,l,d){var c=(i[0],i[1]),u=i[2],h=i[3],f=Math.floor(Math.max(-.5*o,(c-a-.5)*o)),p=Math.ceil(Math.min(d,Math.max(0,(u-a-.5)*o))),_=("Dense"===e?0:0+n)*l,m="Pack"===e?9:3;this.prefs.label_color;if(i[5]instanceof Array){var g=!0;i[4][1]>=a&&i[4][0]<=r&&i[4][2]?this.draw_read(t,e,o,_,a,r,i[4][0],i[4][2],i[4][3],i[4][4]):g=!1,i[5][1]>=a&&i[5][0]<=r&&i[5][2]?this.draw_read(t,e,o,_,a,r,i[5][0],i[5][2],i[5][3],i[5][4]):g=!1;var v=Math.ceil(Math.min(d,Math.max(-.5*o,(i[4][1]-a-.5)*o))),b=Math.floor(Math.max(-.5*o,(i[5][0]-a-.5)*o));if(g&&b>v){t.fillStyle="#ccc";var w=_+1+(m-1)/2;s(t,v,w,b,w)}}else this.draw_read(t,e,o,_,a,r,c,i[4],i[5],i[6]);return"Pack"===e&&c>=a&&"."!==h&&(t.fillStyle=this.prefs.label_color,0===a&&f-t.measureText(h).width<0?(t.textAlign="left",t.fillText(h,p+2,_+9,this.max_label_length)):(t.textAlign="right",t.fillText(h,f-2,_+9,this.max_label_length))),[0,0]}});var g=function(t,e,i,n,a,r,o){_.call(this,t,e,i,n,a,r,o),this.longest_feature_length=this.calculate_longest_feature_length(),this.draw_background_connector=!1,this.draw_individual_connectors=!0};a.extend(g.prototype,p.prototype,_.prototype,{calculate_longest_feature_length:function(){for(var t=0,e=0,i=this.data.length;e<i;e++){var n=this.data[e],a=n[1],r=n[2];t=Math.max(t,r-a)}return t},get_top_padding:function(t){var e=this.view_end-this.view_start,i=t/e;return Math.min(128,Math.ceil(this.longest_feature_length/2*i))},draw_connector:function(t,e,i,n,a,r){var o=(i+n)/2,s=n-o;Math.PI;s>0&&(t.beginPath(),t.arc(o,r,n-o,Math.PI,0),t.stroke())}});var v=function(t,e){Array.isArray(t)?this.rgb=t:6==t.length?this.rgb=t.match(/.{2}/g).map(function(t){return parseInt(t,16)}):7==t.length?this.rgb=t.substring(1,7).match(/.{2}/g).map(function(t){return parseInt(t,16)}):this.rgb=t.split("").map(function(t){return parseInt(t+t,16)}),this.alpha="number"==typeof e?e:1};v.prototype={eval:function(){return this},toCSS:function(){return this.alpha<1?"rgba("+this.rgb.map(function(t){return Math.round(t)}).concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(t){return t=Math.round(t),t=(t>255?255:t<0?0:t).toString(16),1===t.length?"0"+t:t}).join("")},toHSL:function(){var t,e,i=this.rgb[0]/255,n=this.rgb[1]/255,a=this.rgb[2]/255,r=this.alpha,o=Math.max(i,n,a),s=Math.min(i,n,a),l=(o+s)/2,d=o-s;if(o===s)t=e=0;else{switch(e=l>.5?d/(2-o-s):d/(o+s),o){case i:t=(n-a)/d+(n<a?6:0);break;case n:t=(a-i)/d+2;break;case a:t=(i-n)/d+4}t/=6}return{h:360*t,s:e,l:l,a:r}},toARGB:function(){return"#"+[Math.round(255*this.alpha)].concat(this.rgb).map(function(t){return t=Math.round(t),t=(t>255?255:t<0?0:t).toString(16),1===t.length?"0"+t:t}).join("")},mix:function(t,e){var i=this,n=e,a=2*n-1,r=i.toHSL().a-t.toHSL().a,o=((a*r==-1?a:(a+r)/(1+a*r))+1)/2,s=1-o,l=[i.rgb[0]*o+t.rgb[0]*s,i.rgb[1]*o+t.rgb[1]*s,i.rgb[2]*o+t.rgb[2]*s],d=i.alpha*n+t.alpha*(1-n);return new v(l,d)}};var b=function(t,e,i,n){this.start_color=new v(t),this.end_color=new v(e),this.start_value=i,this.end_value=n,this.value_range=n-i};b.prototype.map_value=function(t){return t=Math.max(t,this.start_value),t=Math.min(t,this.end_value),t=(t-this.start_value)/this.value_range,this.start_color.mix(this.end_color,1-t).toCSS()};var w=function(t,e,i,n,a){this.positive_ramp=new b(e,i,0,a),this.negative_ramp=new b(e,t,0,-n),this.start_value=n,this.end_value=a};w.prototype.map_value=function(t){return t=Math.max(t,this.start_value),t=Math.min(t,this.end_value),t>=0?this.positive_ramp.map_value(t):this.negative_ramp.map_value(-t)};var y=function(t,e,i,n,a){u.call(this,t,e,i,n,a);var r,o;if(void 0===this.prefs.min_value){var s=1/0;for(r=0,o=this.data.length;r<o;r++)s=Math.min(s,this.data[r][6]);this.prefs.min_value=s}if(void 0===this.prefs.max_value){var l=-1/0;for(r=0,o=this.data.length;r<o;r++)l=Math.max(l,this.data[r][6]);this.prefs.max_value=l}};y.prototype.default_prefs={min_value:void 0,max_value:void 0,mode:"Heatmap",pos_color:"#FF8C00",neg_color:"#4169E1"},y.prototype.draw=function(t,e,i,n){var a,r,o,s,l,d,c=this.prefs.min_value,u=this.prefs.max_value,h=this.view_start,f=(this.mode,this.data),p=1/Math.sqrt(2),_=new w(this.prefs.neg_color,"#FFFFFF",this.prefs.pos_color,c,u),m=function(t){return(t-h)*n};t.save(),t.rotate(-45*Math.PI/180),t.scale(p,p);for(var g=0,v=f.length;g<v;g++)a=f[g],r=m(a[1]),o=m(a[2]),s=m(a[4]),l=m(a[5]),d=a[6],t.fillStyle=_.map_value(d),t.fillRect(r,s,o-r,l-s);t.restore()};var x=function(t,e,i,n){this.ctx=t,this.row_height=e,this.px_per_base=i,this.draw_details=("Pack"===n||"Auto"===n)&&i>=t.canvas.manager.char_width_px,this.delete_details_thickness=.2};a.extend(x.prototype,{draw_deletion:function(t,e,i){this.ctx.fillStyle="black";var n=(this.draw_details?this.delete_details_thickness:1)*this.row_height;e+=.5*(this.row_height-n),this.ctx.fillRect(t,e,i*this.px_per_base,n)}});var k=function(t,e,i,n,a,r){u.call(this,t,e,i,n,a),this.base_color_fn=r,this.divider_height=1};a.extend(k.prototype,u.prototype,{get_row_height:function(){var t=this.mode;return"Dense"===t?10:"Squish"===t?5:10},get_required_height:function(t){var e=this.prefs.summary_height;return t>1&&this.prefs.show_sample_data&&(e+=this.divider_height+t*this.get_row_height()),e},draw:function(t,e,i,n){t.save();var r,o,s,l,d,c,u,h,f,p,_,m=function(t,e){var i=t.length,n=e.length,a=0,r=1,o=null;return"-"===e?(o="deletion",r=t.length):0===t.indexOf(e)&&i>n?(o="deletion",r=i-n,a=n):0===e.indexOf(t)&&i<n&&(o="insertion",r=n-i,a=n),null!==o?{type:o,start:a,len:r}:{}},g=Math.max(1,Math.floor(n)),v=this.data.length?this.data[0][7].split(",").length:0,b="Squish"===this.mode?5:10,w=n<.1?b:"Squish"===this.mode?3:9,y=!0,k=new x(t,b,n,this.mode);1===v&&(b=w=n<t.canvas.manager.char_width_px?this.prefs.summary_height:b,k.row_height=b,y=!1),this.prefs.show_sample_data&&y&&(t.fillStyle="#F3F3F3",t.globalAlpha=1,t.fillRect(0,this.prefs.summary_height-this.divider_height,e,this.divider_height)),t.textAlign="center";for(var C=0;C<this.data.length;C++)if(r=this.data[C],o=r[1],s=r[3],l=[r[4].split(",")],d=r[7].split(","),c=r.slice(8),l=a.map(a.flatten(l),function(t){var e={type:"snp",value:t,start:0},i=m(s,t);return a.extend(e,i)}),!(o<this.view_start||o>this.view_end)){if(y)for(t.fillStyle="#999999",t.globalAlpha=1,_=0;_<l.length;_++)for(h=this.get_start_draw_pos(o+l[_].start,n),t.fillRect(h,0,g,this.prefs.summary_height),f=this.prefs.summary_height,_=0;_<l.length;_++){t.fillStyle="deletion"===l[_].type?"black":this.base_color_fn(l[_].value);var S=c/d.length,$=Math.ceil(this.prefs.summary_height*S);t.fillRect(h,f-$,g,$),f-=$}if(this.prefs.show_sample_data)for(f=y?this.prefs.summary_height+this.divider_height:0,_=0;_<d.length;_++,f+=b)if(p=d[_]?d[_].split(/\/|\|/):["0","0"],u=null,p[0]===p[1]?"."===p[0]||"0"!==p[0]&&(u=l[parseInt(p[0],10)-1],t.globalAlpha=1):(u="0"!==p[0]?p[0]:p[1],u=l[parseInt(u,10)-1],t.globalAlpha=.5),u)if(h=this.get_start_draw_pos(o+u.start,n),"snp"===u.type){var T=u.value;t.fillStyle=this.base_color_fn(T),k.draw_details?t.fillText(T,this.get_draw_pos(o,n),f+b):t.fillRect(h,f+1,g,w)}else"deletion"===u.type&&k.draw_deletion(h,f+1,u.len)}t.restore()}}),e.default={Scaler:d,LinePainter:h,LinkedFeaturePainter:_,ReadPainter:m,ArcLinkedFeaturePainter:g,DiagonalHeatmapPainter:y,VariantPainter:k}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(n),r=a.extend,o=function(t){this.manager=null,this.name=t.name,this.index=t.index,this.tool_id=t.tool_id,this.tool_exp_name=t.tool_exp_name};r(o.prototype,{to_dict:function(){return{name:this.name,index:this.index,tool_id:this.tool_id,tool_exp_name:this.tool_exp_name}}});var s=function(e,i,n){return t("<a/>").attr("href","javascript:void(0);").attr("title",e).addClass("icon-button").addClass(i).tooltip().click(n)},l=function(e){o.call(this,e),this.low="low"in e?e.low:-Number.MAX_VALUE,this.high="high"in e?e.high:Number.MAX_VALUE,this.min="min"in e?e.min:Number.MAX_VALUE,this.max="max"in e?e.max:-Number.MAX_VALUE,this.container=null,this.slider=null,this.slider_label=null;var i=this;i.parent_div=t("<div/>").addClass("filter-row slider-row");var n=t("<div/>").addClass("elt-label").appendTo(i.parent_div),a=(t("<span/>").addClass("slider-name").text(i.name+"  ").appendTo(n),t("<span/>").text(this.low+"-"+this.high)),r=t("<span/>").addClass("slider-value").appendTo(n).append("[").append(a).append("]");i.values_span=a;var l=t("<div/>").addClass("slider").appendTo(i.parent_div);i.control_element=t("<div/>").attr("id",i.name+"-filter-control").appendTo(l),i.control_element.slider({range:!0,min:this.min,max:this.max,step:this.get_slider_step(this.min,this.max),values:[this.low,this.high],slide:function(t,e){i.slide(t,e)},change:function(t,e){i.control_element.slider("option","slide").call(i.control_element,t,e)}}),i.slider=i.control_element,i.slider_label=a,function(e,i,n){e.click(function(){var e=i.text(),a=parseFloat(n.slider("option","max")),r=a<=1?4:a<=1e6?a.toString().length:6,o=!1,s=t(this).parents(".slider-row");s.addClass("input"),n.slider("option","values")&&(r=2*r+1,o=!0),i.text(""),t("<input type='text'/>").attr("size",r).attr("maxlength",r).attr("value",e).appendTo(i).focus().select().click(function(t){t.stopPropagation()}).blur(function(){t(this).remove(),i.text(e),s.removeClass("input")}).keyup(function(e){if(27===e.keyCode)t(this).trigger("blur");else if(13===e.keyCode){var i=n.slider("option","min"),a=n.slider("option","max"),r=function(t){return isNaN(t)||t>a||t<i},l=t(this).val();if(o){if(l=l.split("-"),l=[parseFloat(l[0]),parseFloat(l[1])],r(l[0])||r(l[1]))return alert("Parameter value must be in the range ["+i+"-"+a+"]"),t(this)}else if(l=parseFloat(l),r(l))return alert("Parameter value must be in the range ["+i+"-"+a+"]"),t(this);n.slider(o?"values":"value",l),s.removeClass("input")}})})}(r,a,i.control_element);var d=t("<div/>").addClass("display-controls").appendTo(i.parent_div);this.transparency_icon=s("Use filter for data transparency","layer-transparent",function(){i.manager.alpha_filter!==i?(i.manager.alpha_filter=i,i.manager.parent_div.find(".layer-transparent").removeClass("active").hide(),i.transparency_icon.addClass("active").show()):(i.manager.alpha_filter=null,i.transparency_icon.removeClass("active")),i.manager.track.request_draw({force:!0,clear_after:!0})}).appendTo(d).hide(),this.height_icon=s("Use filter for data height","arrow-resize-090",function(){i.manager.height_filter!==i?(i.manager.height_filter=i,i.manager.parent_div.find(".arrow-resize-090").removeClass("active").hide(),i.height_icon.addClass("active").show()):(i.manager.height_filter=null,i.height_icon.removeClass("active")),i.manager.track.request_draw({force:!0,clear_after:!0})}).appendTo(d).hide(),i.parent_div.hover(function(){i.transparency_icon.show(),i.height_icon.show()},function(){i.manager.alpha_filter!==i&&i.transparency_icon.hide(),i.manager.height_filter!==i&&i.height_icon.hide()}),t("<div style='clear: both;'/>").appendTo(i.parent_div)};r(l.prototype,{to_dict:function(){var t=o.prototype.to_dict.call(this);return r(t,{type:"number",min:this.min,max:this.max,low:this.low,high:this.high})},copy:function(){return new l({name:this.name,index:this.index,tool_id:this.tool_id,tool_exp_name:this.tool_exp_name})},get_slider_step:function(t,e){return e-t<=2?.01:1},slide:function(t,e){var i=e.values;this.values_span.text(i[0]+"-"+i[1]),this.low=i[0],this.high=i[1];var n=this;setTimeout(function(){i[0]===n.low&&i[1]===n.high&&n.manager.track.request_draw({force:!0,clear_after:!0})},25)},applies_to:function(t){return t.length>this.index},_keep_val:function(t){return isNaN(t)||t>=this.low&&t<=this.high},keep:function(t){if(!this.applies_to(t))return!0;var e=t[this.index];if(e instanceof Array){for(var i=!0,n=0;n<e.length;n++)if(!this._keep_val(e[n])){i=!1;break}return i}return this._keep_val(t[this.index])},update_attrs:function(t){var e=!1;if(!this.applies_to(t))return e;var i=t[this.index];i instanceof Array||(i=[i]);for(var n=0;n<i.length;n++){var a=i[n];a<this.min&&(this.min=Math.floor(a),e=!0),a>this.max&&(this.max=Math.ceil(a),e=!0)}return e},update_ui_elt:function(){this.min<this.max?this.parent_div.show():this.parent_div.hide();var t=this.slider.slider("option","min"),e=this.slider.slider("option","max");(this.min<t||this.max>e)&&(this.slider.slider("option","min",this.min),this.slider.slider("option","max",this.max),this.slider.slider("option","step",this.get_slider_step(this.min,this.max)),this.slider.slider("option","values",[this.min,this.max]))}});var d=function(e,i){if(this.track=e,this.alpha_filter=null,this.height_filter=null,this.filters=[],this.parent_div=t("<div/>").addClass("filters").hide(),this.parent_div.bind("drag",function(t){t.stopPropagation()}).click(function(t){t.stopPropagation()}).bind("dblclick",function(t){t.stopPropagation()}).bind("keydown",function(t){t.stopPropagation()}),i&&"filters"in i){for(var n,a=("alpha_filter"in i?i.alpha_filter:null),r=("height_filter"in i?i.height_filter:null),o=i.filters,s=0;s<o.length;s++)"number"===o[s].type?(n=new l(o[s]),this.add_filter(n),n.name===a&&(this.alpha_filter=n,n.transparency_icon.addClass("active").show()),n.name===r&&(this.height_filter=n,n.height_icon.addClass("active").show())):console.log("ERROR: unsupported filter: ",name,type);"visible"in i&&i.visible&&this.parent_div.show()}if(0!==this.filters.length){var d=t("<div/>").addClass("param-row").appendTo(this.parent_div),c=this;t("<input type='submit'/>").attr("value","Run on complete dataset").appendTo(d).click(function(){c.run_on_dataset()})}};r(d.prototype,{show:function(){this.parent_div.show()},hide:function(){this.parent_div.hide()},toggle:function(){this.parent_div.toggle()},visible:function(){return this.parent_div.is(":visible")},to_dict:function(){for(var t,e={},i=[],n=0;n<this.filters.length;n++)t=this.filters[n],i.push(t.to_dict());return e.filters=i,e.alpha_filter=this.alpha_filter?this.alpha_filter.name:null,e.height_filter=this.height_filter?this.height_filter.name:null,e.visible=this.parent_div.is(":visible"),e},copy:function(t){for(var e=new d(t),i=0;i<this.filters.length;i++)e.add_filter(this.filters[i].copy());return e},add_filter:function(t){t.manager=this,this.parent_div.append(t.parent_div),this.filters.push(t)},remove_all:function(){this.filters=[],this.parent_div.children().remove()},init_filters:function(){for(var t=0;t<this.filters.length;t++){this.filters[t].update_ui_elt()}},clear_filters:function(){for(var t=0;t<this.filters.length;t++){var e=this.filters[t];e.slider.slider("option","values",[e.min,e.max])}this.alpha_filter=null,this.height_filter=null,this.parent_div.find(".icon-button").hide()},run_on_dataset:function(){for(var e,i,n=(function(t,e,i){return e in t||(t[e]=i),t[e]}),a={},r=0;r<this.filters.length;r++)e=this.filters[r],e.tool_id&&(e.min!==e.low&&(i=n(a,e.tool_id,[]),i[i.length]=e.tool_exp_name+" >= "+e.low),e.max!==e.high&&(i=n(a,e.tool_id,[]),i[i.length]=e.tool_exp_name+" <= "+e.high));var o=[];for(var s in a)o[o.length]=[s,a[s]];!function e(i,n){var a=n[0],r=a[0],o=a[1],s="("+o.join(") and (")+")",l={cond:s,input:i,target_dataset_id:i,tool_id:r};n=n.slice(1),t.getJSON(run_tool_url,l,function(t){t.error?Galaxy.modal.show({title:"Filter Dataset",body:"Error running tool "+r,buttons:{Close:Galaxy.modal.hide()}}):0===n.length?Galaxy.modal.show({title:"Filtering Dataset",body:"Filter(s) are running on the complete dataset. Outputs are in dataset's history.",buttons:{Close:Galaxy.modal.hide()}}):e(t.dataset_id,n)})}(this.track.dataset_id,o)}}),e.default={FiltersManager:d,NumberFilter:l}}).call(e,i(0))},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i(13),a=function(t){return t&&t.__esModule?t:{default:t}}(n),r=i(152),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),s=a.default.GenomeDataManager.extend({load_data:function(e,i,n,a){var r=t.Deferred();this.set_data(e,r);var s=Galaxy.root+"datasets/"+this.get("dataset").id+"/display",l=this;new t.Deferred;return t.when(o.makeBwg(s)).then(function(i,n){t.when(i.readWigData(e.get("chrom"),e.get("start"),e.get("end"))).then(function(t){var i=[],n={max:Number.MIN_VALUE};t.forEach(function(t){n.max!==t.min-1&&(i.push([n.max+1,0]),i.push([t.min-2,0])),i.push([t.min-1,t.score]),i.push([t.max,t.score]),n=t});var a={data:i,region:e,dataset_type:"bigwig"};l.set_data(e,a),r.resolve(a)})}),r}});e.default={BBIDataManager:s}}).call(e,i(0))},function(t,e,i){(function(n){var a,r;a=[i(153),i(154),i(155)],void 0!==(r=function(t,e){"use strict";function i(){}function a(t){t&&(this.id=t)}function r(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function o(t,e,i){Math.pow(10,6);return n.ajax({type:"GET",dataType:"native",url:t,timeout:5e3,beforeSend:function(t){t.setRequestHeader("Range","bytes="+e+"-"+(e+(i-1)))},xhrFields:{responseType:"arraybuffer"}})}function s(t,e){return t[e]+t[e+1]*y+t[e+2]*x+t[e+3]*k+t[e+4]*C}function l(){}function d(t,e,i,n){this.bwg=t,this.cirTreeOffset=e,this.cirTreeLength=i,this.isSummary=n}function c(t){var e=n.Deferred(),i=new l;return i.url=t,n.when(o(i.url,0,512)).then(function(t){if(!t)return e.resolve(null,"Couldn't fetch file");var a=t,r=new Uint8Array(a),o=new Int16Array(a),l=new Int32Array(a),d=r[0]+y*r[1]+x*r[2]+k*r[3];if(d==g)i.type="bigwig";else{if(d!=b)return d==v||d==w?e.resolve(null,"Currently don't support big-endian BBI files"):e.resolve(null,"Not a supported format, magic=0x"+d.toString(16));i.type="bigbed"}i.version=o[2],i.numZoomLevels=o[3],i.chromTreeOffset=s(r,8),i.unzoomedDataOffset=s(r,16),i.unzoomedIndexOffset=s(r,24),i.fieldCount=o[16],i.definedFieldCount=o[17],i.asOffset=s(r,36),i.totalSummaryOffset=s(r,44),i.uncompressBufSize=l[13],i.extHeaderOffset=s(r,56),i.zoomLevels=[];for(var c=0;c<i.numZoomLevels;++c){var u=l[6*c+16],h=s(r,24*c+72),f=s(r,24*c+80);i.zoomLevels.push({reduction:u,dataOffset:h,indexOffset:f})}n.when(i.readChromTree()).then(function(){i.getAutoSQL(function(t){return i.schema=t,e.resolve(i)})})}),e}function u(t,e,i,n,a){this.bbi=t,this.type=e,this.fieldCount=i,this.offset=n,this.field=a}var h=t.Range,f=t.union,p=t.intersection,_=e.inflateBuffer,m=e.arrayCopy,g=2291137574,v=654086024,b=2273964779,w=3958540679,y=256,x=65536,k=16777216,C=4294967296,S=new RegExp("^[0-9]+,[0-9]+,[0-9]+");return l.prototype.readChromTree=function(){var t=this;this.chromsToIDs={},this.idsToChroms={},this.maxID=0;var e=this.unzoomedDataOffset;return e=e+4-(e-this.chromTreeOffset&3),n.when(o(this.url,this.chromTreeOffset,e-this.chromTreeOffset)).then(function(e){var i=new Uint8Array(e),n=new Int16Array(e),a=new Int32Array(e),r=(a[0],a[1],a[2]),o=(a[3],s(i,16),function(e){var a=i[e],l=n[e/2+1];e+=4;for(var d=0;d<l;++d)if(0===a){e+=r;var c=s(i,e);e+=8,c-=t.chromTreeOffset,o(c)}else{for(var u="",h=0;h<r;++h){var f=i[e++];0!==f&&(u+=String.fromCharCode(f))}var p=i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e+0];i[e+7],i[e+6],i[e+5],i[e+4],e+=8,t.chromsToIDs[u]=p,0===u.indexOf("chr")&&(t.chromsToIDs[u.substr(3)]=p),t.idsToChroms[p]=u,t.maxID=Math.max(t.maxID,p)}});o(32)})},d.prototype.readWigData=function(t,e,i){var n=this.bwg.chromsToIDs[t];return void 0===n?[]:this.readWigDataById(n,e,i)},d.prototype.readWigDataById=function(t,e,i){var a=this,r=n.Deferred();if(!this.cirHeader)return n.when(o(a.bwg.url,this.cirTreeOffset,48)).then(function(o){a.cirHeader=o;var s=new Int32Array(a.cirHeader);a.cirBlockSize=s[1],n.when(a.readWigDataById(t,e,i)).then(function(t){r.resolve(t)})}),r;var l=[],d=0,c=(Date.now(),function(n,a,r,o){return(t<0||n==t)&&a<=i&&r>=e}),u=function(t,e){if(a.bwg.instrument&&console.log("level="+e+"; offset="+t+"; time="+(0|Date.now())),d+=t.length,1==t.length&&t[0]-a.cirTreeOffset==48&&a.cachedCirRoot)return _(a.cachedCirRoot,0,e),void(0===--d&&n.when(a.fetchFeatures(c,l)).then(function(t){r.resolve(t)}));for(var i,o=4+32*a.cirBlockSize,s=0;s<t.length;++s){var u=new h(t[s],t[s]+o);i=i?f(i,u):u}for(var m=i.ranges(),g=0;g<m.length;++g){var v=m[g];p(t,v,e)}},p=function(t,e,i,s){e.max(),e.min();n.when(o(a.bwg.url,e.min(),e.max()-e.min())).then(function(o){for(var s=0;s<t.length;++s)e.contains(t[s])&&(_(o,t[s]-e.min(),i),t[s]-a.cirTreeOffset==48&&t[s]-e.min()==0&&(a.cachedCirRoot=o),0===--d&&n.when(a.fetchFeatures(c,l)).then(function(t){r.resolve(t)}))})},_=function(n,a,r){var o=new Uint8Array(n),d=new Int16Array(n),c=new Int32Array(n),h=o[a],f=d[a/2+1];if(a+=4,0!==h)for(var p=0;p<f;++p){var _=a/4,m=c[_],g=c[_+1],v=c[_+2],b=c[_+3],w=s(o,a+16),y=s(o,a+24);(t<0||m<t||m==t&&g<=i)&&(t<0||v>t||v==t&&b>=e)&&l.push({offset:w,size:y}),a+=32}else{for(var x=[],p=0;p<f;++p){var _=a/4,m=c[_],g=c[_+1],v=c[_+2],b=c[_+3],w=s(o,a+16);(t<0||m<t||m==t&&g<=i)&&(t<0||v>t||v==t&&b>=e)&&x.push(w),a+=24}x.length>0&&u(x,r+1)}};return u([a.cirTreeOffset+48],1),r},d.prototype.fetchFeatures=function(t,e){var a=this,r=n.Deferred();if(e.sort(function(t,e){return(0|t.offset)-(0|e.offset)}),0===e.length)return[];var s=[],l=function(t,e,n,r){r||(r={});var o=new i;o._chromId=t,o.segment=a.bwg.idsToChroms[t],o.min=e,o.max=n,o.type=a.bwg.type;for(var l in r)o[l]=r[l];s.push(o)},d=function(){if(0===e.length){Date.now();return r.resolve(s)}var i=e[0];if(i.data)a.parseFeatures(i.data,l,t),e.splice(0,1),d();else{for(var c=i.offset,u=i.size,h=1;h<e.length&&e[h].offset==c+u;)u+=e[h].size,++h;n.when(o(a.bwg.url,c,u)).then(function(t){for(var i=0,n=0;i<u;){var r,o=e[n];if(a.bwg.uncompressBufSize>0)r=_(t,i+2,o.size-2);else{var s=new Uint8Array(o.size);m(new Uint8Array(t,i,o.size),0,s,0,o.size),r=s.buffer}o.data=r,i+=o.size,++n}d()})}};return d(),r},d.prototype.parseFeatures=function(t,e,i){var r=new Uint8Array(t);if(this.isSummary)for(var o=new Int16Array(t),s=new Int32Array(t),l=new Float32Array(t),d=t.byteLength/32,c=0;c<d;++c){var u=s[8*c],_=s[8*c+1],m=s[8*c+2],g=s[8*c+3],v=(l[8*c+4],l[8*c+5]),b=l[8*c+6];l[8*c+7];if(i(u,_+1,m)){var w={type:"bigwig",score:b/g,maxScore:v};"bigbed"==this.bwg.type&&(w.type="density"),e(u,_+1,m,w)}}else if("bigwig"==this.bwg.type){var o=new Int16Array(t),s=new Int32Array(t),l=new Float32Array(t),u=s[0],y=s[1],x=(s[2],s[3]),k=s[4],C=r[20],d=o[11];if(3==C)for(var c=0;c<d;++c){var $=l[c+6],T=y+c*x+1,M=y+c*x+k;i(u,T,M)&&e(u,T,M,{score:$})}else if(2==C)for(var c=0;c<d;++c){var _=s[2*c+6]+1,m=_+k-1,$=l[2*c+7];i(u,_,m)&&e(u,_,m,{score:$})}else if(1==C)for(var c=0;c<d;++c){var _=s[3*c+6]+1,m=s[3*c+7],$=l[3*c+8];_>m&&(_=m),i(u,_,m)&&e(u,_,m,{score:$})}else console.log("Currently not handling bwgType="+C)}else{if("bigbed"!=this.bwg.type)throw Error("Don't know what to do with "+this.bwg.type);for(var O=0,A=this.bwg.definedFieldCount,E=this.bwg.schema;O<r.length;){var u=r[O+3]<<24|r[O+2]<<16|r[O+1]<<8|r[O+0],_=r[O+7]<<24|r[O+6]<<16|r[O+5]<<8|r[O+4],m=r[O+11]<<24|r[O+10]<<16|r[O+9]<<8|r[O+8];O+=12;for(var z="";;){var R=r[O++];if(0==R)break;z+=String.fromCharCode(R)}var P,j={};if(P=z.length>0?z.split("\t"):[],P.length>0&&A>3&&(j.label=P[0]),P.length>1&&A>4){var $=parseInt(P[1]);isNaN($)||(j.score=$)}if(P.length>2&&A>5&&(j.orientation=P[2]),P.length>5&&A>8){var q=P[5];S.test(q)&&(j.itemRgb="rgb("+q+")")}if(P.length>A-3&&E)for(var D=A-3;D<P.length;++D)j[E.fields[D+3].name]=P[D];if(i(u,_+1,m,P))if(A<12)e(u,_+1,m,j);else{var I=0|P[3],L=0|P[4],N=0|P[6],B=P[7].split(","),V=P[8].split(",");if(j.exonFrames){var G=j.exonFrames.split(",");j.exonFrames=void 0}j.type="transcript";var U=new a;for(var F in j)U[F]=j[F];if(U.id=P[0],U.segment=this.bwg.idsToChroms[u],U.min=_+1,U.max=m,U.notes=[],j.groups=[U],P.length>9){var H=j.geneName||P[9],Y=H;P.length>10&&(Y=P[10]),j.geneName2&&(Y=j.geneName2);var X=n.extend({},U);X.id=H,X.label=Y,X.type="gene",j.groups.push(X)}for(var J=[],W=0;W<N;++W){var K=(0|V[W])+_,Z=K+(0|B[W]),Q=new h(K,Z);J.push(Q)}for(var tt=f(J),et=tt.ranges(),it=0;it<et.length;++it){var nt=et[it];e(u,nt.min()+1,nt.max(),j)}if(L>I){var at="+"==j.orientation?new h(I,L+3):new h(I-3,L),rt=p(tt,at);if(rt){j.type="translation";for(var ot=rt.ranges(),st=0,lt=0;ot[0].min()>et[lt].max();)lt++;for(var it=0;it<ot.length;++it){var dt=it;"-"==j.orientation&&(dt=ot.length-it-1);var nt=ot[dt];if(j.readframe=st,G){var ct=parseInt(G[dt+lt]);"number"==typeof ct&&ct>=0&&ct<=2&&(j.readframe=ct,j.readframeExplicit=!0)}var ut=nt.max()-nt.min();st=(st+ut)%3,e(u,nt.min()+1,nt.max(),j)}}}}}}},d.prototype.getFirstAdjacent=function(t,e,i,n){var a=this.bwg.chromsToIDs[t];if(void 0===a)return n([]);this.getFirstAdjacentById(a,e,i,n)},d.prototype.getFirstAdjacentById=function(t,e,i,n){var a=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(r){a.cirHeader=r;var o=new Int32Array(a.cirHeader);a.cirBlockSize=o[1],a.getFirstAdjacentById(t,e,i,n)});var r=null,o=-1,l=-1,d=0,c=(Date.now(),function(t,e){d+=t.length;for(var i,n=4+32*a.cirBlockSize,r=0;r<t.length;++r){var o=new h(t[r],t[r]+n);i=i?f(i,o):o}for(var s=i.ranges(),l=0;l<s.length;++l){var c=s[l];u(t,c,e)}}),u=function(o,s,l,c){s.max(),s.min();a.bwg.data.slice(s.min(),s.max()-s.min()).fetch(function(c){for(var u=0;u<o.length;++u)if(s.contains(o[u])&&(p(c,o[u]-s.min(),l),0==--d)){if(!r)return i>0&&(0!=t||e>0)?a.getFirstAdjacentById(0,0,i,n):i<0&&(t!=a.bwg.maxID||e<1e9)?a.getFirstAdjacentById(a.bwg.maxID,1e9,i,n):n([]);a.fetchFeatures(function(n,a,r,o){return i<0&&(n<t||r<e)||i>0&&(n>t||a>e)},[r],function(t){for(var e=null,a=-1,r=-1,o=0;o<t.length;++o){var s=t[o],l=s._chromId,d=s.min,c=s.max;(null==e||i<0&&(l>a||c>r)||i>0&&(l<a||d<r))&&(e=s,r=i<0?c:d,a=l)}return n(null!=e?[e]:[])})}})},p=function(n,d,u){var h=new Uint8Array(n),f=new Int16Array(n),p=new Int32Array(n),_=h[d],m=f[d/2+1];if(d+=4,0!=_)for(var g=0;g<m;++g){var v=d/4,b=p[v],w=p[v+1],y=p[v+2],x=p[v+3],k=s(h,d+16),C=s(h,d+24);(i<0&&(b<t||b==t&&w<=e)||i>0&&(y>t||y==t&&x>=e))&&(/_random/.exec(a.bwg.idsToChroms[b])||(null==r||i<0&&(y>o||y==o&&x>l)||i>0&&(b<o||b==o&&w<l))&&(r={offset:k,size:C},l=i<0?x:w,o=i<0?y:b)),d+=32}else{for(var S=-1,$=-1,g=0;g<m;++g){var v=d/4,b=p[v],w=p[v+1],y=p[v+2],x=p[v+3],k=p[v+4]<<32|p[v+5];(i<0&&(b<t||b==t&&w<=e)&&y>=t||i>0&&(y>t||y==t&&x>=e)&&b<=t)&&(S<0||x>$)&&(S=k,$=i<0?x:w,i<0?y:b),d+=24}S>=0&&c([S],u+1)}};c([a.cirTreeOffset+48],1)},l.prototype.readWigData=function(t,e,i){var n,a=i-e;if(a<=25e3||0===this.zoomLevels.length)n=this.getUnzoomedView();else for(var r=0;r<this.zoomLevels.length;r++)if(a/this.zoomLevels[r].reduction<25e3){n=this.getZoomedView(r);break}return n.readWigData(t,e,i)},l.prototype.getUnzoomedView=function(){if(!this.unzoomedView){var t=4e3;this.zoomLevels[0]&&(t=this.zoomLevels[0].dataOffset-this.unzoomedIndexOffset),this.unzoomedView=new d(this,this.unzoomedIndexOffset,t,!1)}return this.unzoomedView},l.prototype.getZoomedView=function(t){var e=this.zoomLevels[t];return e.view||(e.view=new d(this,e.indexOffset,4e3,!0)),e.view},l.prototype._tsFetch=function(t,e,i,n,a){var r=this;if(!(t>=this.zoomLevels.length-1)){var o;return o=t<0?this.getUnzoomedView():this.getZoomedView(t),o.readWigDataById(e,i,n,a)}if(this.topLevelReductionCache){for(var s=[],l=this.topLevelReductionCache,d=0;d<l.length;++d)l[d]._chromId==e&&s.push(l[d]);return a(s)}this.getZoomedView(this.zoomLevels.length-1).readWigDataById(-1,0,3e8,function(o){return r.topLevelReductionCache=o,r._tsFetch(t,e,i,n,a)})},l.prototype.thresholdSearch=function(t,e,i,n,a){function r(){if(0==l.length)return a(null);l.sort(function(t,e){var n=t.zoom-e.zoom;return 0!=n?n:(n=t.chrOrd-e.chrOrd,0!=n?n:t.min-e.min*i)});var t=l.splice(0,1)[0];o._tsFetch(t.zoom,t.chr,t.min,t.max,function(o){var s=i>0?0:3e8;t.fromRef&&(s=e);for(var d=0;d<o.length;++d){var c,u=o[d];if(c=void 0!=u.maxScore?u.maxScore:u.score,i>0){if(c>n)if(t.zoom<0){if(u.min>s)return a(u)}else u.max>s&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:u.min,max:u.max,fromRef:t.fromRef})}else if(c>n)if(t.zoom<0){if(u.max<s)return a(u)}else u.min<s&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:u.min,max:u.max,fromRef:t.fromRef})}r()})}i=i<0?-1:1;for(var o=this,s=this.chromsToIDs[t],l=[{chrOrd:0,chr:s,zoom:o.zoomLevels.length-4,min:0,max:3e8,fromRef:!0}],d=1;d<=this.maxID+1;++d){var c=(s+i*d)%(this.maxID+1);c<0&&(c+=this.maxID+1),l.push({chrOrd:d,chr:c,zoom:o.zoomLevels.length-1,min:0,max:3e8})}r()},l.prototype.getAutoSQL=function(t){if(!this.asOffset)return t(null);n.when(o(this.url,this.asOffset,2048)).then(function(e){for(var i=new Uint8Array(e),n="",a=0;a<i.length&&0!=i[a];++a)n+=String.fromCharCode(i[a]);var r=/(\w+)\s+(\w+)\s+("([^"]+)")?\s+\(\s*/,o=/([\w\[\]]+)\s+(\w+)\s*;\s*("([^"]+)")?\s*/g,s=r.exec(n);if(s){var l={declType:s[1],name:s[2],comment:s[4],fields:[]};n=n.substring(s[0]);for(var d=o.exec(n);null!=d;d=o.exec(n))l.fields.push({type:d[1],name:d[2],comment:d[4]});return t(l)}})},l.prototype.getExtraIndices=function(t){var e=this;if(this.version<4||0==this.extHeaderOffset||"bigbed"!=this.type)return t(null);this.data.slice(this.extHeaderOffset,64).fetch(function(i){if(!i)return t(null,"Couldn't fetch extension header");var n=new Uint8Array(i),a=new Int16Array(i),r=(new Int32Array(i),a[0],a[1]),o=s(n,4);if(0==r)return t(null);e.data.slice(o,20*r).fetch(function(i){if(!i)return t(null,"Couldn't fetch index info");for(var n=new Uint8Array(i),a=new Int16Array(i),o=(new Int32Array(i),[]),l=0;l<r;++l){var d=a[10*l],c=a[10*l+1],h=s(n,20*l+4),f=a[10*l+8],p=new u(e,d,c,h,f);o.push(p)}t(o)})})},u.prototype.lookup=function(t,e){var i=this;this.bbi.data.slice(this.offset,32).fetch(function(n){function a(n){i.bbi.data.slice(n,4+d*(c+u)).fetch(function(n){var o=new Uint8Array(n),l=new Uint16Array(n),d=(new Uint32Array(n),o[0]),h=l[1],f=4;if(0!=d){for(var p=0;p<h;++p){for(var _="",m=0;m<c;++m){var g=o[f++];0!=g&&(_+=String.fromCharCode(g))}if(_==t){var v=s(o,f),b=r(o,f+8);return i.bbi.getUnzoomedView().fetchFeatures(function(e,n,a,r){if(r&&r.length>i.field-3)return r[i.field-3]==t},[{offset:v,size:b}],e)}f+=u}return e([])}for(var w=null,p=0;p<h;++p){for(var _="",m=0;m<c;++m){var g=o[f++];0!=g&&(_+=String.fromCharCode(g))}var y=s(o,f);if(f+=8,t.localeCompare(_)<0&&w)return void a(w);w=y}a(w)})}var o=new Uint8Array(n),l=(new Int16Array(n),new Int32Array(n)),d=(l[0],l[1]),c=l[2],u=l[3];s(o,16);a(i.offset+32)})},{makeBwg:c}}.apply(e,a))&&(t.exports=r)}).call(e,i(0))},function(t,e,i){var n,a;n=[],void 0!==(a=function(){"use strict";function t(t,e){if("number"!=typeof t||"number"!=typeof e)throw"Bad range "+t+","+e;this._min=t,this._max=e}function e(t){var e=t.sort(o),i=[],n=e.shift();e.forEach(function(t){t._min<=n._max?t._max>n._max&&(n._max=t._max):(i.push(n),n=t)}),i.push(n),this._ranges=i}function i(t,i){return t instanceof e||(t instanceof Array||(t=[t]),t=new e(t)),i&&t.insertRange(i),t}function n(i,n){for(var a=i.ranges(),r=n.ranges(),o=a.length,s=r.length,l=0,d=0,c=[];l<o&&d<s;){var i=a[l],n=r[d],u=Math.max(i.min(),n.min()),h=Math.min(i.max(),n.max());h>=u&&c.push(new t(u,h)),i.max()>n.max()?++d:++l}return 0==c.length?null:1==c.length?c[0]:new e(c)}function a(t){for(var e=0,i=t.ranges(),n=0;n<i.length;++n){var a=i[n];e+=a.max()-a.min()+1}return e}function r(t,e){return t.min()<e.min()?-1:t.min()>e.min()?1:t.max()<e.max()?-1:e.max()>t.max()?1:0}function o(t,e){return t._min<e._min?-1:t._min>e._min?1:t._max<e._max?-1:e._max>t._max?1:0}return t.prototype.min=function(){return this._min},t.prototype.max=function(){return this._max},t.prototype.contains=function(t){return t>=this._min&&t<=this._max},t.prototype.isContiguous=function(){return!0},t.prototype.ranges=function(){return[this]},t.prototype._pushRanges=function(t){t.push(this)},t.prototype.toString=function(){return"["+this._min+"-"+this._max+"]"},e.prototype.min=function(){return this._ranges[0].min()},e.prototype.max=function(){return this._ranges[this._ranges.length-1].max()},e.prototype.lower_bound=function(t){var e=this.ranges();if(t>this.max())return e.length;if(t<this.min())return 0;for(var i=0,n=e.length-1;i<=n;){var a=Math.floor((i+n)/2);if(t>e[a]._max)i=a+1;else{if(!(t<e[a]._min))return a;n=a-1}}return i},e.prototype.contains=function(t){var e=this.lower_bound(t);return!!(e<this._ranges.length&&this._ranges[e].contains(t))},e.prototype.insertRange=function(t){var e=this.lower_bound(t._min);if(e===this._ranges.length)return void this._ranges.push(t);var i=this.ranges();if(t._max<i[e]._min)return void this._ranges.splice(e,0,t);i[e]._min<t._min&&(t._min=i[e]._min);for(var n=e+1;n<i.length&&i[n]._min<=t._max;)n++;n--,i[n]._max>t._max&&(t._max=i[n]._max),this._ranges.splice(e,n-e+1,t)},e.prototype.isContiguous=function(){return this._ranges.length>1},e.prototype.ranges=function(){return this._ranges},e.prototype._pushRanges=function(t){for(var e=0;e<this._ranges.length;++e)t.push(this._ranges[e])},e.prototype.toString=function(){for(var t="",e=0;e<this._ranges.length;++e)e>0&&(t+=","),t+=this._ranges[e].toString();return t},{Range:t,union:i,intersection:n,coverage:a,rangeOver:r,_rangeOrder:o}}.apply(e,n))&&(t.exports=a)},function(t,e,i){var n,a;n=[],void 0!==(a=function(){function t(){}function e(){this.was=[0]}function i(t,e,i){this.hufts=new Int32Array(3*u),this.window=new Uint8Array(i),this.end=i,this.checkfn=e,this.mode=g,this.reset(t,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new n,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new a}function n(){}function a(){}function r(t,e,i,n,a){return t[0]=v,e[0]=b,i[0]=w,n[0]=y,f}function o(t,e,i,n,a){if(0!=a){if(!t)throw"Undef src";if(!i)throw"Undef dest";0==e&&a==t.length?l(t,i,n):O?l(t.subarray(e,e+a),i,n):1==t.BYTES_PER_ELEMENT&&a>100?l(new Uint8Array(t.buffer,t.byteOffset+e,a),i,n):s(t,e,i,n,a)}}function s(t,e,i,n,a){for(var r=0;r<a;++r)i[n+r]=t[e+r]}function l(t,e,i){e.set(t,i)}function d(e,i,n,a){e=i?n?new Uint8Array(e,i,n):new Uint8Array(e,i,e.byteLength-i):new Uint8Array(e);var r=new t;r.inflateInit(c,!0),r.next_in=e,r.next_in_index=0,r.avail_in=e.length;for(var s=[],l=0;;){var d=new Uint8Array(32e3);r.next_out=d,r.next_out_index=0,r.avail_out=d.length;var u=r.inflate(h);if(u!=f&&u!=p&&u!=_)throw r.msg;if(0!=r.avail_out){var m=new Uint8Array(d.length-r.avail_out);o(d,0,m,0,d.length-r.avail_out),d=m}if(s.push(d),l+=d.length,u==p||u==_)break}if(a&&(a[0]=(i||0)+r.next_in_index),1==s.length)return s[0].buffer;for(var g=new Uint8Array(l),v=0,b=0;b<s.length;++b){var w=s[b];o(w,0,g,v,w.length),v+=w.length}return g.buffer}var c=15,u=1440,h=0,f=0,p=1,_=-5,m=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],g=0,v=9,b=5,w=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],y=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];t.prototype.inflateInit=function(t,i){return t||(t=c),i&&(i=!1),this.istate=new e,this.istate.inflateInit(this,i?-t:t)},t.prototype.inflate=function(t){return null==this.istate?-2:this.istate.inflate(this,t)},t.prototype.inflateEnd=function(){if(null==this.istate)return-2;var t=istate.inflateEnd(this);return this.istate=null,t},t.prototype.inflateSync=function(){return istate.inflateSync(this)},t.prototype.inflateSetDictionary=function(t,e){return istate.inflateSetDictionary(this,t,e)},e.prototype.inflateReset=function(t){return null==t||null==t.istate?-2:(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=0!=t.istate.nowrap?7:0,t.istate.blocks.reset(t,null),f)},e.prototype.inflateEnd=function(t){return null!=this.blocks&&this.blocks.free(t),this.blocks=null,f},e.prototype.inflateInit=function(t,e){return t.msg=null,this.blocks=null,nowrap=0,e<0&&(e=-e,nowrap=1),e<8||e>15?(this.inflateEnd(t),-2):(this.wbits=e,t.istate.blocks=new i(t,0!=t.istate.nowrap?null:this,1<<e),this.inflateReset(t),f)},e.prototype.inflate=function(t,e){var i,n;if(null==t||null==t.istate||null==t.next_in)return-2;for(e=4==e?_:f,i=_;;)switch(t.istate.mode){case 0:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,8!=(15&(t.istate.method=t.next_in[t.next_in_index++]))){t.istate.mode=13,t.msg="unknown compression method",t.istate.marker=5;break}if(8+(t.istate.method>>4)>t.istate.wbits){t.istate.mode=13,t.msg="invalid window size",t.istate.marker=5;break}t.istate.mode=1;case 1:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,n=255&t.next_in[t.next_in_index++],((t.istate.method<<8)+n)%31!=0){t.istate.mode=13,t.msg="incorrect header check",t.istate.marker=5;break}if(0==(32&n)){t.istate.mode=7;break}t.istate.mode=2;case 2:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=3;case 3:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=4;case 4:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=5;case 5:return 0==t.avail_in?i:(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.adler=t.istate.need,t.istate.mode=6,2);case 6:return t.istate.mode=13,t.msg="need dictionary",t.istate.marker=0,-2;case 7:if(-3==(i=t.istate.blocks.proc(t,i))){t.istate.mode=13,t.istate.marker=0;break}if(i==f&&(i=e),i!=p)return i;if(i=e,t.istate.blocks.reset(t,t.istate.was),0!=t.istate.nowrap){t.istate.mode=12;break}t.istate.mode=8;case 8:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=9;case 9:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=10;case 10:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=11;case 11:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.istate.was[0]!=t.istate.need){t.istate.mode=13,t.msg="incorrect data check",t.istate.marker=5;break}t.istate.mode=12;case 12:return p;case 13:return-3;default:return-2}},e.prototype.inflateSetDictionary=function(t,e,i){var n=0,a=i;return null==t||null==t.istate||6!=t.istate.mode?-2:t._adler.adler32(1,e,0,i)!=t.adler?-3:(t.adler=t._adler.adler32(0,null,0,0),a>=1<<t.istate.wbits&&(a=(1<<t.istate.wbits)-1,n=i-a),t.istate.blocks.set_dictionary(e,n,a),t.istate.mode=7,f)};var $=[0,0,255,255];e.prototype.inflateSync=function(t){var e,i,n,a,r;if(null==t||null==t.istate)return-2;if(13!=t.istate.mode&&(t.istate.mode=13,t.istate.marker=0),0==(e=t.avail_in))return _;for(i=t.next_in_index,n=t.istate.marker;0!=e&&n<4;)t.next_in[i]==$[n]?n++:n=0!=t.next_in[i]?0:4-n,i++,e--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=e,t.istate.marker=n,4!=n?-3:(a=t.total_in,r=t.total_out,this.inflateReset(t),t.total_in=a,t.total_out=r,t.istate.mode=7,f)},e.prototype.inflateSyncPoint=function(t){return null==t||null==t.istate||null==t.istate.blocks?-2:t.istate.blocks.sync_point()};var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];i.prototype.reset=function(t,e){e&&(e[0]=this.check),6==this.mode&&this.codes.free(t),this.mode=g,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(t.adler=this.check=t._adler.adler32(0,null,0,0))},i.prototype.proc=function(t,e){var i,n,a,s,l,d,c;for(s=t.next_in_index,l=t.avail_in,n=this.bitb,a=this.bitk,d=this.write,c=d<this.read?this.read-d-1:this.end-d;;)switch(this.mode){case g:for(;a<3;){if(0==l)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<a,a+=8}switch(i=7&n,this.last=1&i,i>>>1){case 0:n>>>=3,a-=3,i=7&a,n>>>=i,a-=i,this.mode=1;break;case 1:var u=new Int32Array(1),h=new Int32Array(1),_=[],v=[];r(u,h,_,v,t),this.codes.init(u[0],h[0],_[0],0,v[0],0,t),n>>>=3,a-=3,this.mode=6;break;case 2:n>>>=3,a-=3,this.mode=3;break;case 3:return n>>>=3,a-=3,this.mode=13,t.msg="invalid block type",e=-3,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e)}break;case 1:for(;a<32;){if(0==l)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<a,a+=8}if((~n>>>16&65535)!=(65535&n))return this.mode=13,t.msg="invalid stored block lengths",e=-3,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);this.left=65535&n,n=a=0,this.mode=0!=this.left?2:0!=this.last?7:g;break;case 2:if(0==l)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,write=d,this.inflate_flush(t,e);if(0==c&&(d==end&&0!=read&&(d=0,c=d<this.read?this.read-d-1:this.end-d),0==c&&(this.write=d,e=this.inflate_flush(t,e),d=this.write,c=d<this.read?this.read-d-1:this.end-d,d==this.end&&0!=this.read&&(d=0,c=d<this.read?this.read-d-1:this.end-d),0==c)))return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);if(e=f,i=this.left,i>l&&(i=l),i>c&&(i=c),o(t.next_in,s,this.window,d,i),s+=i,l-=i,d+=i,c-=i,0!=(this.left-=i))break;this.mode=0!=this.last?7:g;break;case 3:for(;a<14;){if(0==l)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<a,a+=8}if(this.table=i=16383&n,(31&i)>29||(i>>5&31)>29)return this.mode=9,t.msg="too many length or distance symbols",e=-3,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);if(i=258+(31&i)+(i>>5&31),null==this.blens||this.blens.length<i)this.blens=new Int32Array(i);else for(var b=0;b<i;b++)this.blens[b]=0;n>>>=14,a-=14,this.index=0,mode=4;case 4:for(;this.index<4+(this.table>>>10);){for(;a<3;){if(0==l)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<a,a+=8}this.blens[T[this.index++]]=7&n,n>>>=3,a-=3}for(;this.index<19;)this.blens[T[this.index++]]=0;if(this.bb[0]=7,(i=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,t))!=f)return e=i,-3==e&&(this.blens=null,this.mode=9),this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,write=d,this.inflate_flush(t,e);this.index=0,this.mode=5;case 5:for(;;){if(i=this.table,!(this.index<258+(31&i)+(i>>5&31)))break;var b,w,y;for(i=this.bb[0];a<i;){if(0==l)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<a,a+=8}if(i=this.hufts[3*(this.tb[0]+(n&m[i]))+1],(y=this.hufts[3*(this.tb[0]+(n&m[i]))+2])<16)n>>>=i,a-=i,this.blens[this.index++]=y;else{for(b=18==y?7:y-14,w=18==y?11:3;a<i+b;){if(0==l)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<a,a+=8}if(n>>>=i,a-=i,w+=n&m[b],n>>>=b,a-=b,b=this.index,i=this.table,b+w>258+(31&i)+(i>>5&31)||16==y&&b<1)return this.blens=null,this.mode=9,t.msg="invalid bit length repeat",e=-3,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);y=16==y?this.blens[b-1]:0;do{this.blens[b++]=y}while(0!=--w);this.index=b}}this.tb[0]=-1;var u=new Int32Array(1),h=new Int32Array(1),_=new Int32Array(1),v=new Int32Array(1);if(u[0]=9,h[0]=6,i=this.table,(i=this.inftree.inflate_trees_dynamic(257+(31&i),1+(i>>5&31),this.blens,u,h,_,v,this.hufts,t))!=f)return-3==i&&(this.blens=null,this.mode=13),e=i,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);this.codes.init(u[0],h[0],this.hufts,_[0],this.hufts,v[0],t),this.mode=6;case 6:if(this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,(e=this.codes.proc(this,t,e))!=p)return this.inflate_flush(t,e);if(e=f,this.codes.free(t),s=t.next_in_index,l=t.avail_in,n=this.bitb,a=this.bitk,d=this.write,c=d<this.read?this.read-d-1:this.end-d,0==this.last){this.mode=g;break}this.mode=7;case 7:if(this.write=d,e=this.inflate_flush(t,e),d=this.write,c=d<this.read?this.read-d-1:this.end-d,this.read!=this.write)return this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);mode=12;case 8:return e=p,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);case 9:return e=-3,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e);default:return e=-2,this.bitb=n,this.bitk=a,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=d,this.inflate_flush(t,e)}},i.prototype.free=function(t){this.reset(t,null),this.window=null,this.hufts=null},i.prototype.set_dictionary=function(t,e,i){o(t,e,window,0,i),this.read=this.write=i},i.prototype.sync_point=function(){return 1==this.mode},i.prototype.inflate_flush=function(t,e){var i,n,a;return n=t.next_out_index,a=this.read,i=(a<=this.write?this.write:this.end)-a,i>t.avail_out&&(i=t.avail_out),0!=i&&e==_&&(e=f),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,a,i)),o(this.window,a,t.next_out,n,i),n+=i,a+=i,a==this.end&&(a=0,this.write==this.end&&(this.write=0),i=this.write-a,i>t.avail_out&&(i=t.avail_out),0!=i&&e==_&&(e=f),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,a,i)),o(this.window,a,t.next_out,n,i),n+=i,a+=i),t.next_out_index=n,this.read=a,e};n.prototype.init=function(t,e,i,n,a,r,o){this.mode=0,this.lbits=t,this.dbits=e,this.ltree=i,this.ltree_index=n,this.dtree=a,this.dtree_index=r,this.tree=null},n.prototype.proc=function(t,e,i){var n,a,r,o,s,l,d,c=0,u=0,h=0;for(h=e.next_in_index,o=e.avail_in,c=t.bitb,u=t.bitk,s=t.write,l=s<t.read?t.read-s-1:t.end-s;;)switch(this.mode){case 0:if(l>=258&&o>=10&&(t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,i=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,t,e),h=e.next_in_index,o=e.avail_in,c=t.bitb,u=t.bitk,s=t.write,l=s<t.read?t.read-s-1:t.end-s,i!=f)){this.mode=i==p?7:9;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=1;case 1:for(n=this.need;u<n;){if(0==o)return t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,c|=(255&e.next_in[h++])<<u,u+=8}if(a=3*(this.tree_index+(c&m[n])),c>>>=this.tree[a+1],u-=this.tree[a+1],0==(r=this.tree[a])){this.lit=this.tree[a+2],this.mode=6;break}if(0!=(16&r)){this.get=15&r,this.len=this.tree[a+2],this.mode=2;break}if(0==(64&r)){this.need=r,this.tree_index=a/3+this.tree[a+2];break}if(0!=(32&r)){this.mode=7;break}return this.mode=9,e.msg="invalid literal/length code",i=-3,t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);case 2:for(n=this.get;u<n;){if(0==o)return t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,c|=(255&e.next_in[h++])<<u,u+=8}this.len+=c&m[n],c>>=n,u-=n,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=3;case 3:for(n=this.need;u<n;){if(0==o)return t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,c|=(255&e.next_in[h++])<<u,u+=8}if(a=3*(this.tree_index+(c&m[n])),c>>=this.tree[a+1],u-=this.tree[a+1],0!=(16&(r=this.tree[a]))){this.get=15&r,this.dist=this.tree[a+2],this.mode=4;break}if(0==(64&r)){this.need=r,this.tree_index=a/3+this.tree[a+2];break}return this.mode=9,e.msg="invalid distance code",i=-3,t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);case 4:for(n=this.get;u<n;){if(0==o)return t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,c|=(255&e.next_in[h++])<<u,u+=8}this.dist+=c&m[n],c>>=n,u-=n,this.mode=5;case 5:for(d=s-this.dist;d<0;)d+=t.end;for(;0!=this.len;){if(0==l&&(s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l&&(t.write=s,i=t.inflate_flush(e,i),s=t.write,l=s<t.read?t.read-s-1:t.end-s,s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l)))return t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);t.window[s++]=t.window[d++],l--,d==t.end&&(d=0),this.len--}this.mode=0;break;case 6:if(0==l&&(s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l&&(t.write=s,i=t.inflate_flush(e,i),s=t.write,l=s<t.read?t.read-s-1:t.end-s,s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l)))return t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,t.window[s++]=this.lit,l--,this.mode=0;break;case 7:if(u>7&&(u-=8,o++,h--),t.write=s,i=t.inflate_flush(e,i),s=t.write,l=s<t.read?t.read-s-1:t.end-s,t.read!=t.write)return t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);this.mode=8;case 8:return i=p,t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);case 9:return i=-3,t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);default:return i=-2,t.bitb=c,t.bitk=u,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i)}},n.prototype.free=function(t){},n.prototype.inflate_fast=function(t,e,i,n,a,r,s,l){var d,c,u,h,_,g,v,b,w,y,x,k,C,S,$,T;v=l.next_in_index,b=l.avail_in,_=s.bitb,g=s.bitk,w=s.write,y=w<s.read?s.read-w-1:s.end-w,x=m[t],k=m[e];do{for(;g<20;)b--,_|=(255&l.next_in[v++])<<g,g+=8;if(d=_&x,c=i,u=n,T=3*(u+d),0!=(h=c[T]))for(;;){if(_>>=c[T+1],g-=c[T+1],0!=(16&h)){for(h&=15,C=c[T+2]+(_&m[h]),_>>=h,g-=h;g<15;)b--,_|=(255&l.next_in[v++])<<g,g+=8;for(d=_&k,c=a,u=r,T=3*(u+d),h=c[T];;){if(_>>=c[T+1],g-=c[T+1],0!=(16&h)){for(h&=15;g<h;)b--,_|=(255&l.next_in[v++])<<g,g+=8;if(S=c[T+2]+(_&m[h]),_>>=h,g-=h,y-=C,w>=S)$=w-S,s.window[w++]=s.window[$++],s.window[w++]=s.window[$++],C-=2;else{$=w-S;do{$+=s.end}while($<0);if(h=s.end-$,C>h){if(C-=h,w-$>0&&h>w-$)do{s.window[w++]=s.window[$++]}while(0!=--h);else o(s.window,$,s.window,w,h),w+=h,$+=h,h=0;$=0}}do{s.window[w++]=s.window[$++]}while(0!=--C);break}if(0!=(64&h))return l.msg="invalid distance code",C=l.avail_in-b,C=g>>3<C?g>>3:C,b+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=b,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=w,-3;d+=c[T+2],d+=_&m[h],T=3*(u+d),h=c[T]}break}if(0!=(64&h))return 0!=(32&h)?(C=l.avail_in-b,C=g>>3<C?g>>3:C,b+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=b,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=w,p):(l.msg="invalid literal/length code",C=l.avail_in-b,C=g>>3<C?g>>3:C,b+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=b,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=w,-3);if(d+=c[T+2],d+=_&m[h],T=3*(u+d),0==(h=c[T])){_>>=c[T+1],g-=c[T+1],s.window[w++]=c[T+2],y--;break}}else _>>=c[T+1],g-=c[T+1],s.window[w++]=c[T+2],y--}while(y>=258&&b>=10);return C=l.avail_in-b,C=g>>3<C?g>>3:C,b+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=b,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=w,f},a.prototype.huft_build=function(t,e,i,n,a,r,s,l,d,c,h){var p,m,g,v,b,w,y,x,k,C,S,$,T,M,O;C=0,b=i;do{this.c[t[e+C]]++,C++,b--}while(0!=b);if(this.c[0]==i)return s[0]=-1,l[0]=0,f;for(x=l[0],w=1;w<=15&&0==this.c[w];w++);for(y=w,x<w&&(x=w),b=15;0!=b&&0==this.c[b];b--);for(g=b,x>b&&(x=b),l[0]=x,M=1<<w;w<b;w++,M<<=1)if((M-=this.c[w])<0)return-3;if((M-=this.c[b])<0)return-3;for(this.c[b]+=M,this.x[1]=w=0,C=1,T=2;0!=--b;)this.x[T]=w+=this.c[C],T++,C++;b=0,C=0;do{0!=(w=t[e+C])&&(this.v[this.x[w]++]=b),C++}while(++b<i);for(i=this.x[g],this.x[0]=b=0,C=0,v=-1,$=-x,this.u[0]=0,S=0,O=0;y<=g;y++)for(p=this.c[y];0!=p--;){for(;y>$+x;){if(v++,$+=x,O=g-$,O=O>x?x:O,(m=1<<(w=y-$))>p+1&&(m-=p+1,T=y,w<O))for(;++w<O&&!((m<<=1)<=this.c[++T]);)m-=this.c[T];if(O=1<<w,this.hn[0]+O>u)return-3;this.u[v]=S=this.hn[0],this.hn[0]+=O,0!=v?(this.x[v]=b,this.r[0]=w,this.r[1]=x,w=b>>>$-x,this.r[2]=S-this.u[v-1]-w,o(this.r,0,d,3*(this.u[v-1]+w),3)):s[0]=S}for(this.r[1]=y-$,C>=i?this.r[0]=192:h[C]<n?(this.r[0]=this.v[C]<256?0:96,this.r[2]=this.v[C++]):(this.r[0]=r[this.v[C]-n]+16+64,this.r[2]=a[this.v[C++]-n]),m=1<<y-$,w=b>>>$;w<O;w+=m)o(this.r,0,d,3*(S+w),3);for(w=1<<y-1;0!=(b&w);w>>>=1)b^=w;for(b^=w,k=(1<<$)-1;(b&k)!=this.x[v];)v--,$-=x,k=(1<<$)-1}return 0!=M&&1!=g?_:f},a.prototype.inflate_trees_bits=function(t,e,i,n,a){var r;return this.initWorkArea(19),this.hn[0]=0,r=this.huft_build(t,0,19,19,null,null,i,e,n,this.hn,this.v),-3==r?a.msg="oversubscribed dynamic bit lengths tree":r!=_&&0!=e[0]||(a.msg="incomplete dynamic bit lengths tree",r=-3),r},a.prototype.inflate_trees_dynamic=function(t,e,i,n,a,r,o,s,l){var d;return this.initWorkArea(288),this.hn[0]=0,(d=this.huft_build(i,0,t,257,x,k,r,n,s,this.hn,this.v))!=f||0==n[0]?(-3==d?l.msg="oversubscribed literal/length tree":-4!=d&&(l.msg="incomplete literal/length tree",d=-3),d):(this.initWorkArea(288),d=this.huft_build(i,t,e,0,C,S,o,a,s,this.hn,this.v),d!=f||0==a[0]&&t>257?(-3==d?l.msg="oversubscribed distance tree":d==_?(l.msg="incomplete distance tree",d=-3):-4!=d&&(l.msg="empty distance tree with lengths",d=-3),d):f)},a.prototype.initWorkArea=function(t){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(t),this.c=new Int32Array(16),this.r=new Int32Array(3),this.u=new Int32Array(15),this.x=new Int32Array(16)),this.v.length<t&&(this.v=new Int32Array(t));for(var e=0;e<t;e++)this.v[e]=0;for(var e=0;e<16;e++)this.c[e]=0;for(var e=0;e<3;e++)this.r[e]=0;o(this.c,0,this.u,0,15),o(this.c,0,this.x,0,16)};var M=new Uint8Array(1),O="function"==typeof M.subarray;return{inflateBuffer:d,arrayCopy:o}}.apply(e,n))&&(t.exports=a)},function(t,e,i){(function(n){var a,r,o;!function(n,s){r=[i(0)],a=s,void 0!==(o="function"==typeof a?a.apply(e,r):a)&&(t.exports=o)}(0,function(t){var e=t.ajaxSettings;e.responseFields.native="responseNative",e.converters["* native"]=!0;var i={},a=0,r={0:200,1223:204},o={},s=n.ajaxSettings.xhr();window.ActiveXObject&&t(window).on("unload",function(){for(var t in o)o[t]()}),i.cors=!!s&&"withCredentials"in s,i.ajax=s=!!s,t.ajaxTransport("native",function(t){var e;if(i.cors||s&&!t.crossDomain)return{send:function(i,n){var s,l=t.xhr(),d=++a,c={};if(l.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)l[s]=t.xhrFields[s];t.mimeType&&l.overrideMimeType&&l.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)l.setRequestHeader(s,i[s]);e=function(t){return function(){e&&(delete o[d],e=l.onload=l.onerror=null,"abort"===t?l.abort():"error"===t?n(l.status,l.statusText):(l.response&&(c.native=l.response),n(r[l.status]||l.status,l.statusText,c,l.getAllResponseHeaders())))}},l.onload=e(),l.onerror=e("error"),e=o[d]=e("abort");try{l.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),t.getNative=function(e,i){return t.ajax({dataType:"native",url:e,xhrFields:{responseType:"arraybuffer"},success:i})}})}).call(e,i(0))},,,function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=(a(r),i(1)),s=a(o),l=i(8),d=n(l),c=i(7),u=n(c),h=s.Model.extend(d.default.LoggableMixin).extend({_logNamespace:"user",urlRoot:function(){return Galaxy.root+"api/users"},defaults:{id:null,username:"("+(0,u.default)("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(t){this.log("User.initialize:",t),this.on("loaded",function(t,e){this.log(this+" has loaded:",t,e)}),this.on("change",function(t,e){this.log(this+" has changed:",t,e.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(t,e){t=t||h.CURRENT_ID_STR,e=e||{};var i=this,n=e.success;return e.success=function(t,e){i.trigger("loaded",t,e),n&&n(t,e)},t===h.CURRENT_ID_STR&&(e.url=this.urlRoot+"/"+h.CURRENT_ID_STR),s.Model.prototype.fetch.call(this,e)},clearSessionStorage:function(){for(var t in sessionStorage)0===t.indexOf("history:")?sessionStorage.removeItem(t):"history-panel"===t&&sessionStorage.removeItem(t)},toString:function(){var t=[this.get("username")];return this.get("id")&&(t.unshift(this.get("id")),t.push(this.get("email"))),"User("+t.join(":")+")"}});h.CURRENT_ID_STR="current",h.getCurrentUserFromApi=function(t){var e=new h;return e.loadFromApi(h.CURRENT_ID_STR,t),e};s.Collection.extend(d.default.LoggableMixin).extend({model:h,urlRoot:function(){return Galaxy.root+"api/users"}});e.default={User:h}},,function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=(a(r),i(161)),s=a(o),l=i(163),d=a(l),c=i(164),u=a(c),h=t.View.extend({initialize:function(t){var e=this;this.options=t,this.setElement(this._template()),this.$navbarBrandLink=this.$(".navbar-brand-link"),this.$navbarBrandImage=this.$(".navbar-brand-image"),this.$navbarBrandTitle=this.$(".navbar-brand-title"),this.$navbarTabs=this.$(".navbar-tabs"),this.$quoteMeter=this.$(".quota-meter-container"),this.collection=new s.default.Collection,this.collection.on("add",function(t){e.$navbarTabs.append(new s.default.Tab({model:t}).render().$el)}).on("reset",function(){e.$navbarTabs.empty()}).on("dispatch",function(t){e.collection.each(function(e){t(e)})}).fetch(this.options),Galaxy.frame=this.frame=new d.default({collection:this.collection}),Galaxy.quotaMeter=this.quotaMeter=new u.default.UserQuotaMeter({model:Galaxy.user,el:this.$quoteMeter}),n(window).on("click",function(t){var e=n(t.target).closest("a[download]");1==e.length&&(0===n("iframe[id=download]").length&&n("body").append(n("<iframe/>").attr("id","download").hide()),n("iframe[id=download]").attr("src",e.attr("href")),t.preventDefault())}).on("beforeunload",function(){var t="";if(e.collection.each(function(e){var i=e.get("onbeforeunload")&&e.get("onbeforeunload")();i&&(t+=i+" ")}),""!==t)return t})},render:function(){return this.$navbarBrandTitle.html("Galaxy "+(this.options.brand&&"/ "+this.options.brand||"")),this.$navbarBrandLink.attr("href",this.options.logo_url),this.$navbarBrandImage.attr("src",this.options.logo_src),this.quotaMeter.render(),this},_template:function(){return'<div id="masthead" class="navbar navbar-fixed-top navbar-inverse"><div class="navbar-header"><div class="navbar-tabs"/></div><div class="navbar-brand"><a class="navbar-brand-link"><img class="navbar-brand-image"/><span class="navbar-brand-title"/></a></div><div class="quota-meter-container"/><div class="navbar-icons"/></div>'}});e.default={View:h}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n,a,r){function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(162),l=o(s),d=i(40),c=o(d),u=i(7),h=o(u),f=i(3),p=o(f),_=t.Collection.extend({model:t.Model.extend({defaults:{visible:!0,target:"_parent"}}),fetch:function(t){t=t||{},this.reset();var e=new l.default.GenericNavView;this.add(e.render()),this.add({id:"analysis",title:(0,h.default)("Analyze Data"),url:"",tooltip:(0,h.default)("Analysis home view")}),this.add({id:"workflow",title:(0,h.default)("Workflow"),tooltip:(0,h.default)("Chain tools into workflows"),disabled:!Galaxy.user.id,url:"workflows/list"}),this.add({id:"shared",title:(0,h.default)("Shared Data"),url:"library/index",tooltip:(0,h.default)("Access published resources"),menu:[{title:(0,h.default)("Data Libraries"),url:"library/list"},{title:(0,h.default)("Histories"),url:"histories/list_published"},{title:(0,h.default)("Workflows"),url:"workflows/list_published"},{title:(0,h.default)("Visualizations"),url:"visualizations/list_published"},{title:(0,h.default)("Pages"),url:"pages/list_published"}]}),this.add({id:"visualization",title:(0,h.default)("Visualization"),url:"visualizations/list",tooltip:(0,h.default)("Visualize datasets"),disabled:!Galaxy.user.id,menu:[{title:(0,h.default)("New Track Browser"),url:"visualization/trackster",target:"_frame"},{title:(0,h.default)("Saved Visualizations"),url:"visualizations/list",target:"_frame"},{title:(0,h.default)("Interactive Environments"),url:"visualization/gie_list",target:"galaxy_main"}]}),c.default.add({url:"api/webhooks/masthead/all",callback:function(t){n(document).ready(function(){n.each(t.models,function(t,e){var i=e.toJSON();if(i.activate){var n={id:i.name,icon:i.config.icon,url:i.config.url,tooltip:i.config.tooltip,onclick:i.config.function&&new Function(i.config.function)};Galaxy.page?Galaxy.page.masthead.collection.add(n):Galaxy.masthead&&Galaxy.masthead.collection.add(n),p.default.appendScriptStyle(i)}})})}}),Galaxy.user.get("is_admin")&&this.add({id:"admin",title:(0,h.default)("Admin"),url:"admin",tooltip:(0,h.default)("Administer this Galaxy"),cls:"admin-only"});var i={id:"help",title:(0,h.default)("Help"),tooltip:(0,h.default)("Support, contact, and community"),menu:[{title:(0,h.default)("Support"),url:t.support_url,target:"_blank"},{title:(0,h.default)("Search"),url:t.search_url,target:"_blank"},{title:(0,h.default)("Mailing Lists"),url:t.mailing_lists,target:"_blank"},{title:(0,h.default)("Videos"),url:t.screencasts_url,target:"_blank"},{title:(0,h.default)("Wiki"),url:t.wiki_url,target:"_blank"},{title:(0,h.default)("How to Cite Galaxy"),url:t.citation_url,target:"_blank"},{title:(0,h.default)("Interactive Tours"),url:"tours"}]};t.terms_url&&i.menu.push({title:(0,h.default)("Terms and Conditions"),url:t.terms_url,target:"_blank"}),t.biostar_url&&i.menu.unshift({title:(0,h.default)("Ask a question"),url:"biostar/biostar_question_redirect",target:"_blank"}),t.biostar_url&&i.menu.unshift({title:(0,h.default)("Galaxy Biostar"),url:t.biostar_url_redirect,target:"_blank"}),this.add(i);var r={};r=Galaxy.user.id?{id:"user",title:(0,h.default)("User"),cls:"loggedin-only",tooltip:(0,h.default)("Account and saved data"),menu:[{title:(0,h.default)("Logged in as")+" "+Galaxy.user.get("email")},{title:(0,h.default)("Preferences"),url:"user"},{title:(0,h.default)("Custom Builds"),url:"custom_builds"},{title:(0,h.default)("Logout"),url:"user/logout?session_csrf_token="+Galaxy.session_csrf_token,target:"_top",divider:!0},{title:(0,h.default)("Saved Histories"),url:"histories/list",target:"_top"},{title:(0,h.default)("Saved Datasets"),url:"datasets/list",target:"_top"},{title:(0,h.default)("Saved Pages"),url:"pages/list",target:"_top"}]}:t.allow_user_creation?{id:"user",title:(0,h.default)("Login or Register"),cls:"loggedout-only",tooltip:(0,h.default)("Account registration or login"),menu:[{title:(0,h.default)("Login"),url:"user/login",target:"galaxy_main",noscratchbook:!0},{title:(0,h.default)("Register"),url:"user/create",target:"galaxy_main",noscratchbook:!0}]}:{id:"user",title:(0,h.default)("Login"),cls:"loggedout-only",tooltip:(0,h.default)("Login"),url:"user/login",target:"galaxy_main",noscratchbook:!0},this.add(r);var o=this.get(t.active_view);return o&&o.set("active",!0),(new a.Deferred).resolve().promise()}}),m=t.View.extend({initialize:function(t){this.model=t.model,this.setElement(this._template()),this.$dropdown=this.$(".dropdown"),this.$toggle=this.$(".dropdown-toggle"),this.$menu=this.$(".dropdown-menu"),this.$note=this.$(".dropdown-note"),this.listenTo(this.model,"change",this.render,this)},events:{"click .dropdown-toggle":"_toggleClick"},render:function(){var t=this;return n(".tooltip").remove(),this.$el.attr("id",this.model.id).css({visibility:this.model.get("visible")&&"visible"||"hidden"}),this.model.set("url",this._formatUrl(this.model.get("url"))),this.$note.html(this.model.get("note")||"").removeClass().addClass("dropdown-note").addClass(this.model.get("note_cls")).css({display:this.model.get("show_note")&&"block"||"none"}),this.$toggle.html(this.model.get("title")||"").removeClass().addClass("dropdown-toggle").addClass(this.model.get("cls")).addClass(this.model.get("icon")&&"dropdown-icon fa "+this.model.get("icon")).addClass(this.model.get("toggle")&&"toggle").attr("target",this.model.get("target")).attr("href",this.model.get("url")).attr("title",this.model.get("tooltip")).tooltip("destroy"),this.model.get("tooltip")&&this.$toggle.tooltip({placement:"bottom"}),this.$dropdown.removeClass().addClass("dropdown").addClass(this.model.get("disabled")&&"disabled").addClass(this.model.get("active")&&"active"),this.model.get("menu")&&this.model.get("show_menu")?(this.$menu.show(),n("#dd-helper").show().off().on("click",function(){n("#dd-helper").hide(),t.model.set("show_menu",!1)})):(t.$menu.hide(),n("#dd-helper").hide()),this.$menu.empty().removeClass("dropdown-menu"),this.model.get("menu")&&(r.each(this.model.get("menu"),function(e){t.$menu.append(t._buildMenuItem(e)),e.divider&&t.$menu.append(n("<li/>").addClass("divider"))}),t.$menu.addClass("dropdown-menu"),t.$toggle.append(n("<b/>").addClass("caret"))),this},_buildMenuItem:function(t){var e=this;return t=r.defaults(t||{},{title:"",url:"",target:"_parent",noscratchbook:!1}),t.url=e._formatUrl(t.url),n("<li/>").append(n("<a/>").attr("href",t.url).attr("target",t.target).html(t.title).on("click",function(i){i.preventDefault(),e.model.set("show_menu",!1),t.onclick?t.onclick():Galaxy.frame.add(t)}))},_toggleClick:function(t){var e=this,i=this.model;if(t.preventDefault(),n(".tooltip").hide(),i.trigger("dispatch",function(t){i.id!==t.id&&t.get("menu")&&t.set("show_menu",!1)}),i.get("disabled")){var a=function(t,e){return n("<div/>").append(n("<a/>").attr("href",Galaxy.root+e).html(t)).html()};this.$toggle.popover&&this.$toggle.popover("destroy"),this.$toggle.popover({html:!0,placement:"bottom",content:"Please "+a("login","user/login?use_panels=True")+" or "+a("register","user/create?use_panels=True")+" to use this feature."}).popover("show"),setTimeout(function(){e.$toggle.popover("destroy")},5e3)}else i.get("menu")?i.set("show_menu",!0):i.get("onclick")?i.get("onclick")():Galaxy.frame.add(i.attributes)},_formatUrl:function(t){return"string"==typeof t&&-1===t.indexOf("//")&&"/"!=t.charAt(0)?Galaxy.root+t:t},_template:function(){return'<ul class="nav navbar-nav"><li class="dropdown"><a class="dropdown-toggle"/><ul class="dropdown-menu"/><div class="dropdown-note"/></li></ul>'}});e.default={Collection:_,Tab:m}}).call(e,i(1),i(0),i(0),i(2))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var a=i(9),r=function(t){return t&&t.__esModule?t:{default:t}}(a),o=t.View.extend({initialize:function(){this.modal=null},makeModalIframe:function(t){var e=window.Galaxy.config.communication_server_host,i=window.Galaxy.config.communication_server_port,a=escape(window.Galaxy.user.attributes.username),s=escape(window.Galaxy.config.persistent_communication_rooms),l="?username="+a+"&persistent_communication_rooms="+s,d=e+":"+i+l,c=null,u=null,h='<iframe class="f-iframe fade in communication-iframe" src="'+d+'"> </iframe>';return n(".chat-modal").length>0&&n(".chat-modal").remove(),o.modal=new r.default.View({body:h,height:350,width:600,closing_events:!0,title_separator:!1,cls:"ui-modal chat-modal"}),o.modal.show(),c=n(".chat-modal .modal-header"),u=n(".chat-modal .modal-body"),c.addClass("modal-header-body"),u.addClass("modal-header-body"),c.find("h4").remove(),c.removeAttr("min-height padding border"),c.append('<i class="fa fa-comment" aria-hidden="true" title="Communicate with other users"></i><i class="fa fa-expand expand-compress-modal" aria-hidden="true" title="Maximize"></i><i class="fa fa-times close-modal" aria-hidden="true" title="Close"></i>'),n(".close-modal").click(function(t){n(".chat-modal").css("display","none")}),n(".expand-compress-modal").click(function(t){n(".expand-compress-modal").hasClass("fa-expand")?(n(".chat-modal .modal-dialog").width("1000px"),n(".chat-modal .modal-body").height("575px"),n(".expand-compress-modal").removeClass("fa-expand").addClass("fa-compress"),n(".expand-compress-modal").attr("title","Minimize"),n(".expand-compress-modal").css("margin-left","96.2%")):(n(".chat-modal .modal-dialog").width("600px"),n(".chat-modal .modal-body").height("350px"),n(".expand-compress-modal").removeClass("fa-compress").addClass("fa-expand"),n(".expand-compress-modal").attr("title","Maximize"),n(".expand-compress-modal").css("margin-left","93.2%"))}),this},render:function(){var t=this;return{id:"show-chat-online",icon:"fa-comment-o",tooltip:"Chat online",visible:!1,onclick:t.makeModalIframe}}});e.default={GenericNavView:o}}).call(e,i(1),i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(45),s=r(o),l=i(15),d=r(l),c=i(13),u=r(c),h=i(145),f=r(h),p=i(7),_=r(p);e.default=t.View.extend({initialize:function(t){var e=this;t=t||{},this.frames=new s.default.View({visible:!1}),this.setElement(this.frames.$el),this.buttonActive=t.collection.add({id:"enable-scratchbook",icon:"fa-th",tooltip:(0,_.default)("Enable/Disable Scratchbook"),onclick:function(){e.active=!e.active,e.buttonActive.set({toggle:e.active,show_note:e.active,note_cls:e.active&&"fa fa-check"}),!e.active&&e.frames.hide()},onbeforeunload:function(){if(e.frames.length()>0)return"You opened "+e.frames.length()+" frame(s) which will be lost."}}),this.buttonLoad=t.collection.add({id:"show-scratchbook",icon:"fa-eye",tooltip:(0,_.default)("Show/Hide Scratchbook"),show_note:!0,visible:!1,onclick:function(t){e.frames.visible?e.frames.hide():e.frames.show()}}),this.frames.on("add remove",function(){this.visible&&0==this.length()&&this.hide(),e.buttonLoad.set({note:this.length(),visible:this.length()>0})}).on("show hide ",function(){e.buttonLoad.set({toggle:this.visible,icon:this.visible&&"fa-eye"||"fa-eye-slash"})}),this.history_cache={}},addDataset:function(t){var e=this,i=null;if(Galaxy&&Galaxy.currHistoryPanel){var a=Galaxy.currHistoryPanel.collection.historyId;this.history_cache[a]={name:Galaxy.currHistoryPanel.model.get("name"),dataset_ids:[]},Galaxy.currHistoryPanel.collection.each(function(t){!t.get("deleted")&&t.get("visible")&&e.history_cache[a].dataset_ids.push(t.get("id"))})}var r=function(t,i){if(t){var n=e.history_cache[t.get("history_id")];if(n&&n.dataset_ids){var a=n.dataset_ids,r=a.indexOf(t.get("id"));if(-1!==r&&r+i>=0&&r+i<a.length)return a[r+i]}}},o=function(t,n,a){var o=r(t,n);o?e._loadDataset(o,function(t,e){i=t,a.model.set(e)}):a.model.trigger("change")};this._loadDataset(t,function(t,a){i=t,e.add(n.extend({menu:[{icon:"fa fa-chevron-circle-left",tooltip:"Previous in History",onclick:function(t){o(i,-1,t)},disabled:function(){return!r(i,-1)}},{icon:"fa fa-chevron-circle-right",tooltip:"Next in History",onclick:function(t){o(i,1,t)},disabled:function(){return!r(i,1)}}]},a))})},_loadDataset:function(t,e){var i=this,r=new d.default.Dataset({id:t});a.when(r.fetch()).then(function(){var a=n.find(["tabular","interval"],function(t){return-1!==r.get("data_type").indexOf(t)}),o=r.get("name"),s=i.history_cache[r.get("history_id")];s&&(o=s.name+": "+o),e(r,a?{title:o,url:null,content:d.default.createTabularDatasetChunkedView({model:new d.default.TabularDataset(r.toJSON()),embedded:!0,height:"100%"}).$el}:{title:o,url:Galaxy.root+"datasets/"+t+"/display/?preview=True",content:null})})},addTrackster:function(t){var e=this,i=new u.default.Visualization({id:t});a.when(i.fetch()).then(function(){var t=new f.default.TracksterUI(Galaxy.root),a={title:i.get("name"),type:"other",content:function(e){var a={container:e,name:i.get("title"),id:i.id,dbkey:i.get("dbkey"),stand_alone:!1},r=i.get("latest_revision"),o=r.config.view.drawables;n.each(o,function(t){t.dataset={hda_ldda:t.hda_ldda,id:t.dataset_id}}),view=t.create_visualization(a,r.config.viewport,r.config.view.drawables,r.config.bookmarks,!1)}};e.add(a)})},add:function(t){if("_blank"==t.target)window.open(t.url);else if("_top"==t.target||"_parent"==t.target||"_self"==t.target)window.location=t.url;else if(!this.active||t.noscratchbook){var e=a(window.parent.document).find("#galaxy_main");"galaxy_main"==t.target||"center"==t.target?0===e.length?window.location=t.url+(-1==t.url.indexOf("?")?"?":"&")+"use_panels=True":e.attr("src",t.url):window.location=t.url}else this.frames.add(t)}})}).call(e,i(1),i(2),i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),s=r(o),l=i(7),d=r(l),c=t.View.extend(s.default.LoggableMixin).extend({_logNamespace:"user",options:{warnAtPercent:85,errorAtPercent:100},initialize:function(t){this.log(this+".initialize:",t),n.extend(this.options,t),this.listenTo(this.model,"change:quota_percent change:total_disk_usage",this.render)},update:function(t){return this.log(this+" updating user data...",t),this.model.loadFromApi(this.model.get("id"),t),this},isOverQuota:function(){return null!==this.model.get("quota_percent")&&this.model.get("quota_percent")>=this.options.errorAtPercent},_render_quota:function(){var t=this.model.toJSON(),e=t.quota_percent,i=a(this._templateQuotaMeter(t)),n=i.find(".progress-bar");return this.isOverQuota()?(n.attr("class","progress-bar progress-bar-danger"),i.find(".quota-meter-text").css("color","white"),this.trigger("quota:over",t)):e>=this.options.warnAtPercent?(n.attr("class","progress-bar progress-bar-warning"),this.trigger("quota:under quota:under:approaching",t)):(n.attr("class","progress-bar progress-bar-success"),this.trigger("quota:under quota:under:ok",t)),i},_render_usage:function(){var t=a(this._templateUsage(this.model.toJSON()));return this.log(this+".rendering usage:",t),t},render:function(){var t=null;return this.log(this+".model.quota_percent:",this.model.get("quota_percent")),t=null===this.model.get("quota_percent")||void 0===this.model.get("quota_percent")?this._render_usage():this._render_quota(),this.$el.html(t),this.$el.find(".quota-meter-text").tooltip(),this},_templateQuotaMeter:function(t){return['<div id="quota-meter" class="quota-meter progress">','<div class="progress-bar" style="width: ',t.quota_percent,'%"></div>','<div class="quota-meter-text" data-placement="left" style="top: 6px"',t.nice_total_disk_usage?' title="Using '+t.nice_total_disk_usage+'.  This value is recalculated when you log out.">':">",(0,d.default)("Using")," ",t.quota_percent,"%","</div>","</div>"].join("")},_templateUsage:function(t){return['<div id="quota-meter" class="quota-meter" style="background-color: transparent">','<div class="quota-meter-text" data-placement="left" data-original-title="This value is recalculated when you log out." style="top: 6px; color: white">',t.nice_total_disk_usage?(0,d.default)("Using ")+t.nice_total_disk_usage:"","</div>","</div>"].join("")},toString:function(){return"UserQuotaMeter("+this.model+")"}});e.default={UserQuotaMeter:c}}).call(e,i(1),i(2),i(0))},,,,,,,,,,,,,function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){return this._init(t||{},e||{})}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=a(o),l=i(1),d=a(l),c=i(8),u=n(c),h=i(158),f=n(h),p=i(178),_=n(p),m=i(59),g=n(m),v=i(7),b=n(v);(0,g.default)(r,"GalaxyApp");var w="galaxy:debug:namespaces",y=!1;try{y="true"==localStorage.getItem("galaxy:debug")}catch(t){console.log((0,b.default)("localStorage not available for debug flag retrieval"))}r.prototype._init=function(t,e){var i=this;return s.extend(i,d.Events),y&&(i.logger=console,console.debug("debugging galaxy:","options:",t,"bootstrapped:",e)),i._processOptions(t),i.root=t.root||"/",i.params=t.params||{},i.session_csrf_token=t.session_csrf_token||null,i._initConfig(t.config||{}),i._patchGalaxy(window.Galaxy),i._initLogger(i.options.loggerOptions||{}),i.debug("GalaxyApp.options: ",i.options),i.debug("GalaxyApp.config: ",i.config),i.debug("GalaxyApp.logger: ",i.logger),i._initLocale(),i.debug("GalaxyApp.localize: ",i.localize),i.config=t.config||{},i.debug("GalaxyApp.config: ",i.config),i._initUser(t.user||{}),i.debug("GalaxyApp.user: ",i.user),i._setUpListeners(),i.trigger("ready",i),i},r.prototype.defaultOptions={patchExisting:!0,root:"/",session_csrf_token:null},r.prototype._processOptions=function(t){var e=this,i=e.defaultOptions;e.options={};for(var n in i)i.hasOwnProperty(n)&&(e.options[n]=t.hasOwnProperty(n)?t[n]:i[n]);return e},r.prototype._initConfig=function(t){var e=this;return e.config=t,e.config.debug=y||e.config.debug,e},r.prototype._patchGalaxy=function(t){var e=this;if(e.options.patchExisting&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},r.prototype._initLogger=function(t){var e=this;if(e.config.debug){t.consoleLogger=t.consoleLogger||console,t.consoleLevel=t.consoleLevel||_.default.MetricsLogger.ALL;try{t.consoleNamespaceWhitelist=localStorage.getItem(w).split(",")}catch(t){}try{t.consoleFlattenMessages="true"==localStorage.getItem("galaxy:debug:flatten")}catch(t){}console.log(t.consoleFlattenMessages)}return e.logger=new _.default.MetricsLogger(t),e.emit={},["log","debug","info","warn","error","metric"].map(function(t){e.emit[t]=function(i){e.logger.emit(t,arguments[0],Array.prototype.slice.call(arguments,1))}}),e.config.debug&&(u.default.LoggableMixin.logger=e.logger),e},r.prototype._initLocale=function(t){var e=this;return e.debug("_initLocale:",t),e.localize=b.default,window._l=e.localize,e},r.prototype._initUser=function(t){var e=this;return e.debug("_initUser:",t),e.user=new f.default.User(t),e.user.logger=e.logger,e},r.prototype._setUpListeners=function(){var e=this;return e.lastAjax={},t(document).bind("ajaxSend",function(t,i,n){var a=n.data;try{a=JSON.parse(a)}catch(t){}e.lastAjax={url:location.href.slice(0,-1)+n.url,data:a}}),e},r.prototype.debugging=function(t){var e=this;try{if(void 0===t)return"true"===localStorage.getItem("galaxy:debug");if(t)return localStorage.setItem("galaxy:debug",!0),!0;localStorage.removeItem("galaxy:debug"),e.debuggingNamespaces(null)}catch(t){console.log((0,b.default)("localStorage not available for debug flag retrieval"))}return!1},r.prototype.debuggingNamespaces=function(t){var e=this;try{if(void 0===t){var i=localStorage.getItem(w);return"string"==typeof i?i.split(","):[]}null===t?localStorage.removeItem(w):localStorage.setItem(w,t);var n=e.debuggingNamespaces();return e.logger&&(e.logger.options.consoleNamespaceWhitelist=n),n}catch(t){console.log((0,b.default)("localStorage not available for debug namespace retrieval"))}},r.prototype.toString=function(){return"GalaxyApp("+(this.user?this.user.get("email")||"(anonymous)":"uninitialized")+")"},e.default={GalaxyApp:r}}).call(e,i(0))},function(t,e,i){"use strict";(function(t){function i(t){t=t||{};var e=this;return e.userId=window.bootstrapped&&window.bootstrapped.user?window.bootstrapped.user.id:null,e.userId=e.userId||t.userId||null,e.consoleLogger=t.consoleLogger||null,e._init(t),e}function n(t){var e=String(t);return"[object Object]"==e&&(e=JSON.stringify(t)),e}function a(t){return this._init(t||{})}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i.ALL=0,i.LOG=0,i.DEBUG=10,i.INFO=20,i.WARN=30,i.ERROR=40,i.METRIC=50,i.NONE=100,i.defaultOptions={logLevel:i.NONE,consoleLevel:i.NONE,defaultNamespace:"Galaxy",consoleNamespaceWhitelist:null,consoleFlattenMessages:!1,clientPrefix:"client.",maxCacheSize:3e3,postSize:1e3,addTime:!0,cacheKeyPrefix:"logs-",postUrl:"/api/metrics",delayPostInMs:6e5,getPingData:void 0,onServerResponse:void 0},i.prototype._init=function(t){var e=this;e.options={};for(var n in i.defaultOptions)i.defaultOptions.hasOwnProperty(n)&&(e.options[n]=t.hasOwnProperty(n)?t[n]:i.defaultOptions[n]);return e.options.logLevel=e._parseLevel(e.options.logLevel),e.options.consoleLevel=e._parseLevel(e.options.consoleLevel),e._sending=!1,e._waiting=null,e._postSize=e.options.postSize,e._initCache(),e},i.prototype._initCache=function(){try{this.cache=new a({maxSize:this.options.maxCacheSize,key:this.options.cacheKeyPrefix+this.userId})}catch(t){this._emitToConsole("warn","MetricsLogger",["Could not intitialize logging cache:",t]),this.options.logLevel=i.NONE}},i.prototype._parseLevel=function(t){var e=void 0===t?"undefined":r(t);if("number"===e)return t;if("string"===e){var n=t.toUpperCase();if(i.hasOwnProperty(n))return i[n]}throw new Error("Unknown log level: "+t)},i.prototype.emit=function(t,e,i){var n=this;return e=e||n.options.defaultNamespace,t&&i?(t=n._parseLevel(t),t>=n.options.logLevel&&n._addToCache(t,e,i),n.consoleLogger&&t>=n.options.consoleLevel&&n._emitToConsole(t,e,i),n):n},i.prototype._addToCache=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_addToCache:",arguments,this.options.addTime,this.cache.length()]);var n=this;try{n.cache.add(n._buildEntry(t,e,i))>=n._postSize&&n._postCache()}catch(t){n._emitToConsole("warn","MetricsLogger",["Metrics logger could not stringify logArguments:",e,i]),n._emitToConsole("error","MetricsLogger",[t])}return n},i.prototype._buildEntry=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_buildEntry:",arguments]);var n={level:t,namespace:this.options.clientPrefix+e,args:i};return this.options.addTime&&(n.time=(new Date).toISOString()),n},i.prototype._postCache=function(e){if(e=e||{},this._emitToConsole("info","MetricsLogger",["_postCache",e,this._postSize]),!this.options.postUrl||this._sending)return t.when({});var i=this,n=e.count||i._postSize,a=i.cache.get(n),r=a.length,o="function"==typeof i.options.getPingData?i.options.getPingData():{};return o.metrics=JSON.stringify(a),i._sending=!0,t.post(i.options.postUrl,o).always(function(){i._sending=!1}).fail(function(t,e,n){i._postSize=i.options.maxCacheSize,i.emit("error","MetricsLogger",["_postCache error:",t.readyState,t.status,t.responseJSON||t.responseText])}).done(function(t){"function"==typeof i.options.onServerResponse&&i.options.onServerResponse(t),i.cache.remove(r),i._postSize=i.options.postSize})},i.prototype._delayPost=function(){var t=this;t._waiting=setTimeout(function(){t._waiting=null},t.options.delayPostInMs)},i.prototype._emitToConsole=function(t,e,a){var r=this,o=r.options.consoleNamespaceWhitelist;if(!r.consoleLogger)return r;if(o&&-1===o.indexOf(e))return r;var s=Array.prototype.slice.call(a,0);return s.unshift(e),r.options.consoleFlattenMessages&&(s=[s.map(n).join(" ")]),t>=i.METRIC&&"function"==typeof r.consoleLogger.info?r.consoleLogger.info.apply(r.consoleLogger,s):t>=i.ERROR&&"function"==typeof r.consoleLogger.error?r.consoleLogger.error.apply(r.consoleLogger,s):(t>=i.WARN&&"function"==typeof r.consoleLogger.warn?r.consoleLogger.warn.apply(r.consoleLogger,s):t>=i.INFO&&"function"==typeof r.consoleLogger.info?r.consoleLogger.info.apply(r.consoleLogger,s):t>=i.DEBUG&&"function"==typeof r.consoleLogger.debug?r.consoleLogger.debug.apply(r.consoleLogger,s):"function"==typeof r.consoleLogger.log&&r.consoleLogger.log.apply(r.consoleLogger,s),r)},i.prototype.log=function(){this.emit(1,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.debug=function(){this.emit(i.DEBUG,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.info=function(){this.emit(i.INFO,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.warn=function(){this.emit(i.WARN,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.error=function(){this.emit(i.ERROR,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.metric=function(){this.emit(i.METRIC,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},a.defaultOptions={maxSize:5e3},a.prototype._init=function(t){if(!this._hasStorage())throw new Error("LoggingCache needs localStorage");if(!t.key)throw new Error("LoggingCache needs key for localStorage");return this.key=t.key,this._initStorage(),this.maxSize=t.maxSize||a.defaultOptions.maxSize,this},a.prototype._hasStorage=function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(t){return!1}},a.prototype._initStorage=function(){return null===localStorage.getItem(this.key)?this.empty():this},a.prototype.add=function(t){var e=this,i=e._fetchAndParse(),n=i.length+1-e.maxSize;return n>0&&i.splice(0,n),i.push(t),e._unparseAndStore(i),i.length},a.prototype._fetchAndParse=function(){var t=this;return JSON.parse(localStorage.getItem(t.key))},a.prototype._unparseAndStore=function(t){var e=this;return localStorage.setItem(e.key,JSON.stringify(t))},a.prototype.length=function(){return this._fetchAndParse().length},a.prototype.get=function(t){return this._fetchAndParse().slice(0,t)},a.prototype.remove=function(t){var e=this._fetchAndParse(),i=e.splice(0,t);return this._unparseAndStore(e),i},a.prototype.empty=function(){return localStorage.setItem(this.key,"[]"),this},a.prototype.stringify=function(t){return JSON.stringify(this.get(t))},a.prototype.print=function(){console.log(JSON.stringify(this._fetchAndParse(),null,"  "))},e.default={MetricsLogger:i,LoggingCache:a}}).call(e,i(0))},function(t,e,i){"use strict";(function(t,n,a){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(160),s=r(o),l=i(176),d=r(l),c=i(9),u=r(c),h=i(3),f=r(h),p=t.View.extend({el:"body",className:"full-content",_panelids:["left","right"],initialize:function(e){var i=this;this.config=n.defaults(e.config||{},{message_box_visible:!1,message_box_content:"",message_box_class:"info",show_inactivity_warning:!1,inactivity_box_content:""}),Galaxy.modal=this.modal=new u.default.View,Galaxy.display=this.display=function(t){t.title?(f.default.setWindowTitle(t.title),t.allow_title_display=!1):(f.default.setWindowTitle(),t.allow_title_display=!0),i.center.display(t)},Galaxy.router=this.router=e.Router&&new e.Router(i,e),this.masthead=new s.default.View(this.config),this.center=new d.default.CenterPanel,this.$el.attr("scroll","no"),this.$el.html(this._template()),this.$("#masthead").replaceWith(this.masthead.$el),this.$("#center").append(this.center.$el),this.$el.append(this.masthead.frame.$el),this.$el.append(this.modal.$el),this.$messagebox=this.$("#messagebox"),this.$inactivebox=this.$("#inactivebox"),this.panels={},n.each(this._panelids,function(t){var n=t.charAt(0).toUpperCase()+t.slice(1),a=e[n];if(a){var r=new a(i,e);i[r.toString()]=r,i.panels[t]=new d.default.SidePanel({id:t,el:i.$("#"+t),view:r})}}),this.render(),this.router&&t.history.start({root:Galaxy.root,pushState:!0})},render:function(){return a(".select2-hidden-accessible").remove(),this.masthead.render(),this.renderMessageBox(),this.renderInactivityBox(),this.renderPanels(),this._checkCommunicationServerOnline(),this},renderMessageBox:function(){if(this.config.message_box_visible){var t=this.config.message_box_content||"",e=this.config.message_box_class||"info";this.$el.addClass("has-message-box"),this.$messagebox.attr("class","panel-"+e+"-message").html(t).toggle(!!t).show()}else this.$el.removeClass("has-message-box"),this.$messagebox.hide();return this},renderInactivityBox:function(){if(this.config.show_inactivity_warning){var t=this.config.inactivity_box_content||"",e=a("<a/>").attr("href",Galaxy.root+"user/resend_verification").text("Resend verification");this.$el.addClass("has-inactivity-box"),this.$inactivebox.html(t+" ").append(e).toggle(!!t).show()}else this.$el.removeClass("has-inactivity-box"),this.$inactivebox.hide();return this},renderPanels:function(){var t=this;return n.each(this._panelids,function(e){var i=t.panels[e];i?i.render():(t.$("#center").css(e,0),t.$("#"+e).hide())}),this},_template:function(){return['<div id="everything">','<div id="background"/>','<div id="masthead"/>','<div id="messagebox"/>','<div id="inactivebox" class="panel-warning-message" />','<div id="left" />','<div id="center" />','<div id="right" />',"</div>",'<div id="dd-helper" />'].join("")},toString:function(){return"PageLayoutView"},_checkCommunicationServerOnline:function(){var t=window.Galaxy.config.communication_server_host,e=window.Galaxy.config.communication_server_port,i=window.Galaxy.user.attributes.preferences,n=a("#show-chat-online");i&&-1!=["1","true"].indexOf(i.communication_server)?a.ajax({url:t+":"+e}).success(function(t){null!==window.Galaxy.user.id&&"hidden"===n.css("visibility")&&n.css("visibility","visible")}).error(function(t){n.css("visibility","hidden")}):n.css("visibility","hidden")}});e.default={View:p}}).call(e,i(1),i(2),i(0))},,,function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(0),r=n(a),o=i(58),s=n(o),l=i(4),d=n(l),c=r.default,u=t.Router.extend({initialize:function(t,e){this.page=t,this.options=e},push:function(t,e){e=e||{},e.__identifer=Math.random().toString(36).substr(2),c.isEmptyObject(e)||(t+=-1==t.indexOf("?")?"?":"&",t+=c.param(e,!0)),Galaxy.params=e,this.navigate(t,{trigger:!0})},execute:function(t,e,i){Galaxy.debug("router execute:",t,e,i);var n=s.default.parse(e.pop());e.push(n),t&&(this.authenticate(e,i)?t.apply(this,e):this.access_denied())},authenticate:function(t,e){return!0},access_denied:function(){this.page.display(new d.default.Message({status:"danger",message:"You must be logged in with proper credentials to make this request.",persistent:!0}))}});e.default=u}).call(e,i(1))},,,,,,,,,,,,,,,function(t,e,i){"use strict";(function(t,n){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(20),o=a(r),s=i(4),l=a(s),d=t.View.extend({initialize:function(e){this.model=new t.Model(e),this.url=this.model.get("url"),this.redirect=this.model.get("redirect"),this.setElement("<div/>"),this.render()},render:function(){var t=this;n.ajax({url:Galaxy.root+this.url,type:"GET"}).done(function(e){var i=n.extend({},t.model.attributes,e),a=new o.default({title:i.title,message:i.message,status:i.status||"warning",icon:i.icon,inputs:i.inputs,buttons:{submit:new l.default.Button({tooltip:i.submit_tooltip,title:i.submit_title||"Save",icon:i.submit_icon||"fa-save",cls:"btn btn-primary ui-clear-float",onclick:function(){t._submit(a)}})}});t.$el.empty().append(a.$el)}).fail(function(e){t.$el.empty().append(new l.default.Message({message:"Failed to load resource "+t.url+".",status:"danger",persistent:!0}).$el)})},_submit:function(t){var e=this;n.ajax({url:Galaxy.root+e.url,data:JSON.stringify(t.data.create()),type:"PUT",contentType:"application/json"}).done(function(i){var a={};i.id?a.id=i.id:a={message:i.message,status:"success",persistent:!1},e.redirect?window.location=Galaxy.root+e.redirect+"?"+n.param(a):(t.data.matchModel(i,function(e,i){t.field_list[i].value(e.value)}),e._showMessage(t,success_message))}).fail(function(i){e._showMessage(t,{message:i.responseJSON.err_msg,status:"danger",persistent:!1})})},_showMessage:function(t,e){t.$el.parents().filter(function(){return-1!=["auto","scroll"].indexOf(n(this).css("overflow"))}).first().animate({scrollTop:0},500),t.message.update(e)}});e.default={View:d}}).call(e,i(1),i(0))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";(function(t){function e(t){return t&&t.__esModule?t:{default:t}}var n=i(0),a=e(n),r=i(177),o=e(r),s=i(273),l=e(s),d=i(197),c=e(d),u=i(26),h=e(u),f=i(4),p=(e(f),i(58)),_=e(p),m=i(182),g=e(m),v=i(3),b=e(v),w=i(179),y=e(w),x=i(142),k=e(x),C=i(274),S=e(C),$=a.default;window.app=function(e,i){window.Galaxy=new o.default.GalaxyApp(e,i),Galaxy.debug("admin app");var n=g.default.extend({routes:{"(/)admin(/)users":"show_users","(/)admin(/)roles":"show_roles","(/)admin(/)groups":"show_groups","(/)admin(/)tool_versions":"show_tool_versions","(/)admin(/)quotas":"show_quotas","(/)admin(/)repositories":"show_repositories","(/)admin(/)forms":"show_forms","(/)admin(/)form(/)(:form_id)":"show_form","(/)admin/api_keys":"show_user_api_keys"},authenticate:function(t,e){return Galaxy.user&&Galaxy.user.id&&Galaxy.user.get("is_admin")},show_users:function(){this.page.display(new h.default({url_base:Galaxy.root+"admin/users_list",url_data:Galaxy.params,dict_format:!0}))},show_roles:function(){this.page.display(new h.default({url_base:Galaxy.root+"admin/roles_list",url_data:Galaxy.params,dict_format:!0}))},show_groups:function(){this.page.display(new h.default({url_base:Galaxy.root+"admin/groups_list",url_data:Galaxy.params,dict_format:!0}))},show_repositories:function(){this.page.display(new h.default({url_base:Galaxy.root+"admin_toolshed/browse_repositories",url_data:Galaxy.params,dict_format:!0}))},show_tool_versions:function(){this.page.display(new h.default({url_base:Galaxy.root+"admin/tool_versions_list",url_data:Galaxy.params,dict_format:!0}))},show_quotas:function(){this.page.display(new h.default({url_base:Galaxy.root+"admin/quotas_list",url_data:Galaxy.params,dict_format:!0}))},show_user_api_keys:function(){var t=document.createElement("div");this.page.display(t),new k.default(S.default).$mount(t)},show_forms:function(){this.page.display(new h.default({url_base:Galaxy.root+"forms/forms_list",url_data:Galaxy.params,dict_format:!0}))},show_form:function(t){var e="?id="+_.default.get("id"),i={reset_user_password:{title:"Reset passwords",url:"admin/reset_user_password"+e,icon:"fa-user",submit_title:"Save new password",redirect:"admin/users"},manage_roles_and_groups_for_user:{url:"admin/manage_roles_and_groups_for_user"+e,icon:"fa-users",redirect:"admin/users"},manage_users_and_groups_for_role:{url:"admin/manage_users_and_groups_for_role"+e,redirect:"admin/roles"},manage_users_and_roles_for_group:{url:"admin/manage_users_and_roles_for_group"+e,redirect:"admin/groups"},manage_users_and_groups_for_quota:{url:"admin/manage_users_and_groups_for_quota"+e,redirect:"admin/quotas"},create_role:{url:"admin/create_role",redirect:"admin/roles"},create_group:{url:"admin/create_group",redirect:"admin/groups"},create_quota:{url:"admin/create_quota",redirect:"admin/quotas"},rename_role:{url:"admin/rename_role"+e,redirect:"admin/roles"},rename_group:{url:"admin/rename_group"+e,redirect:"admin/groups"},rename_quota:{url:"admin/rename_quota"+e,redirect:"admin/quotas"},edit_quota:{url:"admin/edit_quota"+e,redirect:"admin/quotas"},set_quota_default:{url:"admin/set_quota_default"+e,redirect:"admin/quotas"},create_form:{url:"forms/create_form",redirect:"admin/forms"},edit_form:{url:"forms/edit_form"+e,redirect:"admin/forms"}};this.page.display(new c.default.View(i[t]))}});$(function(){t.extend(e.config,{active_view:"admin"}),b.default.setWindowTitle("Administration"),Galaxy.page=new y.default.View(t.extend(e,{Left:l.default,Router:n}))})}}).call(e,i(2))},function(t,e,i){"use strict";(function(t,n,a){Object.defineProperty(e,"__esModule",{value:!0});var r=i(7),o=function(t){return t&&t.__esModule?t:{default:t}}(r),s=t.View.extend({initialize:function(e,i){var n=this;this.page=e,this.root=i.root,this.config=i.config,this.settings=i.settings,this.message=i.message,this.status=i.status,this.model=new t.Model({title:(0,o.default)("Administration")}),this.categories=new t.Collection([{title:"Server",items:[{title:"Data types",url:"admin/view_datatypes_registry"},{title:"Data tables",url:"admin/view_tool_data_tables"},{title:"Display applications",url:"admin/display_applications"},{title:"Manage jobs",url:"admin/jobs"},{title:"Local data",url:"data_manager"}]},{title:"User Management",items:[{title:"Users",url:"admin/users",target:"__use_router__"},{title:"Quotas",url:"admin/quotas",target:"__use_router__",enabled:n.config.enable_quotas},{title:"Groups",url:"admin/groups",target:"__use_router__"},{title:"Roles",url:"admin/roles",target:"__use_router__"},{title:"Forms",url:"admin/forms",target:"__use_router__"},{title:"API keys",url:"admin/api_keys",target:"__use_router__"},{title:"Impersonate a user",url:"admin/impersonate",enabled:n.config.allow_user_impersonation}]},{title:"Tool Management",items:[{title:"Install new tools",url:"admin_toolshed/browse_tool_sheds",enabled:n.settings.is_tool_shed_installed},{title:"Install new tools (Beta)",url:"admin_toolshed/browse_toolsheds",enabled:n.settings.is_tool_shed_installed&&n.config.enable_beta_ts_api_install},{title:"Monitor installation",url:"admin_toolshed/monitor_repository_installation",enabled:n.settings.installing_repository_ids},{title:"Manage tools",url:"admin/repositories",enabled:n.settings.is_repo_installed,target:"__use_router__"},{title:"Manage metadata",url:"admin_toolshed/reset_metadata_on_selected_installed_repositories",enabled:n.settings.is_repo_installed},{title:"Manage whitelist",url:"admin/sanitize_whitelist"},{title:"Manage dependencies",url:"admin/manage_tool_dependencies"},{title:"View lineage",url:"admin/tool_versions",target:"__use_router__"},{title:"View migration stages",url:"admin/review_tool_migration_stages"},{title:"View error logs",url:"admin/tool_errors"}]}]),this.setElement(this._template())},render:function(){var t=this;this.$el.empty(),this.categories.each(function(e){var i=n(t._templateSection(e.attributes)),r=i.find(".ui-side-section-body");a.each(e.get("items"),function(e){if(void 0===e.enabled||e.enabled){var i=n("<a/>").attr({href:t.root+e.url}).text((0,o.default)(e.title));"__use_router__"==e.target?i.on("click",function(i){i.preventDefault(),t.page.router.push(e.url)}):i.attr("target","galaxy_main"),r.append(n("<div/>").addClass("ui-side-section-body-title").append(i))}}),t.$el.append(i)}),this.page.$("#galaxy_main").prop("src",this.root+"admin/center?message="+this.message+"&status="+this.status)},_templateSection:function(t){return["<div>",'<div class="ui-side-section-title">'+(0,o.default)(t.title)+"</div>",'<div class="ui-side-section-body"/>',"</div>"].join("")},_template:function(){return'<div class="ui-side-panel"/>'},toString:function(){return"adminPanel"}});e.default=s}).call(e,i(1),i(0),i(2))},function(t,e,i){"use strict";function n(t){i(275)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(277),r=i.n(a),o=i(278),s=i(65),l=n,d=s(r.a,o.a,!1,l,null,null);e.default=d.exports},function(t,e,i){var n=i(276);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(64)("3c2bc722",n,!0)},function(t,e,i){e=t.exports=i(63)(void 0),e.push([t.i,"",""])},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(66),a=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default={data:function(){return{users:[],errors:[]}},created:function(){var t=this;a.default.get(Galaxy.root+"userskeys/all_users").then(function(e){t.users=e.data}).catch(function(e){t.errors.push(e)})},methods:{generateKey:function(t){var e=this;a.default.get(Galaxy.root+"userskeys/admin_api_keys",{params:{uid:t}}).then(function(t){e.users=t.data}).catch(function(t){e.errors.push(t)})}}}},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolForm",attrs:{id:"form-userkeys"}},[i("div",{staticClass:"toolFormTitle"},[t._v("User Information")]),t._v(" "),t.users&&t.users.length>0?i("div",[i("table",{staticClass:"grid"},[t._m(0),t._v(" "),i("tbody",t._l(t.users,function(e){return i("tr",[i("td",[t._v("\n                        "+t._s(e.uid)+"\n                    ")]),t._v(" "),i("td",[t._v("\n                        "+t._s(e.email)+"\n                    ")]),t._v(" "),i("td",[t._v("\n                        "+t._s(e.key)+"\n                    ")]),t._v(" "),i("td",[i("input",{attrs:{type:"button",value:"Generate a new key now"},on:{click:function(i){t.generateKey(e.uid)}}})])])}))])]):i("div",[i("div",[t._v("No user information available")])]),t._v(" "),i("div",{staticStyle:{clear:"both"}})])},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("th",[t._v("Encoded UID")]),i("th",[t._v("Email")]),i("th",[t._v("API Key")]),i("th",[t._v("Actions")])])}],r={render:n,staticRenderFns:a};e.a=r}],[272]);