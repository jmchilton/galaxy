{"version":3,"file":"history-view-edit.js","sources":["../../../src/mvc/history/history-view-edit.js"],"names":["define","HISTORY_VIEW","HISTORY_CONTENTS","STATES","HDA_MODEL","HDA_LI_EDIT","HDCA_LI_EDIT","TAGS","ANNOTATIONS","LIST_COLLECTION_CREATOR","PAIR_COLLECTION_CREATOR","LIST_OF_PAIRS_COLLECTION_CREATOR","faIconButton","PopupMenu","BASE_MVC","_l","_super","HistoryView","HistoryViewEdit","extend","HDAViewClass","HDAListItemEdit","HDCAViewClass","HDCAListItemEdit","initialize","attributes","prototype","call","this","tagsEditor","annotationEditor","purgeAllowed","annotationEditorShown","tagsEditorShown","_setUpListeners","on","droptarget:drop","ev","data","dataDropped","dropTargetOff","view:attached view:removed","_renderCounts","search:loading-progress","_renderSearchProgress","search:searching","_renderSearchFindings","_setUpModelListeners","listenTo","model","updateHistoryDiskSize","_setUpCollectionListeners","collection","change:deleted","_handleItemDeletedChange","change:visible","_handleItemVisibleChange","change:purged","fetch","fetching-deleted","$","html","fetching-hidden","fetching-deleted-done fetching-hidden-done","_buildNewRender","$newRender","Galaxy","user","id","get","_renderTags","_renderAnnotation","text","renderItems","$whereTo","views","searchFor","jQuery","$el","templates","counts","toJSON","find","$where","panel","TagsEditor","el","onshowFirstTime","render","onshow","toggleHDATagEditors","fxSpeed","onhide","$activator","title","classes","faIcon","appendTo","AnnotationEditor","toggleHDAAnnotationEditors","_setUpBehaviors","isAnonymous","nameSelector","attr","tooltip","placement","make_text_editable","on_finish","newName","previousName","save","name","fail","previous","multiselectActions","actions","func","action","HistoryDatasetAssociation","hide","getSelectedModels","ajaxQueue","unhide","undelete","push","confirm","purge","concat","_collectionActions","buildCollection","collectionType","selection","createFunc","createListCollection","createPairCollection","createListOfPairsCollection","console","warn","done","refresh","_getItemViewOptions","options","_","hidden","itemModel","_handleItemDeletion","_handleItemUndeletion","contentsShown","deleted","active","contents","includeDeleted","removeItemView","set","_handleItemHidden","_handleItemUnhidden","includeHidden","showOrHide","speed","each","view","toggle","events","clone","click .show-selectors-btn","click .toggle-deleted-link","toggleShowDeleted","click .toggle-hidden-link","toggleShowHidden","limit","offset","stop","join","length","dropTargetOn","dropTarget","dropHandlers","dragenter","bind","dragover","dragleave","drop","$dropTarget","_renderDropTarget","$list","before","_renderDropTargetHelp","evName","hasOwnProperty","remove","addClass","_dropHandlers","off","dropTargetToggle","preventDefault","stopPropagation","css","self","dataTransfer","originalEvent","getData","dropEffect","JSON","parse","err","trigger","isObject","model_class","currentPage","fetchPage","then","copy","when","toString","countsTemplate","wrapTemplate"],"mappings":"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"}